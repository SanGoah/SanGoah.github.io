<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Mech_Mind‘s blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2019-12-22T11:06:10.000Z</updated>
  <id>http://yoursite.com/</id>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>apk文件的反编译</title>
    <link href="http://yoursite.com/2019/12/22/apk%E6%96%87%E4%BB%B6%E7%9A%84%E5%8F%8D%E7%BC%96%E8%AF%91/"/>
    <id>http://yoursite.com/2019/12/22/apk%E6%96%87%E4%BB%B6%E7%9A%84%E5%8F%8D%E7%BC%96%E8%AF%91/</id>
    <published>2019-12-22T11:06:10.000Z</published>
    <updated>2019-12-22T11:06:10.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="" /></p><center>dex2jar、jd-GUI和apktool的简单介绍。</center><a id="more"></a><p>环境：</p><ul><li>Manjaro Linux 18.1.0</li><li>dex2jar 2.1</li><li>jd-GUI 1.6.5-min</li><li>apktool 2.4.1</li></ul><p>下载<a href="https://github.com/pxb1988/dex2jar" target="_blank" rel="noopener">dex2jar</a>，注意下载release版本，解压得一个文件夹，里面有许多<code>.sh</code>，对应不同功能。其中的<code>d2j-dex2jar.sh</code>可以由<code>.dex</code>文件反编译出<code>.jar</code>文件，即apk的源程序字节码。</p><p>解压apk，得到文件夹，里面的<code>.dex</code>丢到那堆<code>.sh</code>的同级目录下，<code>sh d2j-dex2jar.sh classes.dex</code>即可得到<code>.jar</code>。</p><p>下载<a href="http://java-decompiler.github.io/" target="_blank" rel="noopener">jd-GUI</a>（这个网站时好时坏经常404，网速也差，我下的1.6.5的min版），<code>java -jar jd-gui-1.6.5-min.jar</code>（要给权限）可以打开一个GUI，把<code>.jar</code>拖进去即可查看<code>.jar</code>对应的源代码。</p><p>源代码之外的配置文件和资源通过<a href="https://ibotpeaches.github.io/Apktool/install/" target="_blank" rel="noopener">apktool</a>查看，官网有详细教程。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;&quot; /&gt;&lt;/p&gt;
&lt;center&gt;
dex2jar、jd-GUI和apktool的简单介绍。
&lt;/center&gt;
    
    </summary>
    
    
      <category term="戏法" scheme="http://yoursite.com/categories/%E6%88%8F%E6%B3%95/"/>
    
    
      <category term="Android" scheme="http://yoursite.com/tags/Android/"/>
    
      <category term="反编译" scheme="http://yoursite.com/tags/%E5%8F%8D%E7%BC%96%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title>一门水课的小组作业所反映的差距</title>
    <link href="http://yoursite.com/2019/12/22/%E5%85%B6%E5%AE%83/%E4%B8%80%E9%97%A8%E6%B0%B4%E8%AF%BE%E7%9A%84%E5%B0%8F%E7%BB%84%E4%BD%9C%E4%B8%9A%E6%89%80%E5%8F%8D%E6%98%A0%E7%9A%84%E5%B7%AE%E8%B7%9D/"/>
    <id>http://yoursite.com/2019/12/22/%E5%85%B6%E5%AE%83/%E4%B8%80%E9%97%A8%E6%B0%B4%E8%AF%BE%E7%9A%84%E5%B0%8F%E7%BB%84%E4%BD%9C%E4%B8%9A%E6%89%80%E5%8F%8D%E6%98%A0%E7%9A%84%E5%B7%AE%E8%B7%9D/</id>
    <published>2019-12-22T08:01:13.000Z</published>
    <updated>2019-12-22T08:01:13.000Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="895f8912709e16aceb7396ca207928b9bf6923447562b7fa1f3b65813d8a8b12">8e6b8bba21e65be07381da90a4aa46f97ee602985d12dab54a84f4bf0121e8a96e2527de0895061a64fbe3c9ec7d1789ab56e0fb044cbe6a09ca7788ec31ce9a7645705abaf6bf40bdd88f973a1d890902b775798b5db1f98a8ed6b92756ac8c2097a6b714913a5bf791b47c95862b050f1a0c221b531579c7b97343fc214015f836deed4b34350e55cc475d3563055f747aabda502b16e4041bcd684ef3f8a7c9b1e1cf435db7479ff3e3000d2393552e40cb26a067f296b89451340d4bfaf2347e393b3608f22c84baecd09d267e40f55d7e749ba5f1e9cd8f773018237b1534a0bb9de8e7cd97e8b86a2cf211bb7bea739e939fc2f9022f57edfd471e43505111992f06308d19e9b6794ecaaaa43c749a7b14c7d375026c50b8a84c6f6c0bf21ab7cc7494c168cf5054a8c11b123d79e0dfb9a05bacf4e19ec72da6c6947b6e07cd7e67faafec6f80f0660f463b57c0018b98b8c77d4af0cb667ad40241cc47a64ec0740ba1ba66f764fd17a59026c3b4243562f69b7432d6807b8499bc80c7893a44c730ae722b1299435d33bd199d14487b7a340792f9b0068351d2e765ee6d69fc35317d82e50180cc17934fe1f4f41ac5e807e1aa52bba33064f349b28af1c1936f952de863a4240895ff4db4f1b9c07af04b184d2e43e04c3b89c25da903ced0f1a92e169c9600cb88d63a91b4e0f941ca9adbab3151aa24410a89e4fd358e528e90e069d9f69401e29a1968520d462027900a098e92a4ae8e8269c55138e37dce2ca86e8cde4e11b41158691cca42bcf50492bc9db034b6ef2471ddcfccdec5db2d2c1412f50becf4bf0ca46ce2e339739456b48cda517f4242faf3164769bf69b0293ab64aed2e3017f57a16c89f17dc4202a3ff34a4a34d056174117c1015aaf32d647adc7369b463158f3bc82fd522dc5b57c5727f14473752b8b68f70287c7666403ad98ef770ae9d599da73f0f4cf8c140f42a4b60d82bf6e653de9a9b9930aac9b415a380755fb1b7614a2c1333efc5d76156f50b1c3e11d9748107b15dd4a56c8560ce2b65b9226212e76833c8dfc2d378e27d243d096523abbc626bd147bed7925d83d1e224269fd78f60b3d1f877e9bb9d4cb22e5cd08f11563fea97afd691f2b5f40fe83728f1ac11fa4ba3d9e3b08f12d545d7f368f42e77b881a0059d079eb4c6be77fd478ff6b6469629527dadf9775c67c3c4c0ede659de6760a6ef44678cb0767874382108c8e3d0c2b865e111e5fc28cf1727680e26d535f453f14dbb9f27517397980400e28f25af683673a9bed44b08c39adbc2a9403a50ddefb53293963fbcdc8e36ea0f55f118055353fd504fda3d2b5f8c7c1aeddba921493e7a2b7b500dc35816b9079e7db1f27b9b3669615bf05dd1ad15d2aa8723cd1b944c603a1b08bcde41343232706c543a4c6baf4de1aed09d4bac039ee4369dce8df1eb95170ff141bfa7b74d7341a54cf1317b7c39c0e8dc95fd93c7ad06282e0b6c873b82c6e751ec9508ff77adf1b51e740985ec0a0bc1cf099f50a324f22144927441492ecec29c8fc078e0cc29e911b67d55be626232c2234af4e8824652ed0d360f3919cfd3c39a7b2f91ce64f9dd61f1bc6ea5095d8156f00987752aa123182e53c5e5d36403eed1e2523b300ab0e819593c674884b1c2f0e9fcfbc96859e30ea11ef3eb08e86248563f6573c4313d8a2c054a3ffcba0f1a69f3a80d88a7b6ff6579f7ec4140baca25313c041849ad9d97145f78674caa1be69c1a5197977d1b074701ea36605c6df94b33d9b2012a0edf2edf624b29ad2c3da8fb2c5aa89f00349723fa8df71ea97de25b411bdcb7e15f71b672d33c66e8cc34ef79ea1b9449c4536720b59b4b2c316b3f460cce39a0d142b5e0611d3b900fb480af77da85adc3d1831fcace5a80a76c10d84821abe32350dbab3a4853c42f50009da95564ae246ed139d13f9464256b7f801e510e1899b70c3274dbd76e8719b62d606eb1914db56cb9283c2a9c95df6090f9ef4637888166b5b58ce15d20b23b05439edf5076f0d412f58d2e7d61d18e986c1998f398f370a9c008d0df4c7bb2c26d0548d5989aea43e0136cbc7f2da17d7e7a23247c629601e7019b47a7f4d93e4451c3c98024c44a8328091effd48c4552f2a5d0e80054678a46fbc8111ffb2f78da3141e5d0f780a37135dedb0da44f27b069c13330a657e8c3b7c41b3b91ee3b85b173c8c1b088fad4109cdeea2190bc1096509a491696a915064cebf1da99eddd807c579fd2a93e21b6e328f191f679f02d7e329e83e6a3b9041e2b950ab50eb6191a0644415c4099bdb4c2f6610030bc2902a123e615dc61309524c8665f3f33ee00cecfc08ab38a2282c513857285872da4c6f5d6d0d87d86175dfec0c590889dcd6c546df5e6fb512036c87a2c7f178cbade04c6c91d460a643d45d15125f8a68b7282f82b4400ddfbad3977bc2095927aa479edda3e2fcf0c8e4667e039e83c2c862b1fbc09fd4127514fb94c8bad7d00292949df089b7bed09ddcd1ac68f67dc75b8ca2a78eec63f1e7a73407b087fb07023683c292e000b67b2bf916f5a7a54342906be824e36f6d6155979132de0d12ac5ae144c270ee6af2f4f2c659133399165ba242f58404902b8f666109aa6aa7b43e7630689aedfc9bbf7ee7eea788c865ebc8081d2e0e547d5f562a6da3a514c67cab5126789e45f2bffe1d5471fb253fa1b463ca7adc47722f1be9ffbd2bbed716f755f0586187b9c4070d5941c0fe12a9d8a9c622ff9d04f00a8e0db5e777f41cf73737f769f5d9fff73381286be740f07c64e7a226f8456a11bde110eba821dba8ce006c19d6ccabe0f6718e84289399849ac01238bf1f32c562a85e99394db73eb3cb63eb6d449d8f3586136a0c3e1d659cc689fa44a07c218fb1520d2c8672fe8fb62e56a59403644538cc6efb880f758de177139b442fb7271b94f914483f97d33deb25d4851314d1e2cde814ec2be1ed8af0bb58f0113514584ccd4e2c0807ae92ec54a66fec2f92af5f8d44e2d75b1678fbc2cda41d0bd5ce12853a40b5f898372bbe9599ad08edd8db30b704badd3ca29a46b30e0b6ac78fb9c93d8b82bfaca6f28b4d308d4b9e505818bddf47c5cd1d1b645c2a0762c23f7343b12c2147cecbd93f82a1ba6fd07a09be909937ec2271fc1d43370209c284c220f7dc5701763d754457639800aea9c54c8be341a8e9d7e9e2b9311b48373f57cbdc876ee1b61adc1731e914fe9ff4a8a4a61b8b8882162561f81f7cbf2227656c6150f406747a5663078a61f279479fa55da0d7d7aabc49099e0a4706fed2870d35a5ff329bdb15dd594e78986edca377ec0506df52fc001836c45ab0e2f8449d475b07bb43dcc28f661c9a186e19b940f5cc8a0e2189aab79765afffed83692029aa7cde4cc63839e747a9ef4c434e94020e2e2ee458f2aed384174b4528e41f370c39a4c377242026c46600c6718e9283e30f3f7162f240adc511e4565ff2db56f7fb08af9d35ec5ffbd316a68056dab5c8a7e8994a5a9dfb9e95d7bd4c6afc33b1897b5a92215284c31137acf17c693e5e7c220dd73eb3c10e61967e67f92ba1bf199ae091da0c1ac7a6edbf203a2452c7e31e120802d5dc53a25b5a72fb87818aa12a56c12f0f7c91bfae0fbda72b28c3b95ecf2b1c036f50acd5fc0423daad96b8067abac5b1f402aeda48bb9e75bad86c9ef7cfa9ad93d3068894487f1a3a5c7620b598efd8b777dce4c47456db62ef8e9a81c2431bb2eb1abca4db531dc9aac8ba4a6cc0176c9c8a032b8ba74dce7e2b6f51cf1d26d8bfb13fcc72ab958b5729e9c04bc6e14cbcd76c9437bce2aa2d189019faa61c56e756fa2c2ab55a6cc39f470923d15821ccf1816743d3e4e606cbacb6775f5aabeb07001e4e2481a70e51852a40a89b6a36735a6e35a7eedd3658719eb46817cfe691b5e0458c9cffc1549f3ad3bf1b61fe26aca3d263338781133c4321f9b6e9f94fd6dd3336f9625481e5fc82bb0b0b174e62067c06583577bfb5495ee6da20e35f7901d13a2bad456bf79e166ad5c294d798250806fe215ddbf7cc85c3e3cb7316673d7b770d69184ab51fcc812bbaf204d1825595b2dfed88a72b8fd8be0c34be9a37289494770fee8c257d8071bff8bd1c39299979f4bfe13bdcfc45c94fb267492e7ea4bb2f0d1809303769aad231997a345b8545365391f0c4a134303de3f9ba4a6170a9bf3afb19a0018031c4d486247c921f410516d0ce450739ac429df23869dbbc16fc874f8bfc111300b8541730d52b6fefd08b2b1d2ef4f095453446c771df2da651d7276ded85548d83b0ab84331549f700d9f4b5f9375a64426188d129085a70bf445c1a5baf885e9b7de7eb70592822e5355e27a91734681fcba4df6d0faba96fd5535a30c8ac570fc928779e78dc7b3d0b96d9e53e7c037276fc777b8f869dd1d501cb71f1842b75de752309f44942b1142465679dfc8c97a56162e756b0b001ac3ceb3f92cae2da44c3c64e73ebb37671780b4032801daf6064bb199259adca43383e143f766074e6592e182115f76def6ca9ea25e9cd1ee24fa03ae2518e7666b40e855f51f9d6ae527e46179aa0ee3572849c5e32afca7fcb07ae81d68aee69f7246b048c4466bb655c41ed1397e18a78501e34ad54cc32856edfecc6cf0aa7c31d093587b7afc1d39e372923555480da70fd46e2a4c0f45457e4943d77dcf4f0125dd2b86b80bd3c7cc8040a229ae2b894e2d58b63500885066d9365b66478e5584d0b638364008d741b79620018617fdda557ab8079d3c2203cd982179678dc28aadcfaea7e3dd7b23e323c1ca799a617eb7be2b4fa69daef5248cd205ed665a9c0e223b25527d0e013bf937c69dafd03c446eb9728c73a4cd51a94da6b6a944287a7aa82cf5c8ee81ab16d23d91d18639da9f32133db8aae131bf026921ce8b497955224732db666ff0275a823fdd4fe5efddf1cb6e7409d2a6d469edb71493324f8611fbc65b5fc8ed37cedd0d24b2e73002572d3bed71ecd1edfb65082a3b17c70286e296fc80351d8c9cd78641b3e4947985d9d0d15d67488a733c1c42247534eefa25314c4ff9369c0bc8ad2f16190c97829c1396c88b018c72e9945db4dcee1156aee83bf6e2691678cdb58216e6fc8c160a1ff3ae40d53029a30c119d493a0bc3e049371950f70ad74d9012c74f89cadbb84bea412f624d0f94b741be0823f58fcab8e7bb6c4a33a0e885245385513d72a88087f4c7a6b8780abe6716cf32f42d83e1cab1f614823e1166cd68ea1a1372e6868df0b39a70a367e92e1c17ec62c8a38d359e4d503842c2ed6787037d2f5545b62865474bece9279dffe223c249f68ac4c484bde125c1a5cd8f9423d7284d7040dbfc99152b99957ea3d557e697360d1ce8a8a37e15c16a7c0473615661247c78d1d93e4653b127151f38d9666c98401ae0823a39797c4d7b689ab6b85383de697cc3ab33e08177d5038ce7a7a4e7b80e1e564f923f8db8fe7b672f739c285182b250367ad8a36d6104c77651d56c3098292ceacd3b47b5eb23a83f06fbb9dca6ddd6a06b25ab70c61ca56005754654c29ea0564d9b3564d89308e037416b83d1b390f8f4f8b1999fdd866592bc20638513e8040b1df6b3a4133574fd880c9312c02c84ec496d3eae6c801b76719adb7d712477e8dcdab3a2d3159e2f5728bb8ece5ca262c37e0d98fbc3fc4ee0e25ce401eef3a0318d483777a12ed9b110c6063a05428bc35d5b66856e6b1e143a836f01b87970594d785a605818ebd127643621a20686e2d337d8273e1d747e435b593d760124893bfb1f0e5c72726b96c5f4a83bbcfb2d00ce58ed541e5739c00957b35b46e029612a22f2867b5b42d912cc5f2e02b19ec92fddfd53123b989769e1976d7c7c135e52134723eb52259445045e024370ffc66d9e70e3e6bbd126522fb46769310e971d2d0c16e5eea3cb1f5a437030f0b79d51f1cf35218d7867713eee633502c69324f571f2e1bbd3e46c84334ad52e748c038adc52c26f1bf2da593c786bf1f670fb7dd49ef9f6b1ad1c9c0a5f8278aab9db973a37937d8514fd2ea18c4e2c5e789ff979b6adee73398b6cf088fb20cb72647814cf0fec29b53550bbeb715375864da3a828ec13a8a5e610dabbbcaa4f58e856d25b48d240a53c8bade6c6d11572f9157309f02520acc9a5b748846ff1be2e29e9c478382e544f340d2c78133c4c7b64890eb547ce3d3fb4b1c621d4bfc3ca862d319fa05e364bd8ef0ef8d8ced5c1f3787e77981b87250992c7fea094b0c48971063374ea891aa824252189a12204ab6799ce2fb694ca44ea8c759bff615f1fc2e7c66ed1c842b1fac8491e5d294aca793d7dc22f55ceb2dacefa487821a7042c84a289b472776a34360eea58f59c2fae2f1d45d55b893bef7eede841baffff8261e979338b6a56ed491d498deb7b74fcf2dd219b384ac2a855cdb187851ce824392a49badd00ca49559e3d715b27e24cd472730030bb4729e9ef89c98bd0590257667a48736ad0ba74e4874177151f3f0ad482c19e6aaf9fd524abe8a8d85ec6584f32316499ca53dc3544fb5eb12e5b93035eb88719db6cdc966d8788821baa97944a1ce59d8e5fd47804d7f6502ec94ec7d703</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
    
      <category term="其它" scheme="http://yoursite.com/categories/%E5%85%B6%E5%AE%83/"/>
    
      <category term="柴米" scheme="http://yoursite.com/categories/%E5%85%B6%E5%AE%83/%E6%9F%B4%E7%B1%B3/"/>
    
    
  </entry>
  
  <entry>
    <title>FFmpeg</title>
    <link href="http://yoursite.com/2019/12/19/%E5%BF%AB%E9%97%A8%E5%B7%A5/FFmpeg/"/>
    <id>http://yoursite.com/2019/12/19/%E5%BF%AB%E9%97%A8%E5%B7%A5/FFmpeg/</id>
    <published>2019-12-19T08:47:10.000Z</published>
    <updated>2019-12-19T08:47:10.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="" /></p><center>录制、转换以及流化音视频的完整解决方案。</center><a id="more"></a><p>FFmpeg项目由以下几部分组成：</p><ul><li>FFmpeg，视频文件转换命令行工具；</li><li>ffserver，多媒体服务器；</li><li>ffplay，简单的媒体播放器；</li><li>libavcodec，编解码器库；</li><li>libavformat，解析器和产生器库。</li></ul><p>许多播放器、转码器使用FFmpeg作为内核，例如暴风影音、KMPlayer、QQ影音、格式工厂之类。</p><h1 id="安装">安装</h1><p>Manjaro自带。</p><h1 id="使用">使用</h1><p>【用到啥更新啥】</p><ul><li>画面与声音合并：<code>ffmpeg -i 画面 -i 声音 -codec copy 目标视频</code>（参数<code>-i</code>指定这是一个输入项，<code>-codec</code>表示强制使用codec编解码方式。<code>copy</code>表示原始编解码数据必须被拷贝）。</li><li>裁剪视频：<code>ffmpeg -i 输入视频 -ss 00:00:00 -t 10 输出视频</code>，单位为秒，不影响原视频。</li><li>视频缩放：<code>ffmpeg -i 输入视频 -strict -2 -vf scale=-1:480 输出视频</code>（按比例缩放高度至480）或<code>ffmpeg -i 输入视频 -strict -2 -s 640x480 输出视频</code>。</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;&quot; /&gt;&lt;/p&gt;
&lt;center&gt;
录制、转换以及流化音视频的完整解决方案。
&lt;/center&gt;
    
    </summary>
    
    
      <category term="快门工" scheme="http://yoursite.com/categories/%E5%BF%AB%E9%97%A8%E5%B7%A5/"/>
    
      <category term="视频后期" scheme="http://yoursite.com/categories/%E5%BF%AB%E9%97%A8%E5%B7%A5/%E8%A7%86%E9%A2%91%E5%90%8E%E6%9C%9F/"/>
    
    
      <category term="FFmpeg" scheme="http://yoursite.com/tags/FFmpeg/"/>
    
  </entry>
  
  <entry>
    <title>基于区域生长的图像分割</title>
    <link href="http://yoursite.com/2019/12/17/%E5%BF%AB%E9%97%A8%E5%B7%A5/%E5%9F%BA%E4%BA%8E%E5%8C%BA%E5%9F%9F%E7%94%9F%E9%95%BF%E7%9A%84%E5%9B%BE%E5%83%8F%E5%88%86%E5%89%B2/"/>
    <id>http://yoursite.com/2019/12/17/%E5%BF%AB%E9%97%A8%E5%B7%A5/%E5%9F%BA%E4%BA%8E%E5%8C%BA%E5%9F%9F%E7%94%9F%E9%95%BF%E7%9A%84%E5%9B%BE%E5%83%8F%E5%88%86%E5%89%B2/</id>
    <published>2019-12-17T13:13:16.000Z</published>
    <updated>2019-12-17T13:13:16.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="" /></p><center></center><a id="more"></a><p>根据种子选取准则选择种子，根据相似准则加入与种子相似的点，根据终止准则停止生长。</p><p>例如对如下图片：</p><p><span class="math display">\[\begin{matrix}3&amp;3&amp;4&amp;7&amp;6&amp;4&amp;5&amp;2\\4&amp;4&amp;8&amp;9&amp;7&amp;4&amp;3&amp;3\\2&amp;3&amp;4&amp;8&amp;4&amp;4&amp;5&amp;4\\2&amp;4&amp;3&amp;7&amp;7&amp;4&amp;5&amp;4\\4&amp;3&amp;4&amp;8&amp;9&amp;8&amp;3&amp;3\\2&amp;4&amp;4&amp;2&amp;7&amp;2&amp;5&amp;2\\4&amp;4&amp;3&amp;2&amp;6&amp;2&amp;3&amp;3\\4&amp;3&amp;3&amp;3&amp;4&amp;4&amp;3&amp;4\\\end{matrix}\]</span></p><p>有：</p><ul><li>种子选择准则：最亮的点；</li><li>相似性准则：新加入像素的灰度值与已生长的区域的平均灰度值之差小于2，且为4连通。</li><li>终止准则：没有像素加入。</li></ul><p>种子选取：</p><p><span class="math display">\[\begin{matrix}3&amp;3&amp;4&amp;7&amp;6&amp;4&amp;5&amp;2\\4&amp;4&amp;8&amp;(9)&amp;7&amp;4&amp;3&amp;3\\2&amp;3&amp;4&amp;8&amp;4&amp;4&amp;5&amp;4\\2&amp;4&amp;3&amp;7&amp;7&amp;4&amp;5&amp;4\\4&amp;3&amp;4&amp;8&amp;(9)&amp;8&amp;3&amp;3\\2&amp;4&amp;4&amp;2&amp;7&amp;2&amp;5&amp;2\\4&amp;4&amp;3&amp;2&amp;6&amp;2&amp;3&amp;3\\4&amp;3&amp;3&amp;3&amp;4&amp;4&amp;3&amp;4\\\end{matrix}\]</span></p><p>以生长区域区域平均值为9。则根据相似性准则，下一步应添加生长区域的点的四邻域内的、灰度值大于7的像素。</p><p><span class="math display">\[\begin{matrix}3&amp;3&amp;4&amp;7&amp;6&amp;4&amp;5&amp;2\\4&amp;4&amp;(8)&amp;(9)&amp;7&amp;4&amp;3&amp;3\\2&amp;3&amp;4&amp;(8)&amp;4&amp;4&amp;5&amp;4\\2&amp;4&amp;3&amp;7&amp;7&amp;4&amp;5&amp;4\\4&amp;3&amp;4&amp;(8)&amp;(9)&amp;(8)&amp;3&amp;3\\2&amp;4&amp;4&amp;2&amp;7&amp;2&amp;5&amp;2\\4&amp;4&amp;3&amp;2&amp;6&amp;2&amp;3&amp;3\\4&amp;3&amp;3&amp;3&amp;4&amp;4&amp;3&amp;4\\\end{matrix}\]</span></p><p>以生长区域区域平均值为<code>(9+8+8)/3=8.33</code>和<code>(9+8+8)/3=8.33</code>。则根据相似性准则，下一步应添加生长区域的点的四邻域内的、灰度值大于6.33的像素。</p><p><span class="math display">\[\begin{matrix}3&amp;3&amp;4&amp;(7)&amp;6&amp;4&amp;5&amp;2\\4&amp;4&amp;(8)&amp;(9)&amp;(7)&amp;4&amp;3&amp;3\\2&amp;3&amp;4&amp;(8)&amp;4&amp;4&amp;5&amp;4\\2&amp;4&amp;3&amp;(7)&amp;(7)&amp;4&amp;5&amp;4\\4&amp;3&amp;4&amp;(8)&amp;(9)&amp;(8)&amp;3&amp;3\\2&amp;4&amp;4&amp;2&amp;(7)&amp;2&amp;5&amp;2\\4&amp;4&amp;3&amp;2&amp;6&amp;2&amp;3&amp;3\\4&amp;3&amp;3&amp;3&amp;4&amp;4&amp;3&amp;4\\\end{matrix}\]</span></p><p>以生长区域区域平均值为<code>(9+8+8+9+8+8+7+7+7+7+7)/11=7.7272</code>。则根据相似性准则，下一步应添加生长区域的点的四邻域内的、灰度值大于5.7272的像素。</p><p><span class="math display">\[\begin{matrix}3&amp;3&amp;4&amp;(7)&amp;(6)&amp;4&amp;5&amp;2\\4&amp;4&amp;(8)&amp;(9)&amp;(7)&amp;4&amp;3&amp;3\\2&amp;3&amp;4&amp;(8)&amp;4&amp;4&amp;5&amp;4\\2&amp;4&amp;3&amp;(7)&amp;(7)&amp;4&amp;5&amp;4\\4&amp;3&amp;4&amp;(8)&amp;(9)&amp;(8)&amp;3&amp;3\\2&amp;4&amp;4&amp;2&amp;(7)&amp;2&amp;5&amp;2\\4&amp;4&amp;3&amp;2&amp;(6)&amp;2&amp;3&amp;3\\4&amp;3&amp;3&amp;3&amp;4&amp;4&amp;3&amp;4\\\end{matrix}\]</span></p><p>以生长区域区域平均值为<code>(9+8+8+9+8+8+7+7+7+7+7+6+6)/13=7.4615</code>。则根据相似性准则，下一步应添加生长区域的点的四邻域内的、灰度值大于5.4615的像素。</p><p>找不到。符合终止准则，生长结束。</p><p>故得到如下结果：</p><p><span class="math display">\[\begin{matrix}&amp; &amp;1&amp;1&amp; \\&amp;1&amp;1&amp;1&amp; \\&amp; &amp;1&amp; &amp; \\&amp; &amp;1&amp;1&amp; \\&amp; &amp;1&amp;1&amp;1\\&amp; &amp; &amp;1&amp; \\&amp; &amp; &amp;1&amp; \\&amp; &amp; &amp; &amp; \\\end{matrix}\]</span></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;&quot; /&gt;&lt;/p&gt;
&lt;center&gt;
&lt;/center&gt;
    
    </summary>
    
    
      <category term="快门工" scheme="http://yoursite.com/categories/%E5%BF%AB%E9%97%A8%E5%B7%A5/"/>
    
      <category term="图像处理" scheme="http://yoursite.com/categories/%E5%BF%AB%E9%97%A8%E5%B7%A5/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/"/>
    
    
      <category term="图像处理" scheme="http://yoursite.com/tags/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/"/>
    
      <category term="区域生长" scheme="http://yoursite.com/tags/%E5%8C%BA%E5%9F%9F%E7%94%9F%E9%95%BF/"/>
    
      <category term="图像分割" scheme="http://yoursite.com/tags/%E5%9B%BE%E5%83%8F%E5%88%86%E5%89%B2/"/>
    
  </entry>
  
  <entry>
    <title>二值图像的轮廓提取与边界跟踪</title>
    <link href="http://yoursite.com/2019/12/17/%E5%BF%AB%E9%97%A8%E5%B7%A5/%E4%BA%8C%E5%80%BC%E5%9B%BE%E5%83%8F%E7%9A%84%E8%BD%AE%E5%BB%93%E6%8F%90%E5%8F%96%E4%B8%8E%E8%BE%B9%E7%95%8C%E8%B7%9F%E8%B8%AA/"/>
    <id>http://yoursite.com/2019/12/17/%E5%BF%AB%E9%97%A8%E5%B7%A5/%E4%BA%8C%E5%80%BC%E5%9B%BE%E5%83%8F%E7%9A%84%E8%BD%AE%E5%BB%93%E6%8F%90%E5%8F%96%E4%B8%8E%E8%BE%B9%E7%95%8C%E8%B7%9F%E8%B8%AA/</id>
    <published>2019-12-17T11:20:25.000Z</published>
    <updated>2019-12-17T11:20:25.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="" /></p><center></center><a id="more"></a><p>对二值图像，若一亮点周围 8 个点均为黑点，则其为非轮廓点，将之置为黑点。对所有亮点执行此操作即可获得轮廓。</p><p>获得轮廓后可由其上一点（一般最左上）跟踪出整个边界，同时记录信息。如对于以下轮廓：</p><p><span class="math display">\[\begin{matrix}c\backslash r  &amp;_0&amp;_1&amp;_2&amp;_3&amp;_4&amp;_5&amp;_6\\_0&amp;1&amp;1&amp; &amp; &amp; &amp; &amp; \\_1&amp;1&amp; &amp;1&amp;1&amp;1&amp;1&amp;1\\_2&amp;1&amp; &amp; &amp; &amp; &amp; &amp;1\\_3&amp;1&amp;1&amp; &amp; &amp; &amp;1&amp; \\_4&amp; &amp; &amp;1&amp;1&amp; &amp;1&amp; \\_5&amp; &amp; &amp; &amp; &amp;1&amp; &amp; \\\end{matrix}\]</span></p><p>类似广搜地，定义一个<code>dir[4][2]={ {0,1},{-1,0},{0,-1},{1,0} };</code>或<code>dir[8][2]={ {0,1},{-1,1},{-1,0},{-1,-1},{0,-1},{1,-1},{1,0},{1,1} };</code>。</p><p>由于起始点是最左上的角，所以对于四方向的情况，搜索从方向3开始；对于八方向的情况则从5开始（好傻冒的约定，为啥不把开始搜索的作为0……）。</p><p>因为这个SB约定，搜索下一个逆时针方向时对应的下标是<code>(i+1)%4</code>或<code>(i+1)%8</code>而非<code>i+1</code>。顺时针类似。</p><p>对这个图使用八方向的顺时针搜索方式，第一个点从方向5开始，到方向0找到了下一个点<code>(0,1)</code>。</p><p>接下来为了保持顺时针的跟踪方向，应将当前方向也就是0逆时针旋转一个方向再进行顺时针搜索；若是正在进行逆时针搜索就顺时针旋转一个方向再逆时针搜索，即<code>(i+3)%4</code>或<code>(i+7)%8</code>。特别的，对八方向的情况，如果是斜着过来的（方向为奇数），则旋转两个方向。这样可以保证之前走过的点最后被搜索到。</p><p>因此对该图的第二次搜索由方向1开始，顺时针到方向7找到下一个点<code>(1,2)</code>。</p><p>依次类推，每次的方向分别是：<code>0700006565343422</code>。</p><p>这玩意叫<strong>8连通方向码</strong>，或<strong>8方向链码</strong>。</p><p>每次变到当前方向分别是顺时针旋转了：<code>2170002171271720</code>个方向过来的。</p><p>这玩意叫<strong>8方向差分链码</strong>。</p><p>为了统一不同起点的不同情况，引入<strong>归一化链码</strong>。同一个封闭边界的不同起点的各个链码可以看作是由表示该边界的一串数字循环移位得到的，如果把这一串数看作N位自然数，则不同的起点就形成不同大小的N位自然数，将最小的N位自然数串作为归一化链码。</p><p>示例轮廓的归一化链码为：<code>0000656534342207</code>。</p><p>链码可以计算周长。斜着走即奇数方向的按根二算，否则按一算，加起来即可。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;&quot; /&gt;&lt;/p&gt;
&lt;center&gt;
&lt;/center&gt;
    
    </summary>
    
    
      <category term="快门工" scheme="http://yoursite.com/categories/%E5%BF%AB%E9%97%A8%E5%B7%A5/"/>
    
      <category term="图像处理" scheme="http://yoursite.com/categories/%E5%BF%AB%E9%97%A8%E5%B7%A5/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/"/>
    
    
      <category term="图像处理" scheme="http://yoursite.com/tags/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/"/>
    
      <category term="轮廓提取" scheme="http://yoursite.com/tags/%E8%BD%AE%E5%BB%93%E6%8F%90%E5%8F%96/"/>
    
      <category term="边界跟踪" scheme="http://yoursite.com/tags/%E8%BE%B9%E7%95%8C%E8%B7%9F%E8%B8%AA/"/>
    
  </entry>
  
  <entry>
    <title>HTML与CSS基础知识</title>
    <link href="http://yoursite.com/2019/12/16/%E8%A1%A8%E4%B8%96%E7%95%8C/HTML%E4%B8%8ECSS/HTML%E4%B8%8ECSS%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    <id>http://yoursite.com/2019/12/16/%E8%A1%A8%E4%B8%96%E7%95%8C/HTML%E4%B8%8ECSS/HTML%E4%B8%8ECSS%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/</id>
    <published>2019-12-15T16:00:00.000Z</published>
    <updated>2019-12-15T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="" /></p><center></center><a id="more"></a><h1 id="css基础">CSS基础</h1><p>CSS，Cascading Style Sheets，层叠样式表单。层叠是指多个样式可以同时应用于同一个页面或网页中的同一个标签，执行的效果按照“层叠规则”；当标签的样式定义发生冲突时，靠近标签的定义将生效。利用CSS可实现内容和形式的分离。</p><p>按照加入方式不同，可分为：</p><ul><li><p>行内样式表：<code>&lt;标签名 style=&quot;属性1:属性值1; 属性2:属性值2; 属性3:属性值3;&quot;&gt; 内容 &lt;/标签名&gt;</code>。优先度最高，可控制一个标签。</p></li><li><p>内部样式表：将CSS代码集中写在HTML文档的head头部标签中，并且用style标签定义。 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">&lt;style type&#x3D;&quot;text&#x2F;CSS&quot;&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">    选择器 &#123;属性1:属性值1; 属性2:属性值2; 属性3:属性值3;&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">    ...</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">&lt;&#x2F;style&gt;</span></pre></td></tr></table></figure> 优先度次之，可控制整个页面。</p></li><li><p>外部样式表：也是在头文件中写<code>&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;test.css&quot;&gt;&lt;/link&gt;</code>，即，用href属性指定CSS文件位置，type属性设定为<code>&quot;text/css&quot;</code>，rel属性设定为<code>&quot;stylesheet&quot;</code>。优先度最低，但方便。</p></li></ul><p>样式优先级规则可以通过<code>!important</code>关键字进行改变，如<code>div{color:#f00!important;color:#000;}</code>，#f00的优先级被提升，将高于#000，最终显示#f00。</p><p>样式定义的基本格式包括选择器、属性和属性值。定义通用样式时，选择器设为<code>*</code>。而<code>p{ font-family: &quot;宋体&quot;; }</code>定义的样式仅作用于HTML文件的<code>&lt;p&gt;</code>标记、<code>font-family</code>属性。形如<code>p.right {text-align:right }</code>定义了属性选择器，这个样式就仅对right类中的p有效。如果想让它作用于作用于HTML中的某个p，就须就须设置为<code>&lt;p class=&quot;right&quot; ... /&gt;</code>。形如<code>p＃green {color:green}</code>定义了id选择器，仅对<code>&lt;p id=&quot;green&quot;&gt;...&lt;/p&gt;</code>有效。</p><p>常用的字体CSS属性有font-family、font-size、font-style和font-weight。常用的文本CSS属性有text-indent、text-align、text-decoration、text-transform和color、letter-spacing、line-height。常用的背景CSS属性有background-color、background-image、background-repeat、background-position和background-attchment。</p><h1 id="box模型">BOX模型</h1><p>BOX模型制定了元素如何在页面中显示，可以理解为，顶部俯视一些装了东西的盒子，盒子里装的东西即内容（content）；东西与盒子之间的空隙即内边距（padding）；盒子本身的厚度即边框（border）；盒子外与其他盒子之间的间隔即外边距（margin），也就是说，BOX模型有内容、内边距、边框、外边距四要素。</p><p>例如<code>{position:absolute;left:20px;top:20px }</code>设置了一个相对位置。</p><h1 id="示例">示例</h1><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">text/css</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">    ul&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">        list-style-type: none;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">        line-height: 200%;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    li&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">        padding: 5px;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="css">        <span class="selector-tag">margin</span>: 10 10<span class="selector-tag">px</span>;   <span class="comment">/*这个用来调整导航之间的间距*/</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">        display: inline-block;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">        width: 120px;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">        height: 40px;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">        text-align: center;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">        display: inline;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">http://www.baidu.com</span>&gt;</span>网站首页<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">http://www.baidu.com</span>&gt;</span>学院概况<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">http://www.baidu.com</span>&gt;</span>机构设置<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">http://www.baidu.com</span>&gt;</span>教学科研<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">http://www.baidu.com</span>&gt;</span>国际交流<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">http://www.baidu.com</span>&gt;</span>党建思政<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></pre></td></tr></table></figure><p>效果如下：</p><style type=text/css>    ul{        list-style-type: none;        line-height: 200%;    }    li{        padding: 5px;        margin: 10 10px;   /*这个用来调整导航之间的间距*/        display: inline-block;        width: 120px;        height: 40px;        text-align: center;        display: inline;    }</style><ul style="list-style-type:none;line-height: 200%;"><li><a href=http://www.baidu.com>网站首页</a></li><li><a href=http://www.baidu.com>学院概况</a></li><li><a href=http://www.baidu.com>机构设置</a></li><li><a href=http://www.baidu.com>教学科研</a></li><li><a href=http://www.baidu.com>国际交流</a></li><li><a href=http://www.baidu.com>党建思政</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;&quot; /&gt;&lt;/p&gt;
&lt;center&gt;
&lt;/center&gt;
    
    </summary>
    
    
      <category term="表世界" scheme="http://yoursite.com/categories/%E8%A1%A8%E4%B8%96%E7%95%8C/"/>
    
      <category term="HTML与CSS" scheme="http://yoursite.com/categories/%E8%A1%A8%E4%B8%96%E7%95%8C/HTML%E4%B8%8ECSS/"/>
    
    
      <category term="CSS" scheme="http://yoursite.com/tags/CSS/"/>
    
      <category term="HTML" scheme="http://yoursite.com/tags/HTML/"/>
    
  </entry>
  
  <entry>
    <title>Struts2基础知识</title>
    <link href="http://yoursite.com/2019/12/16/%E8%A1%A8%E4%B8%96%E7%95%8C/Struts2/Structs2%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    <id>http://yoursite.com/2019/12/16/%E8%A1%A8%E4%B8%96%E7%95%8C/Struts2/Structs2%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/</id>
    <published>2019-12-15T16:00:00.000Z</published>
    <updated>2019-12-15T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="" /></p><center>理解MVC模式与SSH框架。</center><a id="more"></a><h1 id="struts2对请求的基本处理流程及相关配置文件">Struts2对请求的基本处理流程及相关配置文件</h1><p>Web应用项目启动时会先加载<code>Web.xml</code>配置文件，通过里面指定的过滤器拦截请求，因此开发Struts框架Web应用项目，首先在项目配置文件web.xml中增加核心过滤器配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.apache.struts2.dispatcher.FilterDispatcher<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span></pre></td></tr></table></figure><p>符合过滤要求的请求将由<code>struts.xml</code>中配置的Struts2拦截器拦截。</p><p>自定义拦截器的基类一般是Interceptor，一般至少包括<code>init()</code>、<code>destroy()</code>和<code>intercept()</code>三个函数。在拦截函数中通过<code>invocation.invok()</code>调用Action，程序流转至Action。</p><p>例如如下自定义拦截器：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"itcast"</span> <span class="attr">namespace</span>=<span class="string">"/test"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">interceptors</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">interceptor</span> <span class="attr">name</span>=<span class="string">"定义的拦截器名字"</span> <span class="attr">class</span>=<span class="string">"定义的拦截器类文件"</span>/&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">interceptor-stack</span> <span class="attr">name</span>=<span class="string">"定义的拦截器堆栈名字"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--以下给出拦截器堆栈包含的拦截器--&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"defaultStack"</span> /&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"定义的拦截器名字"</span> /&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">interceptor-stack</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">interceptors</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">...</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">...</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--在Action中指出要包含拦截器--&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"定义的拦截器堆栈名字"</span>/&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span></pre></td></tr></table></figure><p>defult-interceptor-ref指定默认拦截器。</p><p>转至Action后将从<code>struts.xml</code>中找到动作的处理类执行。<code>struts.xml</code>主要的部分如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"包名"</span> <span class="attr">namespace</span>=<span class="string">"名字空间，可不写"</span> <span class="attr">extends</span>=<span class="string">"继承的包，可不写"</span> <span class="attr">abstract</span>=<span class="string">"是否是抽象包，可不写"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">action</span>  <span class="attr">name</span>=<span class="string">"请求的动作名"</span> <span class="attr">class</span>=<span class="string">"处理类的路径，可不写"</span> <span class="attr">method</span>=<span class="string">"方法名，缺省为execute方法"</span> <span class="attr">converter</span>=<span class="string">"指定类型转换器，可不写"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"动作的返回值，缺省为success"</span> <span class="attr">type</span>=<span class="string">"返回结果类型，缺省为dispatcher，可转向一个结果页面；redirectAction转向动作；redirect转向动作或url"</span>&gt;</span>结果页面<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span></pre></td></tr></table></figure><p>可以看出，作为动作的处理类的Java类应当无形参并返回一个String，缺省的映射函数为<code>execute()</code>方法，用其它方法返回的话需要在method中设置一下。默认的基类为ActionSupport。</p><p>还可使用include标签导入多个<code>struts-xxx.xml</code>。</p><p>Web项目部署路径包括协议名、服务器名、端口号、项目名称、（可能有的）名字空间和动作名，也就是形如<code>http://localhost/8088/struts2/simple/hello.action</code>，可以看出Action缺省的扩展名为.action。这里没有额外的名字空间，所以服务器将在<code>/simple</code>下搜索<code>hello.action</code>；形如<code>http://server/struts2/path1/path2/path3/hello.action</code>，服务器首先在<code>/path1/path2/path3</code>名字空间搜索。</p><p>在Action有较多方法（即struts.xml配置中使用了通配符配置、定义Action）时，Struts2支持通过函数名调用Action的方法（函数），即动态方法调用。当多个action中都使用到了相同result，在<code>struts.xml</code>中用<code>globle-results</code>可把result定义为全局结果。</p><p>除<code>Web.xml</code>和<code>struts.xml</code>外，还有struts-default.xml、struts-plugin.xml、struts.xml、struts.properties。加载顺序为struts-default.xml &gt; struts-plugin.xml &gt; struts.xml &gt; struts.properties &gt; web.xml。</p><p>Action函数所在类文件，用ActionContext的静态成员函数getContext获取Action运行环境及内容。JSP页面可直接使用的内置对象Request所对应的Java类是HttpServletRequest，Response所对应的Java类是HttpServletResponse。</p><p>示例，这是一个上传文件的表单，提交该表单后由一个JSP表达式获取Action运行环境及内容，调用Action：</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">&lt;!--enctype属性规定在发送到服务器之前应该如何对表单数据进行编码。multipart/form-data即不对字符编码。在使用包含文件上传控件的表单时，必须使用该值。--&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">&lt;form enctype=<span class="string">"multipart/from-data"</span> action=<span class="string">"$&lt;%=request.getContextPath()&gt;/upload.action"</span> method=<span class="string">"post"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">"file"</span> name=<span class="string">"uploadImage"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">"submit"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">&lt;/form&gt;</span></pre></td></tr></table></figure><p>jsp页面效果如下：</p><hr /><form enctype="multipart/from-data"><input type="file" name="uploadImage"> <input type="submit"></form><hr /><p>Action函数所在的Java类UploadAction:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UploadAction</span></span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//上传的文件</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> File uploadImage;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//上传文件的类型</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> String uploadImageContentType;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//上传文件的名称</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> String uploadImageFileName;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">upload</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">String realpath =ServletActionContext.getServletContext( ).getRealPath(<span class="string">"/images"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">File file = <span class="keyword">new</span> File(realpath);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>( !file.exists( ) )</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">file.mkdirs( );</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">FileUtils.copyFile(uploadImage, <span class="keyword">new</span> File(file,uploadImageFileName)); </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="string">"success"</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure><p>除此之外，ActionSupport还提供了一个<code>validate()</code>，可以在执行Action前对所有方法得到的值进行校验。当某个控件数据校验失败时，一般调用<code>addFieldError()</code>向系统的fieldErrors添加校验失败信息，在JSP页面可通过<code>s:fielderror</code>显示失败信息。如果有些方法不需要被校验，则可以在不需要使用校验的方法上注解<code>@SkipValidation</code>或使用形如<code>validateXxx()</code>的重写方法，这将只校验<code>xxx</code>方法。</p><h1 id="ssh框架">SSH框架</h1><p>SSH，Struts+Spring+Hibernate，是古代较为流行的一种Web应用程序开源框架。其设计模式分为表示层（View）、业务层（Service）、DAO层（DAO，Data Access Object，数据访问对象）和工具层（Util）、。实际使用时表示层请求业务层的方法（通过Struts请求动作，由Spring管理调度对象的生命周期——而不是new），业务层通过DAO层调用工具层完成对数据的操作（对数据的操作用到Hibernate，不过下面的例子用的JDBC）。</p><p>一个典型的程序如下，程序来自印度国家信息技术学院（？），<code>struts.xml</code>配置如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"Login"</span> <span class="attr">namespace</span>=<span class="string">"/"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"listAll"</span> <span class="attr">class</span>=<span class="string">"com.stu.Action.StudentAction"</span> <span class="attr">method</span>=<span class="string">"listAll"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>main.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"addStu"</span> <span class="attr">class</span>=<span class="string">"com.stu.Action.StudentAction"</span> <span class="attr">method</span>=<span class="string">"addStu"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>index.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"input"</span>&gt;</span>addNew.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"editStu"</span> <span class="attr">class</span>=<span class="string">"com.stu.Action.StudentAction"</span> <span class="attr">method</span>=<span class="string">"editStu"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>index.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"input"</span>&gt;</span>editStu.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"deleteStu"</span> <span class="attr">class</span>=<span class="string">"com.stu.Action.StudentAction"</span> <span class="attr">method</span>=<span class="string">"deleteStu"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>index.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"goToEdit"</span> <span class="attr">class</span>=<span class="string">"com.stu.Action.StudentAction"</span> <span class="attr">method</span>=<span class="string">"goToEdit"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>editStu.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"goToUpdate"</span> <span class="attr">class</span>=<span class="string">"com.stu.Action.UploadAction"</span> <span class="attr">method</span>=<span class="string">"goToUpload"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>upload.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"upload"</span> <span class="attr">class</span>=<span class="string">"com.stu.Action.UploadAction"</span> <span class="attr">method</span>=<span class="string">"upload"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"savePath"</span>&gt;</span>upload/<span class="tag">&lt;/<span class="name">param</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>/index.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"input"</span>&gt;</span>/upload.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"defaultStack"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"fileUpload.maximumSize"</span>&gt;</span>1048576<span class="tag">&lt;/<span class="name">param</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"fileUpload.allowedTypes"</span>&gt;</span>image/bmp,image/jpeg,image/gif,image/png<span class="tag">&lt;/<span class="name">param</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">interceptor-ref</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span></pre></td></tr></table></figure><p>首先用一个modle类表示对应的数据库，把<strong>表映射为类</strong>、<strong>记录映射为对象</strong>、<strong>字段映射为类成员</strong>，这种方法叫ORM，Object Relation Mapping：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.stu.model;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> String StuId;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> String StuName;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> course1;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> course2;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> course3;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> String EnterTime;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> String email;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> String headImg;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">(String StuId, String StuName, <span class="keyword">int</span> course1, <span class="keyword">int</span> course2, <span class="keyword">int</span> course3, String EnterTime, String email)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">this</span>.StuId = StuId;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">this</span>.StuName = StuName;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">this</span>.course1 = course1;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">this</span>.course2 = course2;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">this</span>.course3 = course3;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">this</span>.EnterTime = EnterTime;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">this</span>.email = email;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> id;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">this</span>.id = id;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">35</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getStuId</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">36</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> StuId;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">37</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">38</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">39</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStuId</span><span class="params">(String stuId)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">40</span></pre></td><td class="code"><pre><span class="line">        StuId = stuId;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">41</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">42</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">43</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getStuName</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">44</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> StuName;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">45</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">46</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">47</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStuName</span><span class="params">(String stuName)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">48</span></pre></td><td class="code"><pre><span class="line">        StuName = stuName;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">49</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">50</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">51</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCourse1</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">52</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> course1;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">53</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">54</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">55</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCourse1</span><span class="params">(<span class="keyword">int</span> course1)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">56</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">this</span>.course1 = course1;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">57</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">58</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">59</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCourse2</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">60</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> course2;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">61</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">62</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">63</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCourse2</span><span class="params">(<span class="keyword">int</span> course2)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">64</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">this</span>.course2 = course2;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">65</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">66</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">67</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCourse3</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">68</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> course3;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">69</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">70</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">71</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCourse3</span><span class="params">(<span class="keyword">int</span> course3)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">72</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">this</span>.course3 = course3;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">73</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">74</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">75</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getEnterTime</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">76</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> EnterTime;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">77</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">78</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">79</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEnterTime</span><span class="params">(String enterTime)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">80</span></pre></td><td class="code"><pre><span class="line">        EnterTime = enterTime;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">81</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">82</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">83</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getEmail</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">84</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> email;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">85</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">86</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">87</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEmail</span><span class="params">(String email)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">88</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">this</span>.email = email;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">89</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">90</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">91</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getHeadImg</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">92</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> headImg;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">93</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">94</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHeadImg</span><span class="params">(String headImg)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">95</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">this</span>.headImg = headImg;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">96</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">97</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">98</span></pre></td><td class="code"><pre><span class="line">    <span class="meta">@Override</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">99</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">100</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> <span class="string">"Student&#123;"</span> +</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">101</span></pre></td><td class="code"><pre><span class="line">                <span class="string">"id="</span> + id +</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">102</span></pre></td><td class="code"><pre><span class="line">                <span class="string">", StuId='"</span> + StuId + <span class="string">'\''</span> +</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">103</span></pre></td><td class="code"><pre><span class="line">                <span class="string">", StuName='"</span> + StuName + <span class="string">'\''</span> +</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">104</span></pre></td><td class="code"><pre><span class="line">                <span class="string">", course1="</span> + course1 +</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">105</span></pre></td><td class="code"><pre><span class="line">                <span class="string">", course2="</span> + course2 +</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">106</span></pre></td><td class="code"><pre><span class="line">                <span class="string">", course3="</span> + course3 +</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">107</span></pre></td><td class="code"><pre><span class="line">                <span class="string">", EnterTime='"</span> + EnterTime + <span class="string">'\''</span> +</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">108</span></pre></td><td class="code"><pre><span class="line">                <span class="string">", email='"</span> + email + <span class="string">'\''</span> +</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">109</span></pre></td><td class="code"><pre><span class="line">                <span class="string">", headImg='"</span> + headImg + <span class="string">'\''</span> +</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">110</span></pre></td><td class="code"><pre><span class="line">                <span class="string">'&#125;'</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">111</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">112</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure><p>接下来编写DAO层操作数据时使用的工具层：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.stu.Util;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.CallableStatement;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.Connection;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.ResultSetMetaData;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.HashMap;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.List;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Map;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//DAO层通过该类操作数据库</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JDBCUtil</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> JDBCUtil instance = <span class="keyword">null</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> String driver = <span class="keyword">null</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> String url = <span class="keyword">null</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> String username = <span class="keyword">null</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> String password = <span class="keyword">null</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> CallableStatement callableStatement = <span class="keyword">null</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Connection conn = <span class="keyword">null</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> PreparedStatement pst = <span class="keyword">null</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> ResultSet rst = <span class="keyword">null</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//单例模式的对象生成，JDBCUtil只需要有一个实例</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> JDBCUtil <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (instance==<span class="keyword">null</span>) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line">String driver = <span class="string">"com.mysql.jdbc.Driver"</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//数据库连接URL字符串一般情况下包括连接方式、服务器地址（名称）、端口号和数据库名称四部分。</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line">String url = <span class="string">"jdbc:mysql://localhost:3306/test?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false"</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line">String username = <span class="string">"root"</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">35</span></pre></td><td class="code"><pre><span class="line">String password = <span class="string">"niitniit"</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">36</span></pre></td><td class="code"><pre><span class="line">instance = <span class="keyword">new</span> JDBCUtil(driver, url, username, password);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">37</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">38</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> instance;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">39</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">40</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">41</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">JDBCUtil</span><span class="params">(String driver, String url, String username, String password)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">42</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.driver = driver;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">43</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.url = url;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">44</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.username = username;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">45</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.password = password;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">46</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">47</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">48</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建连接</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">49</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Connection <span class="title">getConnection</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">50</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">51</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">52</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//动态加载驱动类，此时会自动新建一个Driver的对象并注册到DriverManager</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">53</span></pre></td><td class="code"><pre><span class="line">Class.forName(driver);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">54</span></pre></td><td class="code"><pre><span class="line">&#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">55</span></pre></td><td class="code"><pre><span class="line">System.out.println(<span class="string">"..."</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">56</span></pre></td><td class="code"><pre><span class="line">System.out.println(e.getMessage());</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">57</span></pre></td><td class="code"><pre><span class="line">e.printStackTrace();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">58</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">59</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建连接</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">60</span></pre></td><td class="code"><pre><span class="line">conn = DriverManager.getConnection(url, username, password);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">61</span></pre></td><td class="code"><pre><span class="line">&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">62</span></pre></td><td class="code"><pre><span class="line">System.out.println(e.getMessage());</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">63</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">64</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> conn;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">65</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">66</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">67</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//数据库的更新操作</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">68</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">executeUpdate</span><span class="params">(String sql, Object[] params)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">69</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> affectedLine = <span class="number">0</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">70</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">71</span></pre></td><td class="code"><pre><span class="line">conn = <span class="keyword">this</span>.getConnection();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">72</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//把SQL语句串转换为PreparedStatement对象。</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">73</span></pre></td><td class="code"><pre><span class="line">pst = conn.prepareStatement(sql);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">74</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (params != <span class="keyword">null</span>) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">75</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; params.length; i++) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">76</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//调用prepareStatement的setObject以绑定参数</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">77</span></pre></td><td class="code"><pre><span class="line">pst.setObject(i + <span class="number">1</span>, params[i]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">78</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">79</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">80</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//更新</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">81</span></pre></td><td class="code"><pre><span class="line">affectedLine = pst.executeUpdate();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">82</span></pre></td><td class="code"><pre><span class="line">&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">83</span></pre></td><td class="code"><pre><span class="line">System.out.println(e.getMessage());</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">84</span></pre></td><td class="code"><pre><span class="line">&#125; <span class="keyword">finally</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">85</span></pre></td><td class="code"><pre><span class="line">closeAll();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">86</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">87</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> affectedLine;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">88</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">89</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">90</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//查询结果集</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">91</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> ResultSet <span class="title">executeQueryRS</span><span class="params">(String sql, Object[] params)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">92</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">93</span></pre></td><td class="code"><pre><span class="line">conn = <span class="keyword">this</span>.getConnection();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">94</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//把SQL语句串转换为PreparedStatement对象。</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">95</span></pre></td><td class="code"><pre><span class="line">pst = conn.prepareStatement(sql);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">96</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (params != <span class="keyword">null</span>) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">97</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; params.length; i++) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">98</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//调用prepareStatement的setObject以绑定参数</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">99</span></pre></td><td class="code"><pre><span class="line">pst.setObject(i + <span class="number">1</span>, params[i]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">100</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">101</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">102</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//执行查询</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">103</span></pre></td><td class="code"><pre><span class="line">rst = pst.executeQuery();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">104</span></pre></td><td class="code"><pre><span class="line">&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">105</span></pre></td><td class="code"><pre><span class="line">System.out.println(e.getMessage());</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">106</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">107</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> rst;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">108</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">109</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">110</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//查询单个结果</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">111</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">executeQuerySingle</span><span class="params">(String sql, Object[] params)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">112</span></pre></td><td class="code"><pre><span class="line">Object object = <span class="keyword">null</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">113</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">114</span></pre></td><td class="code"><pre><span class="line">conn = <span class="keyword">this</span>.getConnection();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">115</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//把SQL语句串转换为PreparedStatement对象。</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">116</span></pre></td><td class="code"><pre><span class="line">pst = conn.prepareStatement(sql);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">117</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (params != <span class="keyword">null</span>) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">118</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; params.length; i++) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">119</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//调用prepareStatement的setObject以绑定参数</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">120</span></pre></td><td class="code"><pre><span class="line">pst.setObject(i + <span class="number">1</span>, params[i]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">121</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">122</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">123</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//执行查询</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">124</span></pre></td><td class="code"><pre><span class="line">rst = pst.executeQuery();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">125</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//但只返回第一个结果</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">126</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (rst.next()) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">127</span></pre></td><td class="code"><pre><span class="line">object = rst.getObject(<span class="number">1</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">128</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">129</span></pre></td><td class="code"><pre><span class="line">&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">130</span></pre></td><td class="code"><pre><span class="line">System.out.println(e.getMessage());</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">131</span></pre></td><td class="code"><pre><span class="line">&#125; <span class="keyword">finally</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">132</span></pre></td><td class="code"><pre><span class="line">closeAll();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">133</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">134</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> object;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">135</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">136</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">137</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//查询结果集并返回list</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">138</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Object&gt; <span class="title">excuteQuery</span><span class="params">(String sql, Object[] params)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">139</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//查询结果集</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">140</span></pre></td><td class="code"><pre><span class="line">ResultSet rs = executeQueryRS(sql, params);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">141</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//数据的相关信息</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">142</span></pre></td><td class="code"><pre><span class="line">ResultSetMetaData rsmd = <span class="keyword">null</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">143</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> columnCount = <span class="number">0</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">144</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">145</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取数据信息</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">146</span></pre></td><td class="code"><pre><span class="line">rsmd = rs.getMetaData();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">147</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取行数</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">148</span></pre></td><td class="code"><pre><span class="line">columnCount = rsmd.getColumnCount();   </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">149</span></pre></td><td class="code"><pre><span class="line">&#125; <span class="keyword">catch</span> (SQLException e1) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">150</span></pre></td><td class="code"><pre><span class="line">System.out.println(e1.getMessage()); </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">151</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">152</span></pre></td><td class="code"><pre><span class="line">List&lt;Object&gt; list = <span class="keyword">new</span> ArrayList&lt;Object&gt;();   </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">153</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">154</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (rs.next()) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">155</span></pre></td><td class="code"><pre><span class="line">Map&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">156</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= columnCount; i++) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">157</span></pre></td><td class="code"><pre><span class="line">map.put(rsmd.getColumnLabel(i), rs.getObject(i));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">158</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">159</span></pre></td><td class="code"><pre><span class="line">list.add(map);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">160</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">161</span></pre></td><td class="code"><pre><span class="line">&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">162</span></pre></td><td class="code"><pre><span class="line">System.out.println(e.getMessage());   </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">163</span></pre></td><td class="code"><pre><span class="line">&#125; <span class="keyword">finally</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">164</span></pre></td><td class="code"><pre><span class="line">closeAll();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">165</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">166</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> list;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">167</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">168</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">169</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//从前面的结果集中返回单个结果（好像是吧……）</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">170</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">excuteQuery</span><span class="params">(String sql, Object[] params,<span class="keyword">int</span> outParamPos, <span class="keyword">int</span> SqlType)</span> </span>&#123;   </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">171</span></pre></td><td class="code"><pre><span class="line">Object object = <span class="keyword">null</span>;      </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">172</span></pre></td><td class="code"><pre><span class="line">conn = <span class="keyword">this</span>.getConnection();       </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">173</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;           </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">174</span></pre></td><td class="code"><pre><span class="line">callableStatement = conn.prepareCall(sql);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">175</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(params != <span class="keyword">null</span>) &#123;             </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">176</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; params.length; i++) &#123;      </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">177</span></pre></td><td class="code"><pre><span class="line">callableStatement.setObject(i + <span class="number">1</span>, params[i]);  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">178</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">179</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">180</span></pre></td><td class="code"><pre><span class="line">callableStatement.registerOutParameter(outParamPos, SqlType);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">181</span></pre></td><td class="code"><pre><span class="line">callableStatement.execute();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">182</span></pre></td><td class="code"><pre><span class="line">object = callableStatement.getObject(outParamPos);   </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">183</span></pre></td><td class="code"><pre><span class="line">&#125; <span class="keyword">catch</span> (SQLException e) &#123;     </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">184</span></pre></td><td class="code"><pre><span class="line">System.out.println(e.getMessage());       </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">185</span></pre></td><td class="code"><pre><span class="line">&#125; <span class="keyword">finally</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">186</span></pre></td><td class="code"><pre><span class="line">closeAll();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">187</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">188</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> object;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">189</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">190</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">191</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">192</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">closeAll</span><span class="params">()</span> </span>&#123;   </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">193</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (rst != <span class="keyword">null</span>) &#123;      </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">194</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;               </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">195</span></pre></td><td class="code"><pre><span class="line">rst.close();          </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">196</span></pre></td><td class="code"><pre><span class="line">&#125; <span class="keyword">catch</span> (SQLException e) &#123;    </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">197</span></pre></td><td class="code"><pre><span class="line">System.out.println(e.getMessage());  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">198</span></pre></td><td class="code"><pre><span class="line">&#125;     </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">199</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">200</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (pst != <span class="keyword">null</span>) &#123;      </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">201</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;               </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">202</span></pre></td><td class="code"><pre><span class="line">pst.close();       </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">203</span></pre></td><td class="code"><pre><span class="line">&#125; <span class="keyword">catch</span> (SQLException e) &#123; </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">204</span></pre></td><td class="code"><pre><span class="line">System.out.println(e.getMessage()); </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">205</span></pre></td><td class="code"><pre><span class="line">&#125;         </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">206</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">207</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (callableStatement != <span class="keyword">null</span>) &#123; </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">208</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;                    </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">209</span></pre></td><td class="code"><pre><span class="line">callableStatement.close();  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">210</span></pre></td><td class="code"><pre><span class="line">&#125; <span class="keyword">catch</span> (SQLException e) &#123;   </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">211</span></pre></td><td class="code"><pre><span class="line">System.out.println(e.getMessage());   </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">212</span></pre></td><td class="code"><pre><span class="line">&#125;  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">213</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">214</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (conn != <span class="keyword">null</span>) &#123;             </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">215</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;                   </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">216</span></pre></td><td class="code"><pre><span class="line">conn.close();         </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">217</span></pre></td><td class="code"><pre><span class="line">&#125; <span class="keyword">catch</span> (SQLException e) &#123;    </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">218</span></pre></td><td class="code"><pre><span class="line">System.out.println(e.getMessage());    </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">219</span></pre></td><td class="code"><pre><span class="line">&#125;         </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">220</span></pre></td><td class="code"><pre><span class="line">&#125;       </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">221</span></pre></td><td class="code"><pre><span class="line">&#125;   </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">222</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure><p>接下来是DAO层的代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.stu.Util;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.stu.model.Student;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.Timestamp;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.HashMap;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.List;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentDao</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//增</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(Student student)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">        String sql = <span class="string">"insert into Student(StuId,StuName,Course1,Course2,Course3,EnterTime,Email) values(?,?,?,?,?,?,?)"</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">        JDBCUtil util = JDBCUtil.getInstance();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">        util.executeUpdate(sql, <span class="keyword">new</span> Object[]&#123;student.getStuId(), student.getStuName(), student.getCourse1(),student.getCourse2(), student.getCourse3(), student.getEnterTime(), student.getEmail()&#125;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//删</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">        String sql = <span class="string">"delete from Student where id = ?"</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">        JDBCUtil util = JDBCUtil.getInstance();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">        util.executeUpdate(sql, <span class="keyword">new</span> Object[]&#123;id&#125;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//选</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Student <span class="title">select</span><span class="params">(<span class="keyword">int</span> Id)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line">        String sql = <span class="string">"select * from Student where id = ?"</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line">        JDBCUtil util = JDBCUtil.getInstance();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line">        List&lt;Object&gt; tmp = util.excuteQuery(sql, <span class="keyword">new</span> Object[]&#123;Id&#125;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line">        HashMap&lt;String, Object&gt; map;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line">        SimpleDateFormat format = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyyMMdd"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line">        Student stu;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">35</span></pre></td><td class="code"><pre><span class="line">        String StuId;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">36</span></pre></td><td class="code"><pre><span class="line">        String StuName;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">37</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">int</span> course1;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">38</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">int</span> course2;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">39</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">int</span> course3;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">40</span></pre></td><td class="code"><pre><span class="line">        String EnterTime;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">41</span></pre></td><td class="code"><pre><span class="line">        String email;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">42</span></pre></td><td class="code"><pre><span class="line">        String headImg;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">43</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">for</span> (Object obj : tmp) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">44</span></pre></td><td class="code"><pre><span class="line">            map = (HashMap&lt;String, Object&gt;) obj;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">45</span></pre></td><td class="code"><pre><span class="line">            StuId = (String) map.get(<span class="string">"StuId"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">46</span></pre></td><td class="code"><pre><span class="line">            StuName = (String) map.get(<span class="string">"StuName"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">47</span></pre></td><td class="code"><pre><span class="line">            course1 = (Integer) map.get(<span class="string">"Course1"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">48</span></pre></td><td class="code"><pre><span class="line">            course2 = (Integer) map.get(<span class="string">"Course2"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">49</span></pre></td><td class="code"><pre><span class="line">            course3 = (Integer) map.get(<span class="string">"Course3"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">50</span></pre></td><td class="code"><pre><span class="line">            EnterTime = format.format((Timestamp) (map.get(<span class="string">"EnterTime"</span>)));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">51</span></pre></td><td class="code"><pre><span class="line">            email = (String) map.get(<span class="string">"Email"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">52</span></pre></td><td class="code"><pre><span class="line">            headImg = (String) map.get(<span class="string">"headImg"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">53</span></pre></td><td class="code"><pre><span class="line">            stu = <span class="keyword">new</span> Student(StuId, StuName, course1, course2, course3, EnterTime, email);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">54</span></pre></td><td class="code"><pre><span class="line">            stu.setHeadImg(headImg);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">55</span></pre></td><td class="code"><pre><span class="line">            stu.setId(Id);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">56</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">return</span> stu;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">57</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">58</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">59</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">60</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">61</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//查</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">62</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ArrayList&lt;Student&gt; <span class="title">queryAll</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">63</span></pre></td><td class="code"><pre><span class="line">        String sql = <span class="string">"select * from Student"</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">64</span></pre></td><td class="code"><pre><span class="line">        ArrayList&lt;Student&gt; res = <span class="keyword">new</span> ArrayList&lt;Student&gt;();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">65</span></pre></td><td class="code"><pre><span class="line">        JDBCUtil util = JDBCUtil.getInstance();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">66</span></pre></td><td class="code"><pre><span class="line">        List&lt;Object&gt; tmp = util.excuteQuery(sql, <span class="keyword">null</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">67</span></pre></td><td class="code"><pre><span class="line">        HashMap&lt;String, Object&gt; map;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">68</span></pre></td><td class="code"><pre><span class="line">        SimpleDateFormat format = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyyMMdd"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">69</span></pre></td><td class="code"><pre><span class="line">        Student stu;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">70</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">int</span> Id;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">71</span></pre></td><td class="code"><pre><span class="line">        String StuId;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">72</span></pre></td><td class="code"><pre><span class="line">        String StuName;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">73</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">int</span> course1;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">74</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">int</span> course2;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">75</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">int</span> course3;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">76</span></pre></td><td class="code"><pre><span class="line">        String EnterTime;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">77</span></pre></td><td class="code"><pre><span class="line">        String email;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">78</span></pre></td><td class="code"><pre><span class="line">        String headImg;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">79</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">for</span> (Object obj : tmp) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">80</span></pre></td><td class="code"><pre><span class="line">            map = (HashMap&lt;String, Object&gt;) obj;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">81</span></pre></td><td class="code"><pre><span class="line">            Id = (Integer) map.get(<span class="string">"id"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">82</span></pre></td><td class="code"><pre><span class="line">            StuId = (String) map.get(<span class="string">"StuId"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">83</span></pre></td><td class="code"><pre><span class="line">            StuName = (String) map.get(<span class="string">"StuName"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">84</span></pre></td><td class="code"><pre><span class="line">            course1 = (Integer) map.get(<span class="string">"Course1"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">85</span></pre></td><td class="code"><pre><span class="line">            course2 = (Integer) map.get(<span class="string">"Course2"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">86</span></pre></td><td class="code"><pre><span class="line">            course3 = (Integer) map.get(<span class="string">"Course3"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">87</span></pre></td><td class="code"><pre><span class="line">            EnterTime = format.format((Timestamp) (map.get(<span class="string">"EnterTime"</span>)));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">88</span></pre></td><td class="code"><pre><span class="line">            email = (String) map.get(<span class="string">"Email"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">89</span></pre></td><td class="code"><pre><span class="line">            headImg = (String) map.get(<span class="string">"headImg"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">90</span></pre></td><td class="code"><pre><span class="line">            stu = <span class="keyword">new</span> Student(StuId, StuName, course1, course2, course3, EnterTime, email);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">91</span></pre></td><td class="code"><pre><span class="line">            stu.setHeadImg(headImg);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">92</span></pre></td><td class="code"><pre><span class="line">            stu.setId(Id);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">93</span></pre></td><td class="code"><pre><span class="line">            res.add(stu);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">94</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">95</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> res;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">96</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">97</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">98</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//更新</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">99</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(Student student)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">100</span></pre></td><td class="code"><pre><span class="line">        String sql = <span class="string">"update Student set StuId = ? , StuName = ? , Course1 = ? , Course2 = ? , Course3 = ? , EnterTime = ? , Email = ? , headImg = ? where id =  ?"</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">101</span></pre></td><td class="code"><pre><span class="line">        JDBCUtil util = JDBCUtil.getInstance();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">102</span></pre></td><td class="code"><pre><span class="line">        util.executeUpdate(sql, <span class="keyword">new</span> Object[]&#123;student.getStuId(), student.getStuName(), student.getCourse1(),</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">103</span></pre></td><td class="code"><pre><span class="line">                student.getCourse2(), student.getCourse3(), student.getEnterTime(), student.getEmail(), student.getHeadImg(), student.getId()&#125;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">104</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">105</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure><p>接下来是业务层，这里写了两个类，一个对应对记录的各种操作：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.stu.Action;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionContext;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionSupport;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.stu.Util.StudentDao;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.stu.model.Student;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.struts2.ServletActionContext;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.List;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.regex.Pattern;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentAction</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> List&lt;Integer&gt; grade;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> Student student = <span class="keyword">new</span> Student();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> ArrayList&lt;Student&gt; students = <span class="keyword">new</span> ArrayList&lt;Student&gt;();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> Id;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">StudentAction</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">        grade = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">100</span>; i++)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line">            grade.add(i);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> Id;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line">        Id = id;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">35</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">36</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">37</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> Student <span class="title">getStudent</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">38</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> student;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">39</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">40</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">41</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">getGrade</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">42</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> grade;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">43</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">44</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">45</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setGrade</span><span class="params">(List&lt;Integer&gt; grade)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">46</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">this</span>.grade = grade;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">47</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">48</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">49</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStudent</span><span class="params">(Student student)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">50</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">this</span>.student = student;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">51</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">52</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">53</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> ArrayList&lt;Student&gt; <span class="title">getStudents</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">54</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> students;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">55</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">56</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">57</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStudents</span><span class="params">(ArrayList&lt;Student&gt; students)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">58</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">this</span>.students = students;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">59</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">60</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">61</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">listAll</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">62</span></pre></td><td class="code"><pre><span class="line">        students = StudentDao.queryAll();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">63</span></pre></td><td class="code"><pre><span class="line">        System.out.println(students.size());</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">64</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> <span class="string">"success"</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">65</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">66</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">67</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">addStu</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">68</span></pre></td><td class="code"><pre><span class="line">        System.out.println(student);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">69</span></pre></td><td class="code"><pre><span class="line">        StudentDao.insert(student);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">70</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> <span class="string">"success"</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">71</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">72</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">73</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">editStu</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">74</span></pre></td><td class="code"><pre><span class="line">        System.out.println(student);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">75</span></pre></td><td class="code"><pre><span class="line">        StudentDao.update(student);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">76</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> <span class="string">"success"</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">77</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">78</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">79</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">goToEdit</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">80</span></pre></td><td class="code"><pre><span class="line">        System.out.println(Id);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">81</span></pre></td><td class="code"><pre><span class="line">        student = StudentDao.select(Id);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">82</span></pre></td><td class="code"><pre><span class="line">        System.out.println(student);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">83</span></pre></td><td class="code"><pre><span class="line">        ActionContext.getContext().getSession().put(<span class="string">"headImg"</span>,student.getHeadImg());</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">84</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> <span class="string">"success"</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">85</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">86</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">87</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">deleteStu</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">88</span></pre></td><td class="code"><pre><span class="line">        StudentDao.delete(Id);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">89</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> <span class="string">"success"</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">90</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">91</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">92</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">validateAddStu</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">93</span></pre></td><td class="code"><pre><span class="line">        vali();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">94</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">95</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">96</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">validateEditStu</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">97</span></pre></td><td class="code"><pre><span class="line">        vali();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">98</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">99</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">100</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">vali</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">101</span></pre></td><td class="code"><pre><span class="line">        String username = student.getStuName();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">102</span></pre></td><td class="code"><pre><span class="line">        String studentId = student.getStuId();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">103</span></pre></td><td class="code"><pre><span class="line">        String email = student.getEmail();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">104</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> (studentId == <span class="keyword">null</span> || studentId.isEmpty())</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">105</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">this</span>.addFieldError(<span class="string">"error"</span>, <span class="string">"Student Id cannot be empty"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">106</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (!Pattern.matches(<span class="string">"^[a-zA-Z][a-zA-Z0-9_]&#123;3,14&#125;$"</span>, studentId))</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">107</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">this</span>.addFieldError(<span class="string">"error"</span>, <span class="string">"Student Id must start with character\n and can follow with"</span> +</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">108</span></pre></td><td class="code"><pre><span class="line">                    <span class="string">" digital  character or underline which length between 4 and 15"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">109</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (username == <span class="keyword">null</span> || username.isEmpty())</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">110</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">this</span>.addFieldError(<span class="string">"error"</span>, <span class="string">"Student Name cannot be empty"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">111</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (email == <span class="keyword">null</span> || email.isEmpty())</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">112</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">this</span>.addFieldError(<span class="string">"error"</span>, <span class="string">"email cannot be empty"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">113</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (!Pattern.matches(<span class="string">"^[A-Za-z0-9\\u4e00-\\u9fa5]+@[a-zA-Z0-9_-]+(\\.[a-zA-Z0-9_-]+)+$"</span>, email))</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">114</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">this</span>.addFieldError(<span class="string">"error"</span>, <span class="string">"email address illegal"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">115</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">116</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure><p>一个专门对应图片的上传：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.stu.Action;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionContext;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionSupport;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.stu.Util.StudentDao;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.stu.model.Student;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.struts2.ServletActionContext;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UploadAction</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> String savePath;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> File file;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> String fileFileName;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> String fileContentType;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> Id;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> id;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> Student student;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSavePath</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> savePath;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSavePath</span><span class="params">(String savePath)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">this</span>.savePath = savePath;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> File <span class="title">getFile</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> file;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFile</span><span class="params">(File file)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">this</span>.file = file;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">35</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">36</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getFileFileName</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">37</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> fileFileName;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">38</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">39</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">40</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFileFileName</span><span class="params">(String fileFileName)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">41</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">this</span>.fileFileName = fileFileName;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">42</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">43</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">44</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getFileContentType</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">45</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> fileContentType;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">46</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">47</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">48</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFileContentType</span><span class="params">(String fileContentType)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">49</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">this</span>.fileContentType = fileContentType;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">50</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">51</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">52</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">53</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> Id;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">54</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">55</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">56</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">57</span></pre></td><td class="code"><pre><span class="line">        Id = id;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">58</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">59</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">60</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> Student <span class="title">getStudent</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">61</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> student;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">62</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">63</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">64</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStudent</span><span class="params">(Student student)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">65</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">this</span>.student = student;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">66</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">67</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">68</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">upload</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">69</span></pre></td><td class="code"><pre><span class="line">        String path = ServletActionContext.getServletContext().getRealPath(savePath);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">70</span></pre></td><td class="code"><pre><span class="line">        File saveFile = <span class="keyword">new</span> File(path);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">71</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> (!saveFile.exists())</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">72</span></pre></td><td class="code"><pre><span class="line">            saveFile.mkdir();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">73</span></pre></td><td class="code"><pre><span class="line">        String saveFilePath = path+<span class="string">"/"</span> + fileFileName;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">74</span></pre></td><td class="code"><pre><span class="line">        System.out.println(saveFilePath);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">75</span></pre></td><td class="code"><pre><span class="line">        BufferedInputStream bis = <span class="keyword">null</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">76</span></pre></td><td class="code"><pre><span class="line">        BufferedOutputStream bos = <span class="keyword">null</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">77</span></pre></td><td class="code"><pre><span class="line">        String url = savePath + <span class="string">"/"</span> + fileFileName;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">78</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">try</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">79</span></pre></td><td class="code"><pre><span class="line">            bis = <span class="keyword">new</span> BufferedInputStream(<span class="keyword">new</span> FileInputStream(file));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">80</span></pre></td><td class="code"><pre><span class="line">            bos = <span class="keyword">new</span> BufferedOutputStream(<span class="keyword">new</span> FileOutputStream(saveFilePath));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">81</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[(<span class="keyword">int</span>) file.length()];</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">82</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">int</span> len;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">83</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">while</span> ((len = bis.read(buf)) != -<span class="number">1</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">84</span></pre></td><td class="code"><pre><span class="line">                bos.write(buf, <span class="number">0</span>, len);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">85</span></pre></td><td class="code"><pre><span class="line">            student = StudentDao.select(id);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">86</span></pre></td><td class="code"><pre><span class="line">            System.out.println(student);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">87</span></pre></td><td class="code"><pre><span class="line">            System.out.println(id);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">88</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">if</span> (student != <span class="keyword">null</span>) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">89</span></pre></td><td class="code"><pre><span class="line">                student.setHeadImg(url);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">90</span></pre></td><td class="code"><pre><span class="line">                StudentDao.update(student);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">91</span></pre></td><td class="code"><pre><span class="line">                student = StudentDao.select(id);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">92</span></pre></td><td class="code"><pre><span class="line">                System.out.println(student);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">93</span></pre></td><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">94</span></pre></td><td class="code"><pre><span class="line">            System.out.println(student);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">95</span></pre></td><td class="code"><pre><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">96</span></pre></td><td class="code"><pre><span class="line">            e.printStackTrace();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">97</span></pre></td><td class="code"><pre><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">98</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">if</span> (bis != <span class="keyword">null</span>) bis.close();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">99</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">if</span> (bos != <span class="keyword">null</span>) bos.close();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">100</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">101</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> <span class="string">"success"</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">102</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">103</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">104</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">goToUpload</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">105</span></pre></td><td class="code"><pre><span class="line">        student = StudentDao.select(Id);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">106</span></pre></td><td class="code"><pre><span class="line">        id = Id;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">107</span></pre></td><td class="code"><pre><span class="line">        ActionContext.getContext().getSession().put(<span class="string">"headImg"</span>,student.getHeadImg());</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">108</span></pre></td><td class="code"><pre><span class="line">        System.out.println(Id);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">109</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> <span class="string">"success"</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">110</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">111</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">112</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure><p>在页面层中，加载完毕后先列出所有记录的函数：</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">...</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib prefix=<span class="string">"s"</span> uri=<span class="string">"/struts-tags"</span>%&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">&lt;% </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">String path = request.getContextPath(); </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">String basePath = request.getScheme()+<span class="string">"://"</span>+request.getServerName()+<span class="string">":"</span>+request.getServerPort()+path+<span class="string">"/"</span>; </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">pageContext.setAttribute(<span class="string">"basePath"</span>,basePath); </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">%&gt; </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">&lt;head&gt;...&lt;/head&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">&lt;body&gt;&lt;/body&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">&lt;script  type=<span class="string">"text/javascript"</span>&gt;  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">window.location.replace(<span class="string">"$&#123;pageScope.basePath&#125;/listAll"</span>);  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">&lt;/script&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">&lt;/html&gt;</span></pre></td></tr></table></figure><p>这个过程会跳转到<code>main.jsp</code>：</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">...</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib prefix=<span class="string">"s"</span> uri=<span class="string">"/struts-tags"</span> %&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">&lt;%</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    String path = request.getContextPath();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    String basePath = request.getScheme() + <span class="string">"://"</span> + request.getServerName() + <span class="string">":"</span> + request.getServerPort() + path + <span class="string">"/"</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    pageContext.setAttribute(<span class="string">"basePath"</span>, basePath);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">%&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">&lt;head&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">    &lt;style type=<span class="string">"text/css"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">        th &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">            width: <span class="number">1</span>px;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">            white-space: nowrap; <span class="comment">/* 自适应宽度*/</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">            word-<span class="keyword">break</span>: keep-all; <span class="comment">/* 避免长单词截断，保持全部 */</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">            background-color: gray;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">            text-color: white;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">        td &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">            text-align: center;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">        table &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">            table-layout: fixed;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">            width: <span class="number">100</span>%;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">    &lt;/style&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line">&lt;/head&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line">&lt;center&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line">    &lt;h2&gt;Student Info Manage System&lt;/h2&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line">    &lt;hr/&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line">    &lt;span&gt;&lt;a href="$&#123;pageScope.basePath&#125;/listAll"&gt;refresh&lt;/a&gt;&lt;/span&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line">    &lt;span&gt;&lt;a href="$&#123;pageScope.basePath&#125;/addNew.jsp"&gt;add student&lt;/a&gt;&lt;/span&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line">    &lt;table align=<span class="string">"center"</span> border=<span class="string">"1"</span> width=<span class="string">"50%"</span> cellspacing=<span class="string">"0"</span> cellpadding=<span class="string">"0"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line">        &lt;tr&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">35</span></pre></td><td class="code"><pre><span class="line">            &lt;th&gt;序列号&lt;/th&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">36</span></pre></td><td class="code"><pre><span class="line">            &lt;th&gt;头像&lt;/th&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">37</span></pre></td><td class="code"><pre><span class="line">            &lt;th&gt;学生学号&lt;/th&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">38</span></pre></td><td class="code"><pre><span class="line">            &lt;th&gt;学生姓名&lt;/th&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">39</span></pre></td><td class="code"><pre><span class="line">            &lt;th&gt;课程1成绩&lt;/th&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">40</span></pre></td><td class="code"><pre><span class="line">            &lt;th&gt;课程2成绩&lt;/th&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">41</span></pre></td><td class="code"><pre><span class="line">            &lt;th&gt;课程3成绩&lt;/th&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">42</span></pre></td><td class="code"><pre><span class="line">            &lt;th&gt;入学时间&lt;/th&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">43</span></pre></td><td class="code"><pre><span class="line">            &lt;th&gt;电子邮箱&lt;/th&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">44</span></pre></td><td class="code"><pre><span class="line">            &lt;th&gt;操作&lt;/th&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">45</span></pre></td><td class="code"><pre><span class="line">            &lt;th&gt;上传头像&lt;/th&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">46</span></pre></td><td class="code"><pre><span class="line">        &lt;/tr&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">47</span></pre></td><td class="code"><pre><span class="line">        &lt;s:iterator value=<span class="string">"students"</span> status=<span class="string">"i"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">48</span></pre></td><td class="code"><pre><span class="line">&lt;tr&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">49</span></pre></td><td class="code"><pre><span class="line">&lt;td&gt;&lt;s:property value="Id"/&gt;&lt;/td&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">50</span></pre></td><td class="code"><pre><span class="line">&lt;td&gt;&lt;img style="width: 30px;height: 30px;border-radius: 50%" src="&lt;%=basePath%&gt;$&#123;headImg&#125;"&gt;&lt;/td&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">51</span></pre></td><td class="code"><pre><span class="line">&lt;td&gt;&lt;s:property value="StuId"/&gt;&lt;/td&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">52</span></pre></td><td class="code"><pre><span class="line">&lt;td&gt;&lt;s:property value="StuName"/&gt;&lt;/td&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">53</span></pre></td><td class="code"><pre><span class="line">&lt;td&gt;&lt;s:property value="course1"/&gt;&lt;/td&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">54</span></pre></td><td class="code"><pre><span class="line">&lt;td&gt;&lt;s:property value="course2"/&gt;&lt;/td&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">55</span></pre></td><td class="code"><pre><span class="line">&lt;td&gt;&lt;s:property value="course3"/&gt;&lt;/td&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">56</span></pre></td><td class="code"><pre><span class="line">&lt;td&gt;&lt;s:property value="EnterTime"/&gt;&lt;/td&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">57</span></pre></td><td class="code"><pre><span class="line">&lt;td&gt;&lt;s:property value="email"/&gt;&lt;/td&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">58</span></pre></td><td class="code"><pre><span class="line">&lt;td&gt;&lt;a href="$&#123;pageScope.basePath&#125;/goToEdit?Id=$&#123;Id&#125;"&gt;edit&lt;/a&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">59</span></pre></td><td class="code"><pre><span class="line">&lt;a href="$&#123;pageScope.basePath&#125;/deleteStu?Id=$&#123;Id&#125;"&gt;delete&lt;/a&gt;&lt;/td&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">60</span></pre></td><td class="code"><pre><span class="line">&lt;td&gt;&lt;a href="$&#123;pageScope.basePath&#125;/goToUpdate?Id=$&#123;Id&#125;"&gt;upload&lt;/a&gt;&lt;/td&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">61</span></pre></td><td class="code"><pre><span class="line">&lt;/tr&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">62</span></pre></td><td class="code"><pre><span class="line">        &lt;/s:iterator&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">63</span></pre></td><td class="code"><pre><span class="line">    &lt;/table&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">64</span></pre></td><td class="code"><pre><span class="line">&lt;/center&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">65</span></pre></td><td class="code"><pre><span class="line">&lt;/body&gt;</span></pre></td></tr></table></figure><p>这个页面有俩按钮，可以刷新和添加记录。添加记录页面如下:</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">...</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib prefix=<span class="string">"s"</span> uri=<span class="string">"/struts-tags"</span> %&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">&lt;head&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">...</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    &lt;link rel=<span class="string">"stylesheet"</span> type=<span class="string">"text/css"</span> href=<span class="string">"css/jquery.datetimepicker.min.css"</span>/&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">    &lt;script src="js/jquery.js"&gt;&lt;/script&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">    &lt;script src="js/jquery.datetimepicker.full.min.js"&gt;&lt;/script&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">&lt;/head&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">&lt;center&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">    &lt;h2&gt;Add New Student Info&lt;/h2&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">    &lt;hr/&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">    &lt;s:form method=<span class="string">"post"</span> action=<span class="string">"addStu"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">        &lt;s:fielderror value=<span class="string">"error"</span> cssStyle=<span class="string">"list-style: none;color: red"</span>/&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">        &lt;s:bean id=<span class="string">"aa"</span> name=<span class="string">"com.stu.Action.StudentAction"</span>/&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">        &lt;s:textfield name=<span class="string">"student.StuId"</span> label=<span class="string">"Student ID"</span>/&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">        &lt;s:textfield name=<span class="string">"student.StuName"</span> label=<span class="string">"Student Name"</span>/&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">        &lt;s:select list=<span class="string">"#aa.grade"</span> name=<span class="string">"student.course1"</span> label=<span class="string">"Course1 Grade"</span>/&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">        &lt;s:select list=<span class="string">"#aa.grade"</span> name=<span class="string">"student.course2"</span> label=<span class="string">"Course2 Grade"</span>/&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">        &lt;s:select list=<span class="string">"#aa.grade"</span> name=<span class="string">"student.course3"</span> label=<span class="string">"Course3 Grade"</span>/&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">        &lt;s:textfield readonly=<span class="string">"true"</span> value=<span class="string">"20000101"</span> cssClass=<span class="string">"datetimepicker"</span> name=<span class="string">"student.EnterTime"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">                     label=<span class="string">"EnterTime"</span>/&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">        &lt;s:textfield name=<span class="string">"student.email"</span> label=<span class="string">"Email"</span>/&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">        &lt;s:reset value=<span class="string">"重置"</span> align=<span class="string">"left"</span>/&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line">        &lt;s:submit value=<span class="string">"登陆"</span> align=<span class="string">"left"</span>/&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line">    &lt;/s:form&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line">&lt;/center&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line">&lt;/body&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">"text/javascript"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line">    jQuery(<span class="string">'.datetimepicker'</span>).datetimepicker(&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line">        timepicker: <span class="keyword">false</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line">        format: <span class="string">'Ymd'</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line">    &#125;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">35</span></pre></td><td class="code"><pre><span class="line">&lt;/script&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">36</span></pre></td><td class="code"><pre><span class="line">&lt;/html&gt;</span></pre></td></tr></table></figure><p>每条记录还分别有编辑、删除和上传照片按钮，编辑界面如下：</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">...</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib prefix=<span class="string">"s"</span> uri=<span class="string">"/struts-tags"</span> %&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">&lt;%</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    String path = request.getContextPath();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    String basePath = request.getScheme() + <span class="string">"://"</span> + request.getServerName() + <span class="string">":"</span> + request.getServerPort() + path + <span class="string">"/"</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    String headImg = (String) session.getAttribute(<span class="string">"headImg"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">%&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">&lt;head&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">    &lt;link rel=<span class="string">"stylesheet"</span> type=<span class="string">"text/css"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">          href=<span class="string">"css/jquery.datetimepicker.min.css"</span>/&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">    &lt;script src="js/jquery.js"&gt;&lt;/script&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">    &lt;script src="js/jquery.datetimepicker.full.min.js"&gt;&lt;/script&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">&lt;/head&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">&lt;center&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">    &lt;h2&gt;update Student Info&lt;/h2&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">    &lt;hr/&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">    &lt;form action=<span class="string">"editStu"</span> method=<span class="string">"post"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">        &lt;s:bean name=<span class="string">"com.stu.Action.StudentAction"</span> id=<span class="string">"aa"</span>/&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">        &lt;s:fielderror value=<span class="string">"error"</span> cssStyle=<span class="string">"list-style: none;color: red"</span>/&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">        &lt;table&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">            &lt;tr hidden=<span class="string">"hidden"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">                &lt;td&gt;Student ID:&lt;/td&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">                &lt;td&gt;&lt;input type="text" name="student.Id" value="$&#123;student.id&#125;"/&gt;&lt;/td&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line">            &lt;/tr&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line">            &lt;tr&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line">                &lt;td&gt;Student ID:&lt;/td&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line">                &lt;td&gt;&lt;input type="text" name="student.StuId" value="$&#123;student.stuId&#125;"/&gt;&lt;/td&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line">            &lt;/tr&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line">            &lt;tr&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line">                &lt;td&gt;Student Name:&lt;/td&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line">                &lt;td&gt;&lt;input type="text" name="student.StuName" value="$&#123;student.stuName&#125;"/&gt;&lt;/td&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line">            &lt;/tr&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">35</span></pre></td><td class="code"><pre><span class="line">            &lt;tr&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">36</span></pre></td><td class="code"><pre><span class="line">                &lt;td&gt;Course1 Grade:&lt;/td&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">37</span></pre></td><td class="code"><pre><span class="line">                &lt;s:select list=<span class="string">"#aa.grade"</span> name=<span class="string">"student.course1"</span>/&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">38</span></pre></td><td class="code"><pre><span class="line">            &lt;/tr&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">39</span></pre></td><td class="code"><pre><span class="line">            &lt;tr&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">40</span></pre></td><td class="code"><pre><span class="line">                &lt;td&gt;Course2 Grade:&lt;/td&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">41</span></pre></td><td class="code"><pre><span class="line">                &lt;s:select list=<span class="string">"#aa.grade"</span> name=<span class="string">"student.course2"</span>/&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">42</span></pre></td><td class="code"><pre><span class="line">            &lt;/tr&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">43</span></pre></td><td class="code"><pre><span class="line">            &lt;tr&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">44</span></pre></td><td class="code"><pre><span class="line">                &lt;td&gt;Course3 Grade:&lt;/td&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">45</span></pre></td><td class="code"><pre><span class="line">                &lt;s:select list=<span class="string">"#aa.grade"</span> name=<span class="string">"student.course3"</span>/&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">46</span></pre></td><td class="code"><pre><span class="line">            &lt;/tr&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">47</span></pre></td><td class="code"><pre><span class="line">            &lt;tr&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">48</span></pre></td><td class="code"><pre><span class="line">                &lt;td&gt;Enter Time:&lt;/td&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">49</span></pre></td><td class="code"><pre><span class="line">                &lt;td&gt;&lt;input readonly id=<span class="string">"datetimepicker"</span> type=<span class="string">"text"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">50</span></pre></td><td class="code"><pre><span class="line">                           name="student.EnterTime" value="$&#123;student.enterTime&#125;"/&gt;&lt;/td&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">51</span></pre></td><td class="code"><pre><span class="line">            &lt;/tr&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">52</span></pre></td><td class="code"><pre><span class="line">            &lt;tr&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">53</span></pre></td><td class="code"><pre><span class="line">                &lt;td&gt;Email:&lt;/td&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">54</span></pre></td><td class="code"><pre><span class="line">                &lt;td&gt;&lt;input type="String" name="student.email" value="$&#123;student.email&#125;"/&gt;&lt;/td&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">55</span></pre></td><td class="code"><pre><span class="line">            &lt;/tr&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">56</span></pre></td><td class="code"><pre><span class="line">            &lt;tr&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">57</span></pre></td><td class="code"><pre><span class="line">                &lt;td&gt;head img:&lt;/td&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">58</span></pre></td><td class="code"><pre><span class="line">                &lt;td&gt;&lt;img style="width: 100px;height: 100px;" src="&lt;%=basePath%&gt;&lt;%=headImg%&gt;"/&gt;&lt;/td&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">59</span></pre></td><td class="code"><pre><span class="line">            &lt;/tr&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">60</span></pre></td><td class="code"><pre><span class="line">            &lt;tr&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">61</span></pre></td><td class="code"><pre><span class="line">                &lt;td colspan="2"&gt;&lt;input type="submit" value="submit"&gt;&lt;/td&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">62</span></pre></td><td class="code"><pre><span class="line">            &lt;/tr&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">63</span></pre></td><td class="code"><pre><span class="line">        &lt;/table&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">64</span></pre></td><td class="code"><pre><span class="line">    &lt;/form&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">65</span></pre></td><td class="code"><pre><span class="line">&lt;/center&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">66</span></pre></td><td class="code"><pre><span class="line">&lt;/body&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">67</span></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">"text/javascript"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">68</span></pre></td><td class="code"><pre><span class="line">    jQuery(<span class="string">'#datetimepicker'</span>).datetimepicker(&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">69</span></pre></td><td class="code"><pre><span class="line">        timepicker: <span class="keyword">false</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">70</span></pre></td><td class="code"><pre><span class="line">        format: <span class="string">'Ymd'</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">71</span></pre></td><td class="code"><pre><span class="line">    &#125;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">72</span></pre></td><td class="code"><pre><span class="line">&lt;/script&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">73</span></pre></td><td class="code"><pre><span class="line">&lt;/html&gt;</span></pre></td></tr></table></figure><p>上传界面如下：</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib prefix=<span class="string">"s"</span> uri=<span class="string">"/struts-tags"</span> %&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">&lt;%</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">    String path = request.getContextPath();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    String basePath = request.getScheme() + <span class="string">"://"</span> + request.getServerName() + <span class="string">":"</span> + request.getServerPort() + path + <span class="string">"/"</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    String headImg = (String) session.getAttribute(<span class="string">"headImg"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">%&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">&lt;head&gt;...&lt;/head&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">&lt;center&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">    &lt;h3&gt;Image Upload&lt;/h3&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">    &lt;hr/&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">    &lt;form action=<span class="string">"upload.action"</span> method=<span class="string">"post"</span> enctype=<span class="string">"multipart/form-data"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">        &lt;label for="file"&gt;Upload your image :&lt;/label&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">        &lt;input type=<span class="string">"file"</span> id=<span class="string">"file"</span> name=<span class="string">"file"</span>/&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">        &lt;label style=<span class="string">"display: block;"</span> <span class="keyword">for</span>=<span class="string">"file"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">            &lt;img style=<span class="string">"width: 400px;height: 400px;"</span> id=<span class="string">"Img"</span> src=<span class="string">"&lt;%=basePath%&gt;&lt;%=headImg%&gt;"</span>/&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">        &lt;/label&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">        &lt;input type=<span class="string">"submit"</span> value=<span class="string">"Upload"</span>/&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">    &lt;/form&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">&lt;/center&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">&lt;/body&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">"text/javascript"</span>&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">    $(<span class="string">'#file'</span>).change(function () &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">        $(<span class="string">'p'</span>).css(<span class="string">'display'</span>, <span class="string">'none'</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">var</span> objUrl = getObjectURL(<span class="keyword">this</span>.files[<span class="number">0</span>]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> (objUrl) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line">            $(<span class="string">'#Img'</span>).attr(<span class="string">"src"</span>, objUrl);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line">        <span class="function">function <span class="title">getObjectURL</span><span class="params">(file)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">var</span> url = <span class="keyword">null</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">if</span> (window.createObjectURL !== undefined) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line">                url = window.createObjectURL(file);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">35</span></pre></td><td class="code"><pre><span class="line">            &#125; <span class="keyword">else</span> window.webkitURL = undefined;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">36</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">if</span> (window.URL !== undefined) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">37</span></pre></td><td class="code"><pre><span class="line">                url = window.URL.createObjectURL(file);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">38</span></pre></td><td class="code"><pre><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (window.webkitURL !== undefined) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">39</span></pre></td><td class="code"><pre><span class="line">                url = window.webkitURL.createObjectURL(file);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">40</span></pre></td><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">41</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">return</span> url;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">42</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">43</span></pre></td><td class="code"><pre><span class="line">    &#125;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">44</span></pre></td><td class="code"><pre><span class="line">&lt;/script&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">45</span></pre></td><td class="code"><pre><span class="line">&lt;/html&gt;</span></pre></td></tr></table></figure><p>Struts感觉好像有点过时，应该只会了解到这里，不会再深入学习了。Spring MVC现在好像用得多？还有以JS为主的那些东西……</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;&quot; /&gt;&lt;/p&gt;
&lt;center&gt;
理解MVC模式与SSH框架。
&lt;/center&gt;
    
    </summary>
    
    
      <category term="表世界" scheme="http://yoursite.com/categories/%E8%A1%A8%E4%B8%96%E7%95%8C/"/>
    
      <category term="Struts2" scheme="http://yoursite.com/categories/%E8%A1%A8%E4%B8%96%E7%95%8C/Struts2/"/>
    
    
      <category term="JSP" scheme="http://yoursite.com/tags/JSP/"/>
    
      <category term="Struts2" scheme="http://yoursite.com/tags/Struts2/"/>
    
      <category term="SSH" scheme="http://yoursite.com/tags/SSH/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript与jQuery基础知识</title>
    <link href="http://yoursite.com/2019/12/15/%E8%A1%A8%E4%B8%96%E7%95%8C/JavaScript%E4%B8%8EjQuery/JavaScript%E4%B8%8EjQuery%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    <id>http://yoursite.com/2019/12/15/%E8%A1%A8%E4%B8%96%E7%95%8C/JavaScript%E4%B8%8EjQuery/JavaScript%E4%B8%8EjQuery%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/</id>
    <published>2019-12-14T16:00:00.000Z</published>
    <updated>2019-12-15T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="" /></p><center></center><a id="more"></a><p>JS是JavaScript的缩写，是互联网上被广泛应用的脚本语言。</p><h1 id="代码的引入">代码的引入</h1><p>JS代码一般出现在<code>.html</code>和<code>.js</code>文件中，通过单独写成<code>.js</code>，使用外部代码引用的方式实现JS代码可以增强JS模块化开发程度并且提高代码重用率；在HTML网页中编写JS代码时，推荐出现在head区域。</p><h2 id="head和body中插入">head和body中插入</h2><p>通过<code>&lt;script&gt;</code>标签把代码插入到HTML页面，<code>&lt;script type=&quot;text/JavaScript&quot;&gt;</code>和<code>&lt;/script&gt;</code>分别标记了JS代码的开始和结束。也就是说，在HTML页面文件引入JS代码，script标签的type属性要设置为<code>text/JavaScript</code>。</p><h2 id="引用外部代码">引用外部代码</h2><p><code>script src=&quot;xx.js&quot;&gt;&lt;/script&gt;</code>。</p><h1 id="代码的编写">代码的编写</h1><p>使用分号来结束一条语句。</p><p>变量名区分大小写。</p><p>运算符有赋值、算术、比较、逻辑、连接和条件运算符。</p><p>只能在function内部进行访问的变量为局部变量，页面内所有函数都可以访问的变量为全局变量。</p><p>条件语句：<code>if</code>、<code>if...else...</code>、<code>if...else if...else...</code>和<code>switch</code>，switch语句要通过<code>break</code>防止代码自动转向到下一个case。</p><p>循环语句：<code>while</code>，<code>for</code>，<code>do...while</code>和<code>for...in</code>循环；语句<code>continue</code>会跳出当轮循环进行下一轮循环，语句<code>break</code>会结束整个循环。</p><p>常用的字符串操作函数：<code>oncat()</code>、<code>indexOf()</code>、<code>match()</code>、<code>replace()</code>、<code>split()</code>、<code>substr()</code>、<code>substring()</code>等。</p><p>八个能从数学对象直接访问的数学值：自然指数E、LN2、LN10、LOG2E、LOG10E、圆周率PI、根二SQRT2、根二分之一SQRT1_2。</p><p>用警示框输出信息，语句为<code>alert(&quot;xxx&quot;)</code>。</p><p>编写命名函数需要以<code>function</code>关键词开头，<code>return</code>指定JS函数的返回值。通过<strong>事件触发</strong>和<strong>被调用</strong>来执行。例如HTML脚本<code>&lt;input type=&quot;text&quot; size=&quot;30“ id=&quot;email&quot; onchange=&quot;checkEmail()&quot;&gt;</code>中，当输入框内容改变时触发事件“onchange”，此时调用JS函数<code>checkEmail()</code>；对一个更复杂些的例子，<code>&lt;input type=&quot;text&quot; name=&quot;username&quot; id=&quot;username&quot; onblur=&quot;checkusername();checkusername2();&quot; onfocus=&quot;checkusername2();&quot; value=&quot;输入用户名&quot;&gt;</code>，表单中有一控件username为输入用户名，此脚本对username输入框的输入内容调用JS函数checkusername校验——注意，这里有多个函数出现，所以要写分号。常用于表单上的JS事件有onfocus（获得光标）、onblur（失去光标）、onchange和onsubmit等；常用于鼠标动作的JS事件有onclick、ondbclick、onmousedown、onmouseover和onmouseup等。</p><p>在HTML文件表单中对其所包含的控件调用JS函数成批校验时，书写的脚本为<code>&lt;form action=&quot;request.jsp&quot; name=&quot;form&quot; onsubmit=&quot;return check();&quot; method=&quot;post&quot;&gt;</code>。</p><p>想要生成页面控件对象时，HTML页面INPUT标签的type属性设为<code>text</code>可在页面得到输入框；type属性设为<code>password</code>可在页面得到口令框；type属性设为<code>radio</code>可在页面得到radio button；type属性设为<code>checkbox</code>可在页面得到checkbox；type属性设为<code>submit</code>可在页面得到submit按钮；type属性设为<code>reset</code>可在页面得到reset按钮；ype属性设为<code>textarea</code>可在页面得到多行编辑控件。</p><p>想要获取页面控件对象时，如果控件有id属性，如<code>&lt;input id=&quot;username&quot; type=&quot;text&quot; &gt;</code>可以<code>document.getElementById(&quot;username&quot;)</code>；也可以利用name属性，如<code>&lt;label name=&quot;female&quot;&gt;Female&lt;/label&gt;</code>可以<code>document.getElementsByName(&quot;female&quot;)[0]</code>，注意name不唯一所以要以数组形式。</p><p>通过<code>try...catch</code>和onerror事件来捕捉错误。</p><h1 id="jquery的导入">jQuery的导入</h1><p>jQuery是一个JavaScript库。以在HTML页面文件引用jQuery库<code>jquery-1.3.1.js</code>为例，<code>&lt;script src=&quot;jquery-1.3.1.js&quot;  type=&quot;text/javascript&quot;&gt;&lt;/script&gt;</code>。</p><p>使用jQuery时，先通过选择器<code>$()</code>，即<code>jQuery()</code>，选择jQuery对象——jQuery对象是通过jQuery库包装DOM对象后产生的对象，DOM意为<strong>文档对象模型（Document Object Model）</strong>——选择好对象后通过<code>.</code>调用jQuery命令，对对象进行修改。</p><h1 id="jquery命令">jQuery命令</h1><p>执行css命令操纵样式、addClass命令设置新样式、removeClass命令删除样式、hasClass命令判断元素是否具有某样式、toggleClass命令切换样式。</p><p>执行append命令向DOM追加元素、remove命令删除DOM中元素、clone命令在DOM中复制节点、replacewith命令在DOM中替换内容、wrap命令在DOM中包裹元素。</p><p>执行show命令显示隐藏的元素，hide命令隐藏元素。</p><p>jQuery的动画函数有animate、slideup、slidedown、fadein、fadeout，以normal、fast、slow三种速度展示动画。</p><p>另一个常用命令是<code>$(document).ready(function(){...})</code>，（<code>$(document)</code>是一个选择器，选中的是整个html所有元素的集合）在页面所有元素准备完毕之后，载入页面之前执行自定义函数。例如在HTML页面文件加载（打开）时弹出“Hello World”的alert对话框，可<code>$(document).ready(function() {alert(&quot;Hello World!&quot;);})</code>。</p><h1 id="jquery选择器">jQuery选择器</h1><h2 id="基本选择器">基本选择器</h2><ul><li>id选择器:<code>$(&quot;#id&quot;)</code>；</li><li>类选择器:<code>$(&quot;.class&quot;)</code>；</li><li>元素选择器：<code>$(&quot;标签名&quot;)</code>；</li><li>全选选择器：<code>$(&quot;*&quot;)</code>。</li></ul><p>示例：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">...</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="javascript">$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="handlebars"><span class="xml"><span class="comment">&lt;!--id选择器--&gt;</span></span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"><span class="javascript">$(<span class="string">"#a"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="javascript">$(<span class="keyword">this</span>).css(<span class="string">'color'</span>, <span class="string">'yellow'</span>);</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line"><span class="handlebars"><span class="xml"><span class="comment">&lt;!--类选择器--&gt;</span></span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line"><span class="javascript">$(<span class="string">".d"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line"><span class="javascript">$(<span class="keyword">this</span>).css(<span class="string">'color'</span>, <span class="string">'red'</span>);</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line"><span class="handlebars"><span class="xml"><span class="comment">&lt;!--id选择器--&gt;</span></span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line"><span class="javascript">$(<span class="string">"#c"</span>).css(<span class="string">'color'</span>, <span class="string">'orange'</span>);</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line"><span class="handlebars"><span class="xml"><span class="comment">&lt;!--全选选择器--&gt;</span></span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line"><span class="javascript">$(<span class="string">"*"</span>).css(<span class="string">'color'</span>, <span class="string">'green'</span>);</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line"><span class="handlebars"><span class="xml"><span class="comment">&lt;!--元素选择器--&gt;</span></span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line"><span class="javascript">$(<span class="string">"p"</span>).css(<span class="string">'color'</span>, <span class="string">'pink'</span>);</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">&#125;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>我是一个粉刷匠<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"a"</span>&gt;</span>你是来搞黄色的吗？<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"b"</span> <span class="attr">class</span>=<span class="string">"d"</span>&gt;</span>气突苏！<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"c"</span> <span class="attr">class</span>=<span class="string">"d"</span>&gt;</span>如果奇迹有颜色，那一定是？<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></pre></td></tr></table></figure><h2 id="层次选择器">层次选择器</h2><p>通过DOM元素之间的层次关系获取特定元素。</p><ul><li><code>$(&quot;ancestor descendant&quot;)</code>：选取所有子元素。</li><li><code>$(&quot;parent&gt;child&quot;)</code>：同上，但仅包含直接子元素。</li><li><code>$(&quot;prev+next&quot;)</code>：选取下一个元素。</li><li><code>$(&quot;prev~siblings&quot;)</code>：同上，但包含之后的所有满足条件元素。</li></ul><h2 id="选择过滤器">选择过滤器</h2><p>jQuery过滤选择器通过指定的过滤器筛选出所需的DOM元素，即在选择器后紧跟<code>:</code>符号，对选取的结果集进行过滤，过滤到的结果通常会有<strong>单个元素</strong>和<strong>集合</strong>两种类型。</p><p>jQuery过滤选择器包括_____、______、______、_____、_____和___。</p><ul><li>基本过滤器<ul><li><code>$('p:first')：</code>选取页面元素内的第一个p元素；</li><li><code>$('p:last')：</code>选取页面元素内的最后一个p元素；</li><li><code>$('p:not(.select)')：</code>选取选择器不是select的p元素；</li><li><code>$('p:even')：</code>选取索引是偶数的P元素（索引从0开始）；</li><li><code>$('p:odd')：</code>选取索引是奇数的p元素（索引从0开始）；</li><li><code>$('p:eq(index)')：</code>选取索引等于index的p元素（索引从0开始，支持负数）；</li><li><code>$('p:gt(index)')：</code>选取索引大于index的p元素（索引从0开始）；</li><li><code>$('p:lt(index)')：</code>选取索引小于index的p元素（索引从0开始）；</li><li><code>$(':header')：</code>选取标题元素h1~h6；</li><li><code>$(':animated')：</code>选取正在执行动画的元素；</li><li><code>$('input:focus')：</code>选取当前被焦点的元素。</li></ul></li><li>内容过滤器<ul><li>选取包含指定文本的元素<code>$(':contains(含有的文本)')</code></li><li>选取含有选择器匹配元素的元素<code>$(&quot;:has('选择器')&quot;)</code></li><li>选取不包含子元素或文本的空元素<code>$(':empty')</code></li><li>选取包含子元素或文本的空元素<code>$(':parent')</code></li></ul></li><li>可见性过滤器<ul><li>选取不可见的元素<code>$(':hidden')</code></li><li>选取可见的元素<code>$(':visible')</code></li></ul></li><li>属性过滤器<ul><li>选取拥有此属性的元素<code>$('选择器[attribute]')</code>；</li><li>选取属性值为value的元素<code>$('选择器[attribute=value]')</code>；</li><li>选取属性值不等于value的元素<code>$('[attribute!=value]')</code>；</li><li>选取属性值以value开始的元素<code>$('选择器[attribute^=value]')</code>；</li><li>选取属性值以value结束的元素<code>$('选择器[attribute$=value]')</code>；</li><li>选取属性值含有value的元素<code>$('选择器[attribute*=value]')</code>；</li><li>选取属性值前缀为value的元素<code>$('选择器[attribute|=value]')</code>；</li><li>选取属性值用空格分隔的值中包含给定值的元素<code>$('选择器[attribute~=value]')</code>；</li><li>组合属性选择器<code>$('选择器[attribute1][attribute2]…[attributeN]')</code>。</li></ul></li><li>子元素过滤器<ul><li>选取每个父元素下的第一个子元素，返回集合元素<code>$('选择器:first-child')</code></li><li>选取每个父元素下的最后一个子元素，返回集合元素<code>$('选择器:last-child')</code></li><li>选取每个父元素下的唯一子元素，返回集合元素<code>$('选择器:only-child')</code>.</li><li>选取每个父元素下的第index个子元素或者奇偶元素，index从1算起<code>$('选择器:nth-child(index)')</code></li></ul></li><li>表单对象属性过滤器<ul><li>:enabled选取页面中所有可用元素</li><li>:disabled选取页面中所有不可用元素</li><li>:checked选取页面中所有被选中的元素（单选框radio、复选框 checkbox）</li><li>:selected选取下拉列表中被选择的元素</li><li>:text选取页面中所有文本框，</li><li>:password选取页面中所有口令框</li><li>:checkbox选取页面中所有检查框</li><li>:image选取页面中所有图像按钮</li><li>:button选取页面中所有按钮</li></ul></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;&quot; /&gt;&lt;/p&gt;
&lt;center&gt;
&lt;/center&gt;
    
    </summary>
    
    
      <category term="表世界" scheme="http://yoursite.com/categories/%E8%A1%A8%E4%B8%96%E7%95%8C/"/>
    
      <category term="JavaScript与jQuery" scheme="http://yoursite.com/categories/%E8%A1%A8%E4%B8%96%E7%95%8C/JavaScript%E4%B8%8EjQuery/"/>
    
    
      <category term="HTML" scheme="http://yoursite.com/tags/HTML/"/>
    
      <category term="JavaScript" scheme="http://yoursite.com/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>JSP基础知识</title>
    <link href="http://yoursite.com/2019/12/14/%E8%A1%A8%E4%B8%96%E7%95%8C/JSP/JSP%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    <id>http://yoursite.com/2019/12/14/%E8%A1%A8%E4%B8%96%E7%95%8C/JSP/JSP%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/</id>
    <published>2019-12-13T16:00:00.000Z</published>
    <updated>2019-12-13T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="" /></p><center>MyEclipse的安装。</center><a id="more"></a><h1 id="servlet和jsp的关系">Servlet和JSP的关系</h1><p>JSP页面缺省的基类是HttpJspBase。</p><p>jsp在运行时首先被解析成一个java类，该类继承于org.apache.jasper.runtime.HtppJspBase类，这个类又继承了HttpServlet。</p><h1 id="jsp脚本元素">JSP脚本元素</h1><p>脚本元素提供了在jsp中插入java代码的能力。脚本元素有三种类型：</p><ul><li>脚本(scriptlet)是JSP页面中Java代码片段的容器。语法：<code>&lt;% java源代码 %&gt;</code>。</li><li>表达式(expression)将转换为String的Java表达式的值插入到返回给客户端的响应中。语法：<code>&lt;%= 表达式语句 %&gt;</code>。</li><li>声明(declarations)为JSP页面声明全局的方法和变量。语法：<code>&lt;%! 字段或方法声明 %&gt;</code>。</li></ul><h1 id="jsp指令元素">JSP指令元素</h1><h2 id="page指令">page指令</h2><p>用于设置页面属性。用<code>&lt;%@ page %&gt;</code>标记在JSP文件头部声明。</p><p>指定JSP页面使用JAVA语言时，使用指令<code>&lt;%@page language=&quot;java&quot;%&gt;</code>。<code>&lt;%@page language=&quot;java&quot; contentType=&quot;text/html&quot; pageEncoding=&quot;UTF-8&quot;%&gt;</code>中pageEncoding设置当前页面的页面编码字符集为UTF-8，contentType设置页面类型为text/html。</p><p>使用页面指令Page的<code>&lt;%@page import=&quot;&quot;%&gt;</code>属性在JSP文件引用一个外部Java类。例如JSP页面要用Java的Date类时，在JSP文件前面用<code>&lt;%@page import=&quot;Java.util.Date&quot;%&gt;</code>把Date类包含。</p><p>用JSP进行前端页面开发时，用<code>&lt;%@page errorPage=&quot;错误页面.jsp&quot;%&gt;</code>设置错误页面，从而方便把多个JSP页面的出错、错误处理信息集中到错误页面处理；对于错误页面，指定<code>&lt;%page isErrorPage=&quot;true&quot;%&gt;</code>。</p><h2 id="include指令">include指令</h2><p>include指令在JSP页面被转换成Servlet前将指定的文件包含。比如说，可能有多页面都需要用到一个logo和一些相应的连接啥的，但可以不每次都写一遍相关代码，而是将相关代码单独写一个<code>logo.jsp</code>，只需在想显示它的地方使用include指令包含进来<code>&lt;%@include file = &quot;logo.jsp&quot;%&gt;</code>。include只能包含静态的资源。</p><h2 id="taglib指令">taglib指令</h2><p>用于导入标签库，使用时需设置两个重要的属性分别是<code>uri</code>和<code>prefix</code>，例如导入jsp标准标签库：<code>&lt;%@ taglib uri=&quot;http://java.sun.com/jsp/jstl/core&quot; prefix=&quot;c&quot;%&gt;</code>。这玩意类似前面的include，但是包含的不是静态jsp，而是一段java代码。导入标签库之后就可以通过<code>&lt;前缀:类名 [参数1 [[参数2 [...]]]]&gt;&lt;/前缀:类名&gt;</code>插入这段代码。</p><h1 id="jsp动作元素">JSP动作元素</h1><p>标签库啥的的调用。</p><p><code>jsp:useBean</code>用于在JSP文件使用指定名称的JavaBean对象。例如在JSP页面会话中调用<code>Test.UserInfo</code>类，对象名为ui，则语句是<code>&lt;jsp:useBean id=&quot;ui&quot; class=&quot;Test.UserInfo&quot; scope=&quot;session&quot; type=&quot;...&quot;/&gt;</code>。</p><p><code>jsp:setProperty</code>设置JavaBean对象成员的值；用<code>jsp:getProperty</code>获取JavaBean对象成员的值。</p><p><code>jsp:forward</code>从当前页面转至其它JSP页面处理（请求转发）。<code>jsp:include</code>包含页面，但与上面的include指令不同，这里不是插入jsp代码，而是在运行后插入这段代码的应答。在转发或包含时，使用<code>jsp:param</code>传递参数。</p><h1 id="jsp的内置对象">jsp的内置对象</h1><ul><li><strong>application对象</strong>将信息保存在服务器中，直到服务器关闭。application对象中保存的信息在整个应用中有效。</li><li><strong>session对象</strong>是由服务器自动创建的与用户请求相关的对象。服务器为每个用户都生成一个session对象，用于保存该用户的信息，跟踪用户的操作状态。session对象内部使用Map类来保存数据，因此保存数据的格式为Key-value。session对象的value可以为复杂的对象类型，而不仅仅局限于字符串类型。<strong>内置对象session通过<code>setAttribute()</code>函数把数据以key-value形式写入保存，通过<code>getAttribute()</code>函数把保存的数据读取出来。JSP页面使用Session内置对象时，需要在JSP文件头部用<code>&lt;%@page session=&quot;true&quot; %&gt;</code>把Session属性设置为true。</strong></li><li><strong>request对象</strong>是javax.servlet.httpServletRequest类型的对象，代表客户端的请求信息，主要用于接受通过HTTP协议传送到服务器的数据。作用域为一次请求。</li><li><strong>response对象</strong>代表对客户端的响应，将JSP容器处理过的对象传回到客户端。response对象只在JSP页面内有效。</li><li><strong>page对象</strong>代表JSP本身，只在JSP页面内合法。类似于Java中的this。</li><li><strong>pageContext对象</strong>的作用是取得任何范围的参数，通过它可以获取JSP页面的out、request、reponse、session、application等对象。pageContext对象的创建和初始化都是由容器来完成的，在JSP页面中可以直接使用pageContext对象。</li><li>out对象用于在Web浏览器内输出信息，并且管理应用服务器上的输出缓冲区。。</li><li>config对象的主要作用是取得服务器的配置信息。通过pageConext对象的<code>getServletConfig()</code>方法可以获取一个config对象。</li><li>exception对象的作用是显示异常信息，在包含<code>isErrorPage=&quot;true&quot;</code>的页面中可以被使用。</li></ul><h1 id="javabean">JavaBean</h1><p>JavaBean是一种仅包含数据属性和对数据进行存取的函数的类。</p><h1 id="外部包">外部包</h1><p>JSP文件用到外部（第三方）JAR包时，应在web项目的web-inf目录下建立lib目录，把jar包复制到<code>web项目/web-inf目录/lib目录</code>。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;&quot; /&gt;&lt;/p&gt;
&lt;center&gt;
MyEclipse的安装。
&lt;/center&gt;
    
    </summary>
    
    
      <category term="表世界" scheme="http://yoursite.com/categories/%E8%A1%A8%E4%B8%96%E7%95%8C/"/>
    
      <category term="JSP" scheme="http://yoursite.com/categories/%E8%A1%A8%E4%B8%96%E7%95%8C/JSP/"/>
    
    
      <category term="JSP" scheme="http://yoursite.com/tags/JSP/"/>
    
  </entry>
  
  <entry>
    <title>肆・语义分析</title>
    <link href="http://yoursite.com/2019/12/11/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/%E8%82%86%E3%83%BB%E8%AF%AD%E4%B9%89%E5%88%86%E6%9E%90/"/>
    <id>http://yoursite.com/2019/12/11/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/%E8%82%86%E3%83%BB%E8%AF%AD%E4%B9%89%E5%88%86%E6%9E%90/</id>
    <published>2019-12-11T12:58:14.000Z</published>
    <updated>2019-12-11T12:58:14.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="" /></p><center></center><a id="more"></a><h1 id="属性文法">属性文法</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">E-&gt; TR&#123;R.in:&#x3D;T.val;E.val&#x3D;R.val&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">R-&gt; +TR&#39;&#123;R&#39;.in:&#x3D;R.in+T.val;R.val:&#x3D;R&#39;.val&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">R-&gt; -TR&#39;&#123;R&#39;.in:&#x3D;R.in-T.val;R.val:&#x3D;R&#39;.val&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">R-&gt; epsilon&#123;R.val:&#x3D;R.in&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">T-&gt; num&#123;T.val:&#x3D;lexval(num)&#125;</span></pre></td></tr></table></figure><h1 id="翻译模式">翻译模式</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">E-&gt; T&#123;R.in:&#x3D;T.val&#125;R&#123;E.val&#x3D;R.val&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">R-&gt; +T&#123;R&#39;.in:&#x3D;R.in+T.val&#125;R&#39;&#123;R.val:&#x3D;R&#39;.val&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">R-&gt; -T&#123;R&#39;.in:&#x3D;R.in-T.val&#125;R&#39;&#123;R.val:&#x3D;R&#39;.val&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">R-&gt; epsilon&#123;R.val:&#x3D;R.in&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">T-&gt; num&#123;T.val:&#x3D;lexval(num)&#125;</span></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ParseE</span><span class="params">()</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="function"></span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">    Tval=ParseT();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    Rval=ParseR(Tval);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    Print(Rval);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ParseR</span><span class="params">(<span class="keyword">int</span> in)</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="function"></span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">if</span>(lookahead==<span class="string">'+'</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">    &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">        MatchToken(<span class="string">'+'</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">        Tval=ParseT();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">        Rval=ParseR(in+Tval);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> Rval;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(lookahead==<span class="string">'-'</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">    &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">        MatchToken(<span class="string">'-'</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">        Tval=ParseT();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">        Rval=ParseR(in-Tval);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> Rval;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">else</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">    &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line">        Rval=in;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> Rval;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ParseT</span><span class="params">()</span></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line"><span class="function"></span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line">    if(lookahead=='num')</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> num;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">35</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">else</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">36</span></pre></td><td class="code"><pre><span class="line">        error();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">37</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure><h1 id="属性文法翻译模式的左递归消除">属性文法/翻译模式的左递归消除</h1><h1 id="四元式的生成">四元式的生成</h1><p>有C片段如下:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">a=x,b=y,c=<span class="number">1</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(b&gt;<span class="number">0</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">if</span>(b%<span class="number">2</span>==<span class="number">1</span>)c=c*a;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    b=b/<span class="number">2</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    a=a*a;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure><p>要获得它的四元式代码，首先将具有复杂含义的语句展开:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">    a=x;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">    b=y;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">    c=<span class="number">1</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="built_in">begin</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">if</span> b&lt;=<span class="number">0</span> <span class="keyword">goto</span> <span class="built_in">end</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">if</span> b%<span class="number">2</span> != <span class="number">1</span> <span class="keyword">goto</span> nxt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">    c=c*a;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">nxt:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">    b=b/<span class="number">2</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">    a=a*a;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">goto</span> <span class="built_in">begin</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="built_in">end</span>:</span></pre></td></tr></table></figure><p>容易得到四元式：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">01 &#x3D; ,x,&#x2F;,a</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">02 &#x3D; ,y,&#x2F;,b</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">03 &#x3D; ,1,&#x2F;,c</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">04 &lt;&#x3D;,b,0,11</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">05 % ,b,2,t</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">06 !&#x3D;,t,1,8</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">07 * ,c,a,c</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">08 &#x2F; ,b,2,b</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">09 * ,a,a,a</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">10 go,&#x2F;,&#x2F;,4</span></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;&quot; /&gt;&lt;/p&gt;
&lt;center&gt;
&lt;/center&gt;
    
    </summary>
    
    
      <category term="深蓝" scheme="http://yoursite.com/categories/%E6%B7%B1%E8%93%9D/"/>
    
      <category term="编译原理" scheme="http://yoursite.com/categories/%E6%B7%B1%E8%93%9D/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/"/>
    
    
      <category term="编译原理" scheme="http://yoursite.com/tags/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>贰・自顶向下语法分析</title>
    <link href="http://yoursite.com/2019/12/11/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/%E8%B4%B0%E3%83%BB%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B%E8%AF%AD%E6%B3%95%E5%88%86%E6%9E%90/"/>
    <id>http://yoursite.com/2019/12/11/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/%E8%B4%B0%E3%83%BB%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B%E8%AF%AD%E6%B3%95%E5%88%86%E6%9E%90/</id>
    <published>2019-12-11T12:58:14.000Z</published>
    <updated>2019-12-11T12:58:14.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="" /></p><center></center><a id="more"></a>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;&quot; /&gt;&lt;/p&gt;
&lt;center&gt;
&lt;/center&gt;
    
    </summary>
    
    
      <category term="深蓝" scheme="http://yoursite.com/categories/%E6%B7%B1%E8%93%9D/"/>
    
      <category term="编译原理" scheme="http://yoursite.com/categories/%E6%B7%B1%E8%93%9D/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/"/>
    
    
      <category term="编译原理" scheme="http://yoursite.com/tags/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>贰・词法分析</title>
    <link href="http://yoursite.com/2019/12/10/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/%E5%A3%B9%E3%83%BB%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90/"/>
    <id>http://yoursite.com/2019/12/10/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/%E5%A3%B9%E3%83%BB%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90/</id>
    <published>2019-12-10T12:58:14.000Z</published>
    <updated>2019-12-10T12:58:14.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="" /></p><center></center><a id="more"></a>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;&quot; /&gt;&lt;/p&gt;
&lt;center&gt;
&lt;/center&gt;
    
    </summary>
    
    
      <category term="深蓝" scheme="http://yoursite.com/categories/%E6%B7%B1%E8%93%9D/"/>
    
      <category term="编译原理" scheme="http://yoursite.com/categories/%E6%B7%B1%E8%93%9D/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/"/>
    
    
      <category term="编译原理" scheme="http://yoursite.com/tags/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>〇・编译原理总论</title>
    <link href="http://yoursite.com/2019/12/10/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/%E3%80%87%E3%83%BB%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/"/>
    <id>http://yoursite.com/2019/12/10/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/%E3%80%87%E3%83%BB%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/</id>
    <published>2019-12-10T11:46:15.000Z</published>
    <updated>2019-12-10T11:46:15.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="" /></p><center>编译程序的基本组成与相关概念。</center><a id="more"></a><h1 id="编译程序的功能">编译程序的功能</h1><p>把高级语言翻译为等价的低级语言。</p><h1 id="编译程序的组成">编译程序的组成</h1><p>编译程序接受一个字符流的源程序的输入。</p><p>字符流送<strong>词法分析模块</strong>进行词法<strong>分析</strong>。词法分析模块将从左至右扫描字符流，由词法规则识别出最小的语法单位即<strong>单词</strong>，将其转换为编译程序内部的符号表示，得到单词流。</p><p>单词流送送<strong>语法分析模块</strong>进行语法<strong>分析</strong>。语法分析模块由语法规则识别语法结构，生成一种语法的内部表示，如语法树、三元组或四元组等。同时检查语法正确性。</p><p>前面得到的语法结构送<strong>语义分析模块</strong>和<strong>中间代码生成模块</strong>进行语义<strong>分析</strong>与<strong>综合</strong>，进行静态语法检查、变量类型的确定与检查等，并生成中间代码。</p><p>以上模块称为编译程序的前端。</p><p>中间代码送<strong>中间代码优化模块</strong>，得到优化后的中间代码。</p><p>以上模块为中端。</p><p>优化后的中间代码送<strong>目标代码生成模块</strong>和<strong>目标代码优化模块</strong>，生成目标代码。</p><p>以上模块为后端。</p><p>除以上模块外，还有<strong>符号表管理模块</strong>，全程收集每个名字的各种属性；<strong>错误处理模块</strong>，负责报告错误并尝试从错误中恢复。</p><h1 id="遍">“遍”</h1><p>编译程序中有个叫“遍”或者“趟”（passes或phases）的概念，指从头到尾扫描一遍某种代码形式，并将之转换到另一代码空间（包含代码和一些额外信息如符号表等）。</p><p>“遍”的概念使程序结构更清楚，把哪些功能做成一个遍之类。一个编译程序的结构组织取决于其对各“遍”的组织，例如是单遍还是多遍？多个遍是顺序执行（通常如此）还是并发执行？</p><h1 id="编译程序的伙伴程序">编译程序的伙伴程序</h1><h2 id="预处理程序">预处理程序</h2><p>将宏定义（<code>#define</code>）、支持文件（<code>#include</code>）等替换为更复杂的源程序扩展信息。</p><h2 id="汇编程序">汇编程序</h2><p>将编译程序给出的汇编代码转换为可重定位的机器语言程序。</p><h2 id="装入和连接程序">装入和连接程序</h2><p>为可重定位的机器语言程序装载执行时库，生成可执行程序。</p><h1 id="编译程序的相关程序">编译程序的相关程序</h1><p>高级语言分编译型和解释性，后者对应解释程序。编译程序读入源程序，输出目标程序，目标程序读入程序输入，输出结果。而解释程序读入源程序和程序输入，输出结果。它不产生目标程序文件、翻译一句执行一句，执行时解释程序依旧在守护，也就是不区分翻译与执行。常用于虚拟机。</p><h1 id="文法">文法</h1><p>文法<code>G[S]</code>是一个四元组<code>(非终结符集合,终结符集合,重写规则集合,属于非终结符集合的识别符号S)</code>。</p><h1 id="使用文法产生语言">使用文法产生语言</h1><p>一串字汇集（非终结符集合并终结符集合）符号由重写规则进行重写的过程叫推导。</p><p>由识别符能推导出来的符号串叫句型。如果这里的符号都是终结符，就叫句子。</p><p>一个文法描述的语言为其推导出的句子集合。两文法等价当且仅当其能推导出的句子集合相等。</p><p>给定一个文法，则可唯一地确定其语言；给定一语言，可不唯一地确定其文法。</p><h1 id="使用其它方式描述语言">使用其它方式描述语言</h1><p>正则表达式之类的方法。</p><h1 id="文法和语言的分类chomsky语言分类法">文法和语言的分类——Chomsky语言分类法</h1><ul><li>0型语言：没什么要求，基本是个文法生成的都是。等价于图灵机。</li><li>1型语言：在0型语言的基础上，其文法之任一产生式之右部式长度有限。等价于线性有界自动机。</li><li>2型语言：在1型语言的基础上，其文法之任一产生式之左部式仅有一非终结符。这意味着规约一个非终结符时无需考虑它前后是啥玩意，称为上下文无关文法。等价于下推自动机。</li><li>3型语言：在2型语言的基础上，所有产生式均形如<code>A-&gt;aB|a</code>或所有产生式均形如<code>A-&gt;Ba|a</code>，等价于有限状态自动机。</li></ul><h1 id="推导与语法树">推导与语法树</h1><p>最左或最右推导（每次推导均队最左或最右的非终结符应用重写规则）生成的句型叫最左或最右句型。反过来有最左最右规约。最早被研究的是最右推导，所以规范推导指的是这玩意；分析程序时都是从左往右读所以是先规约左边，所以规范规约指的是这玩意。</p><p>不管你咋推导，只要得到了同一个句子，那语法树就应该是一样的，否则说明这个句子有二义性，生成这个句子的文法就叫二义性文法。</p><p>不能仅根据文法本身判断它是否有二义性。</p><h1 id="句型分析与语法树">句型分析与语法树</h1><p>给定一个符号串，判断它是否是某个文法的句型，这个过程叫句型分析。</p><p>一般有两种技术：</p><ul><li>自顶向下：从识别符号出发，尝试推导出相同的符号串。问题在于，同一个左部符号可能有多个产生式，推导的时候该应用哪个？</li><li>自底向上：从输入串出发，尝试规约到识别符号。问题在于，同样的右部串可能可以规约到多个左部符号，规约到哪个？</li></ul><p>对一棵语法树，每一棵子树（与数据结构上不同，这里叶子不算子树）的叶子构成的串叫一个短语，这意味着它们能被规约到这棵子树的根的符号。只有一层的子树的叶子构成的串叫简单短语，这意味着一次规约就能把它规约到根的符号。最左的简单短语叫句柄，规范规约中将首先被规约。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;&quot; /&gt;&lt;/p&gt;
&lt;center&gt;
编译程序的基本组成与相关概念。
&lt;/center&gt;
    
    </summary>
    
    
      <category term="深蓝" scheme="http://yoursite.com/categories/%E6%B7%B1%E8%93%9D/"/>
    
      <category term="编译原理" scheme="http://yoursite.com/categories/%E6%B7%B1%E8%93%9D/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/"/>
    
    
      <category term="编译原理" scheme="http://yoursite.com/tags/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>Manjaro Linux下配置DosBox+MASM汇编环境</title>
    <link href="http://yoursite.com/2019/11/24/%E6%88%8F%E6%B3%95/Manjaro-Linux%E4%B8%8B%E9%85%8D%E7%BD%AEDosBox-MASM%E6%B1%87%E7%BC%96%E7%8E%AF%E5%A2%83/"/>
    <id>http://yoursite.com/2019/11/24/%E6%88%8F%E6%B3%95/Manjaro-Linux%E4%B8%8B%E9%85%8D%E7%BD%AEDosBox-MASM%E6%B1%87%E7%BC%96%E7%8E%AF%E5%A2%83/</id>
    <published>2019-11-24T08:14:56.000Z</published>
    <updated>2019-12-08T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://blog-1256194686.cos.ap-shanghai.myqcloud.com/191124_masm.png" /></p><center>坑待填</center><a id="more"></a><p>sudo pacman -S dosbox</p><p>mount c ~/Workspaces/MASM</p><p>MASM5.0，更高的版本需要Win行命令提示符环境才能运行</p><p>masm hw.asm</p><p>文件名长度不能超过8</p><p>link hw</p><p>hw</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://blog-1256194686.cos.ap-shanghai.myqcloud.com/191124_masm.png&quot; /&gt;&lt;/p&gt;
&lt;center&gt;
坑待填
&lt;/center&gt;
    
    </summary>
    
    
      <category term="戏法" scheme="http://yoursite.com/categories/%E6%88%8F%E6%B3%95/"/>
    
    
      <category term="汇编" scheme="http://yoursite.com/tags/%E6%B1%87%E7%BC%96/"/>
    
      <category term="DosBox" scheme="http://yoursite.com/tags/DosBox/"/>
    
      <category term="MASM" scheme="http://yoursite.com/tags/MASM/"/>
    
  </entry>
  
  <entry>
    <title>Manjaro Linux下使用opencv_traincascade</title>
    <link href="http://yoursite.com/2019/11/18/Manjaro-Linux%E4%B8%8B%E4%BD%BF%E7%94%A8opencv-traincascade/"/>
    <id>http://yoursite.com/2019/11/18/Manjaro-Linux%E4%B8%8B%E4%BD%BF%E7%94%A8opencv-traincascade/</id>
    <published>2019-11-18T08:34:19.000Z</published>
    <updated>2019-11-17T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://blog-1256194686.cos.ap-shanghai.myqcloud.com/191118_opencv_traincascade.jpg" /></p><center>使用opencv_traincascade训练实现车辆检测。</center><a id="more"></a><p>OpenCV中有个神奇的AdaBoost，通过读入一个xml即可识别出目标区域。此物中文名唤“级联分类器”，“级联”指它由简单分类器级联组成，通过所有分类器的区域即为目标区域。训练时通过对样本的一定操作可生成样本的Haar/LBP/HOG等特征，检测时遍历待识别图片各区域进行特征匹配。</p><h1 id="训练">训练</h1><h2 id="文件准备">文件准备</h2><p>训练文件夹的结构应当如下：</p><ul><li><训练文件夹><ul><li><code>data</code>（训练结果文件夹）</li><li><code>vec</code>（样本集文件夹）</li><li><code>bg</code>（背景集文件夹）</li><li><code>vec.bat</code>（样本集相关信息）</li><li><code>vec.vec</code>（样本集相关信息）</li><li><code>bg.txt</code>（背景集相关信息）</li><li><code>opencv_createsamples</code>（生成<code>pos.vec</code>的工具）</li><li><code>opencv_traincascade</code>（训练的工具）</li></ul></li></ul><p>其中这些东西的名字都可以变。</p><p>首先建立训练文件夹和三个子文件夹，并分别放入样本集图片和背景集图片。样本的大小大约应当几十见方，太大会爆栈；背景应当远大于训练图片，几百见方，且内容较复杂。这是因为程序将训练图片作为滑动窗口在背景上滑动来采集训练图像，如果无法采集到足够多的样本就会报<code>Train dataset for temp stage can not be filled. Branch training terminated.</code>错误。</p><p>关于样本集与背景集的比例，有帖子认为一比三是比较合适的，我理解是生活中没有样本的情况（背景）多于有样本，但如果给太多背景影响训练效率。</p><p>放好后在训练文件夹下进入终端，<code>ls ./bg/&gt;bg.txt</code>生成背景集相关信息，<code>ls ./vec/&gt;vec.bat</code>生成样本集相关信息。自动生成的文件最后有个空行需要删掉。有帖子指出这里的文件对换行格式也有要求，实测VSCode中的“LF”格式没问题。</p><p>此时生成的两个文件内应当是形如：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">xxx.xxx</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">xxx.xxx</span></pre></td></tr></table></figure><p>将之改为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">vec&#x2F;xxx.xxx</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">vec&#x2F;xxx.xxx</span></pre></td></tr></table></figure><p>和</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">bg&#x2F;xxx.xxx</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">bg&#x2F;xxx.xxx</span></pre></td></tr></table></figure><p>这是因为待会调用训练程序时无法指定图片地址，所以地址要在这两个文件中显式指出。</p><p>除此之外，还要指出样本图片（背景不需要）的该样本数目、起始坐标和表示样本宽高</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">vec&#x2F;xxx.xxx 1 0 0 xx xx</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">vec&#x2F;xxx.xxx 1 0 0 xx xx</span></pre></td></tr></table></figure><p>那两个工具在电脑里查找一下，通过anaconda装的就是在anaconda文件夹里某个角落，复制过去即可。</p><h2 id="创建样本">创建样本</h2><p><code>./opencv_createsamples -vec vec.vec -info vec.bat -bg bg.txt -w xx -h xx</code></p><p>注意图片尺寸要对，否则报<code>Error: Assertion failed (_img.rows * _img.cols == vecSize)</code>。</p><p>这里的工具是直接拉过来用的，配套环境可能跟不上。如果报错他想找个啥库找不到之类，以<code>libopencv_core.so.3.2</code>为例：</p><blockquote><p>Find the folder containing the shared library <code>libopencv_core.so.3.2</code>using the following command line. <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">&gt;sudo find &#x2F; -name&quot;libopencv_core.so.3.2*&quot;</span></pre></td></tr></table></figure> Then I got the result: <code>/usr/local/&gt;lib/libopencv_core.so.3.2</code>.</p><p>Create a file called <code>/etc/ld.so.conf.d/opencv.conf</code> and write to it the path to the folder where the binary is stored.For example, I wrote <code>/usr/local/lib/</code> to my opencv.conf file.</p><p>Run the command line as follows. <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">sudo ldconfig -v</span></pre></td></tr></table></figure> Try to run the test binary again.</p></blockquote><p>生成<code>vec.vec</code>就是好了。</p><p>可能需要给工具一个执行权限。</p><h2 id="训练-1">训练</h2><p><code>./opencv_traincascade -data data -vec vec.vec -bg bg.txt -numPos xxx -numNeg xxx -numStages 20 -w xx -h xx -minHitRate 0.9999 -maxFalseAlarmRate 0.5 -mode ALL</code>，其中<code>numPos</code>和<code>numNeg</code>是每次训练使用的样本数量，而非你提供了多少样本。这个数量应当足够多（样本数应当大于10，否则报<code>Cascade classifier can’t be trained. Check the used training parameters.</code>），和提供的数量一样保持一比三，并且少于提供的样本数（否则报<code>Traincascade Error:Bad argument(Can not get new positive sample.The most possible reason is insufficient count of samples in given vec-file.</code>）；<code>numStage</code>是训练的级数，默认为20；<code>minHitRate</code>指“分类器的每一级希望得到最小检测率”，一般0.9999；<code>maxFalseAlarmRate</code>，最大虚警率，“影响弱分类器的阈值，表示每个弱分类器将负样本误分为正样本的比例”，一般默认值为0.5。还有其它贼多参数，用到再去查吧。</p><p>官方给的<code>numPos</code>和<code>numNeg</code>计算方法是<code>vec-file number &gt;= (numPos + (numStages-1) * (1 – minHitRate) * numPos) + S</code>。<code>vec-file number</code>是指提供的样本数。</p><p>训练过程中经常报<code>Train dataset for temp stage can not be filled. Branch training terminated.</code>，排除背景信息那个文本文档格式问题的话就是需要更多更大更复杂的背景的意思。</p><h1 id="检测">检测</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">xx = cv2.CascadeClassifier(&lt;xml路径&gt;)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">xxx = xx.detectMultiScale(&lt;图片&gt;, scaleFactor=<span class="number">1.1</span>, minNeighbors=<span class="number">55</span>, minSize=(<span class="number">10</span>, <span class="number">10</span>),maxSize=(<span class="number">90</span>,<span class="number">90</span>),flags=cv2.CASCADE_SCALE_IMAGE)</span></pre></td></tr></table></figure><p><code>scaleFactor</code>指每次检测区域扩大多少，1.1就是每次扩大百分之十；<code>minNeighbors</code>大概意思是一个目标区域附近允许有多少目标区域——因为往往对同一个目标，程序会识别出许多临近的目标区域，看情况调调这个参数留一个就行。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://blog-1256194686.cos.ap-shanghai.myqcloud.com/191118_opencv_traincascade.jpg&quot; /&gt;&lt;/p&gt;
&lt;center&gt;
使用opencv_traincascade训练实现车辆检测。
&lt;/center&gt;
    
    </summary>
    
    
      <category term="中医" scheme="http://yoursite.com/categories/%E4%B8%AD%E5%8C%BB/"/>
    
      <category term="分类器" scheme="http://yoursite.com/categories/%E4%B8%AD%E5%8C%BB/%E5%88%86%E7%B1%BB%E5%99%A8/"/>
    
    
      <category term="OpenCV" scheme="http://yoursite.com/tags/OpenCV/"/>
    
      <category term="AdaBoost" scheme="http://yoursite.com/tags/AdaBoost/"/>
    
      <category term="cascade" scheme="http://yoursite.com/tags/cascade/"/>
    
  </entry>
  
  <entry>
    <title>摆脱祸乱之源——探索如何保持精力充沛</title>
    <link href="http://yoursite.com/2019/11/11/%E5%85%B6%E5%AE%83/%E6%9C%89%E5%85%B3%E6%91%86%E8%84%B1%E7%A5%B8%E4%B9%B1%E4%B9%8B%E6%BA%90%E7%9A%84%E5%B0%9D%E8%AF%95/"/>
    <id>http://yoursite.com/2019/11/11/%E5%85%B6%E5%AE%83/%E6%9C%89%E5%85%B3%E6%91%86%E8%84%B1%E7%A5%B8%E4%B9%B1%E4%B9%8B%E6%BA%90%E7%9A%84%E5%B0%9D%E8%AF%95/</id>
    <published>2019-11-11T09:02:23.000Z</published>
    <updated>2019-12-21T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="36c2a5f9580b75b02aa356c90860fc9ce89b036437c813b871c5ccff24af97b4">c0108d7edfa7877d16ab61e5627418c0e11bd64f9fb1b07e026efa48e580a7bf10c9667ceff989cdc553905b47978b3a1fb7021888ff92c063adf6046a69638abd849d1cb0885a90779a054e5b16f8cbbfc4ef25c7f96791f65cd67d04af87601eb81dca33980d29edda4b93c083e9def5a8c48c766a07c813a3a729fa6ec8725257502088ea84b2950f8c0a215851afe30fb15b89dc6dcc2e3a9ecf90274b575ebbcd065990b8460f4a13678cb9e9e814b9bf8d89ea90ac30599ed720d59fb7c10dca4d275bfd92d36a6331ea819aadc7294ad3dd23eed014f992a7150c9bc492459235ac18ccf937df7ccc5b372c2967b93a4f30a68a2a6cfca5f57c6a69d089e30be18c7316236390cde5236829910af4f205987a9e91cf7ac150e740d187da3732e643cc1aa8d2254361978008dd5694135f2b407df3940fb327eb847124c403d36291c64373a984721ce67ba147d6eaa857467de7332996747a9c35de5faf86cb727d216977cf997762f1b814ee909a75ff4be81b61ed1127d1d5ed55f957e6cdc5753af4da72b0515b2b4860cd1107b30ac7a4ec2fc29ab44ee22d0ffb0b1df57b912042833a6516803032030ea3f4c3d3536af724f18f0d121585315da9efadf950a7e8a627af7758554b8a1bafe90496d2521cd7f4fa93ff0e1adfdd9f9ac78f3748562db30f59b6270f598a485542a79d38fe9166a50856d20c8cf5d8964553bffb59d1b7f506d6c951a739e06c2f7a44dd7632ce62fd3e0ea7337669b8621d15f3ebdb8a732401df5a25e18aee99ac6f4b0c7402261c1f729638424b628dbc5c67846969e5b8189febc3fb350120aaa09cc896c5aeb687f0aa819edf87aa9418c0f682c92f7a6ec88ed3516d4e34229aa7e5027dc96dcd489f521df0a16368903c3e4465a92ad1d1cdf30a759f64a0f4bd860b9e3758ce0192acce2b9b7a0d2090802e491b52cc7280c9213137d2a7a0702a595a6212667b0032627fa686ba01263d529d7e2d15a7ceabfe78c3e642879e6f85fb85cc17f21ded32db933dccd90b460771240d2bc5f9256cc81a34568605e77025c83f9ab8b00bc32a8f7d74cd79a62b858d22a8b625124c05272dce1be87a43eebad1a6376a3d577a4264af53e38fe2c0efcd062b3c9b42927d56c0923dcf0e332fa1fb7f0ccf52f0408ea7f420c8a0f7dbf2c93091251c1ae054a8264451687b251f1a06e095870889c68b7a02a23efc90c9b40bbee4812148327b35596e96aee01b7f2fcc0053c62fd1278c3c158db168dedf6ffe69007dfe5517a1fa5616aaf18604fae232544e1b991014a19a2028598c9ccd17b3e69410869535cba20bcb049ca8c8351d349349d9da90f84f68526583f48a3f804837040df06765a3bdbb88cbb2bc3481959bc77aa252a3d81cb5b34d8a65fcbc8d812a9509b0b38b6ca255bde3f388bd6258ffe9c4f82b4239941e5988b95923bba5ea5f3f884dfcb1ca435abd17d8906d4bf7d4371d2c2c0f3a747411935c572bd25ea748ec7c139f3914b1b937ce870495fa26f762a48075f739c68cd050734ccab80620c737a9f02e8443764675c63e8a53838905f9dcdbaf30b4cbcb443d8f7d1090873db05d6e7b07d2b763a82e8f5f698012d32faaf2512c9154c5391e2280fbc907d3d3c04cd5df8d9cd0df1a4ca23c59d6c3fefd3cc002a283f0fd76040757ee43e1e7415dd75ab9892e22dc3901fd25fb6bc3830237ac36b678c53d976a88772faf01a480162a6446e19c1f85242d75e7d2528f8b933c73142db0e7e303e7b009c5fd90fa72e26ae87f71dcb09208d5cf079f19e4a43b9571259afc535173fab3eb935ea924943ffcc61182982751c0a51f6833f3c33bd8f93d5f3491ed5fa909c10ded1d9350aca35c82fa8a8e5bae620f0ba36abff5f4a12087964e6b54e4a4c1c3b4387f8f552ca1255a190723adc63e7574e43c8ff75db923d1f040c3cabfe458c97d1221b9748b17d9fdf8b029eb342354fea61487354f217ba021f3fd5c628472c5c629893bb3e6f4a34d37409a7fcae096b58111a6d076fca4a3cbe22243c4edc16fa5187ad965358fc7d9a873c13e684bad582a2db972bfd25b506891d9c42b1612a275f33f07071f2322576431de3a9664ceef4d1ff64e968129ff56a267cef58870e47925db00296b368b40d575017e15b80ef11d1ac98c12607827c2a3ac78af5ec4356e8ba81405a1b2716318be1230571bc7de3da5fe0688f4360830a737cc0f9473599997b7795ec73ccd901413b5e57a78535dac203668d24e12890ce36296193e9b0e2e97e6fdedf761e834c9492f96a418a021de663b93320439705b523d23d7fc12d4a386d65604bd59f709df10f8afc2a4896f277e7430dd7c232846f755eaf208c36fb72caf2cec1c7813003ee4602cee6190ad9589a0ee5e90b6f7162fd366c3bc56535144f2f79c09d9a1ace50994c982036af11345c641aa1e7c210cd0a13e2eb9690582e0349fd569f94bdb21665b12641dfa30618d3fbe71f8aae6fd93c3a917cbb8ea907051accd20550eacf9e1f354249c88c2337bc13383b19212366058c015d87aea91876c3eba56c3b133ec647df56f612d2831c58a49de94b50addca398eadb228339706e020e245af39a498f4fb961c8b9e8875ad6296e847d974f8765f452d417654bcfe7220e3e614576fb5a9987bfd1384ba5a24835e2b2fc1266c6679a7952f3bfdc2ff1a3544aa6fab83f3d8427e782d6c82eca22ccb740c27db1781003b10d3ed0227e148a183255771adea6c06466d25e719250a39aced6b170f60da6becaa41a1cf91095a9f76f8ce2b273b6bea0684da0bf472bc94243045cdff5a01fd10120fe180c5cd676887eb7de7fb1ace7bf97072dcb7f1b71e468b6632b7cf348634973585b25f0155bc4450eab57ce70bc4766434e9d29999b09eef6c9cfb7f4aca5572a5d19526bf7d5804c8d8dd7edb50e0a887a5d086d1b44c8c0aa257579a7f89c74ea99afc1a7c5e2693b90f964116ab082bdfe15c72f0279d1869f550a960b07c0f13a255c9e73fab85420b0a4bbb87a752f21428f80a169dcf233f38ec6e93f1ba1df4fa899c4b28aa42774b39a5325e2f604c1f8a244bbc11433742c6037669200ce064ffa37f612cfa708d888624a1969fe12f62528aedd70f0594f175478f17bcd62e7cac05b84163739d9d1279bc61d61e520ca06936932d615b4452dd8c7924aeb254530c44a161701ccb050716d8cf826c831e134f5061310cd679a86cbc2fbd063595c1ee90834c9db90c9c5cfc4a0c12ea3b9084484ff84a5504e1df9292156cfd5f0b53587337098ad3f5e40e142e67700557eea65b7da1d70c5955ae5abc1186229bdae9dd3fdf7f046ab27155e1e57bf7203e7d1650c91860bd06bcc4e00b677fd74e35c504a688004ab1a5392e9f3572a45224830b9d5b605dcbb2056dc873f408d97cadd86da17a5ab27df8e0a98b5f1d5cd5bd6efb36fdfa138a95208134dc928a95b2cf27364e1a8040137e3df265622fa9768fe73c7ba008688d566ed80ed382fcf5a07077052afd89c9510cc194ff66dc692a9afd12c7be0486af6a1433579be30cf1ef48b3beb8b78d5fd6628d820d7122056f4cdd4d31c0ed454eec9c927ed61acfaeffd3a1c5c4f0e3d1a234929c2a091a160d48c3b78f260865a5780df855e262377a79c9c49091ab0f68ee7a231bdd2a164951a70697ed84126b9126ef69faf4cc9ed1e63b51ee1d4c1fecf08667d86e9c368a629bdc4cd70139f134753a66a9f753c078dd7fdf0e87d59072a09993d3ef5a1b2ad5b97bf0c083970caad5ef8d6e9a63f94853388c3b26669e112ee909edc00a3c9d80d759cc6f9fa8a67abebfa364a173842c3ebc01e2da20415e4880216ea2f1fe5d43b1fb42c41766179163ad4f66da31970245d67fdfad65d8b417c2c87371b4bd5cd7d2b58c2114d59cdd4e5d075f6c38f947919c7e2af4cdd93a543882af215932d01946ad4eba515ff581f6fbb65cb0c67e202b56a4c05ef10e6a823ceb9b529e01c49f3ed17566d6313aed51b707a8b6178a2d30c7e09b35958f726f9f18a03cbdd6f1fb112b432e4f54b5c7a13ebdd14401cd0407aafca9bc666996dc64a98e52c20599e5e3eecdbb4cf7dac03f595de17af49efd0c0e45cc92cd0e956ccedee0fd0c8b4203efc3f2a393a4263262c667b451d5db8de33d8de3e98d4f46ae7f82fa6577767cc3f289bb957fd64291db2f590b59fcd5f51076c4efab64b009734551d2bb44a4f03e639207ce4f5209919a932eba9ee0cd712fcb85f904cc92f6e03ce068e7974f9d166808770296e006d54a13a653e93420dda42821aad704ef047e8ac228e36b15ffa04fe75093516b5b1b78bc1258bb699bba4f9d243b5efa3fbe703cb4a7c0e492a19fbc1c14da146045f3e36140953bf5954f8627317c172d0e2ccc2ec69170fd2e7b664e54cee4c895e24895dd450187b8c3b318c1ddd46f0f0202ee1a1f78b553f2e727780d436e35a500a7da920949eebc733c24bbf66f0fb006ed13a4dbfbf5de711acd5613386d0df40b4bae5f015472e09301d9baeb3e4fe315c936238b84fe2ee70cc5ce02dc00060ddfd2d622c140e2962f69344e803f9809c0b4480d6623069294bec7fb87af6a58851a20c6ebf83dc0e7180bb0dadf8ac92e9a9e26fea736721aa0bab47e00dd46aa8c66b93249e414f4a789e57639756508d5d7884374edb4a0ad5fa686c8c76c30a6a54904f64c0aefe756748c1024e8e171a9fc189376c7493e5a38f92f6f24217eb782a2d26a41b21333cbd9d62862d455b8da14b5a35c6ae9601820b29bbebe8edeb6e65eec97135ed1c9d20c2a332c2934c764c1eaf71407ef219088a937c49f154d30fa997e3c7e2fa2c66ac2933e2d73af1ddacc1f40eb47e9c6801ad85608ab7d4aa917d203ac5ae58c5be6d0d2161f0ed3b013fbd071274dfadb141686a58a57df24c02d9367a73fca1f75196659a360b3d2c331f879096d604e977e3263d00502c6af559adf61c7fb09717829ac7287e17fd5808b1ebf80d51ed7eaac351a778261b467cc39dae490f70aad672a18cdf7772b1291cfb65e0d2a29969f4581018f63e071a4c8d778d59543e713342d52ac6f255eeabda055d91728d920c500e8e32a2f88eb40c39b46e3ab93d02941dcaf46e14548ed83f456adf7e337a2deb8967e0aec18a3aa118b39287456736e830a4913048f131f72d823b0a0569f3d3208cc8931f2629f05b41fd1dcc5a9906a3642e81928bd1b1d8d662fa93c4c1317f6ff9924d760d73840f4b55724c1635e13dfab5163288ed2482ac43e86aa96b52328bb9d9339e59c461119be3e8ec9b9f902b3928ea9468da2f9c13257b474d72698a10b2c1f8176f6456183792accbd3cb8c272fb7ddc24f8e6335413e1964827c0afa0e341d076cd61bdfab9c85fd57f88fe3bb85f3e41367ae4e960ba312c0a018f2de0afdcdb761265a5ebdbaef43f16bb7684b7619380f94dc5bcfc0bde3f0b33b11cec187c000178d051e178d8b53638af878227159a7932655d97dafa86c31dda4fe9d646de8d6aee966a50ac01bef5cb46aedda3a0f8d3d032aa3c50be2ecbad5b70c2831516cd1c12c075aa7b4964501ba9e19ecc39c5d1e125bbee858b0ac02e19b4dfea92443cc13fd11f1aa1f4ad9e2e0c03e7f318f92a5ff7fd245793e5127eca7279c99e582f49ae44ef80b253355366ef8cccc1967ef4ad97cc503b71460329ec8d015c03ed4fd5b026463f75ab609aa1510ad459e088f126fc1276a947a97bf97bf5f073ed1ef9e58f28bb65785b884610f20d1ef7e18828bc7399ed164736d219c96fa76aa0ce402eaed25ff874bcd42fea1d758d8925ae5a29c496dbf0e24a23ad12da335f5a03959ee6e5cfa4fa4b32f33bea78940b89989875d18fa2141312409339a6c527f582ebfc5878fa743a3b201c8acd5f3a0536c1184ab047bb7133aa3aa11cb8e0e5ec505edaed897aaa5fb8e5e2b7e00e64272ec97242df09d6e901838686c629782884f97854fc12f739e7185c0283db5724338ca346fd39de4834d4795e27c2144d18c56ed9d4a5242fcb5094d07335f0a8d6124da9e8a77d6c770e05bcf0781199b5cba64042b8bdaaefa4f6acdae0796d6da9b08d518da384820486c975b1e3210cb66c840ac0183bd087d6a0706524d7933fc20b1db24402a2c371479c3c1d8c6328b1916f8da71b92f08ef0e251e528f005c7bb2a18ea02b7739b689c0986910670d76ca2d58de7652f633d7ea40f805160bd6f17261d8d5c7b54ade8e8e05e9b6898e0fe83c256f0947280d31150d36150090b8ce67ac60ca181723f0e52b1c8b93621ec090bb792515e7097957d2da20d0f0f72789086826cda36e2cbb7c2e5299871f67d3b022e7957c0099d6db1dfbd5806bf9c8a9e614c866c897969d625a91a7e5f41e8b00b7eef6683f212af33f9e8a7d548aa31bc80a979af900dcdffddc0ddddcc21474b535db201cc7b20ee55c4a0d715b5e5e65b6f33248f25968c91dd6d786d7327abe3aac6d4d3b345089f9de742e7b990572f42429dcad037cf59518f5c4e17181a36ebcc78a1978377bd2d2e6902f6c3212bfb774a594fad3eccd6290504091ffbf4ab87ae6ccf6d647db68563cb997f46eaf3fc325b10c918cef82072c2732acdf0b66496fb52212c6d0e861a05955a3bfa675d09cb9ffc2121681ac24fa6e770f55a6f96e59ab9ae25c5e1f13a2b446e2d97af4becf4dfaa20de5d08dfc4247034f91166883845a66998253d9f3f9ce6db820c5d98da6555f132e929582cf62b495b61ca84685d3687fba3c2b88ae5ae458a1be3592239a0a64fb2b276b7ffc7c51b0357761405e5c028d3230ec0d9bcef14a407271c04100a434b5e02c7cb2e6082bb7aa5e7426d05e84f0e0d6f442ddb918e0c23cfe192547ccf37185ff50a32c16df37c404ad448bf1c46b2aaf98c483fe074b1eb9b89d61c028b7f3cfb83eefbc20aa4e0cf8dca2476dc8d893c0795d9860147cd69f7b6bb1a5e14c468d52765e3a44dbd71a1d7ab608b8ec42d6afe2107183ca934494b89134d021c5f64163f93fe03de933d0ffc0ae17c2bff27d3551106a59992c63be585becef4db72b8215d0f5a4f1d577cc7cdb1b20f286b3a10d182ebddaa7cd4b39a54c41a75dcf1b3b1304fc3000f3530d528efa4e0fbba91db2240bd7ac2cb55bf3ddb30b990543718ad2294a17c7f4d2ba1eb1cd5030a879e2ca5aa37205eb2327357a05c40d43cfd93605f1ef16d8d2aa226b97c8102b62e56a908c5eb20d1871fc459be1a994df9995ea569abf879b909e70c8a484c3afbae937b6ad4e9a1419478a1c23b657fcab943bd5992424459082cf64148a5af764c514f8ac35bb247314bba0c4a203ab68074d5260f627bd1fe2accea950609365ee828449d60e04c0caa3c54302359643a9e13414f282d3e53b0336ebf4ecd629935cfe4fdbcab1a97dac04ad7bf428fcc27bfa6e6db507ac5761c0d1ea4a6258377da8b9ba0d06e4bef218411eede6902b0d9bedb0af4d053da284fe7a0dd949a21a5a55317cd76659968e785f2b95b1191b982f36d0a7f3b8564acf7ee2a44761502e40e4c1da24e6f7bfa2f0faecfb89a2babb3abec09b94d3c05c122ae560daeb0699d8c561fcedb84cdc7f24823502f8f66100455c7455463a89cc867a95cedb5ef22bead388baa82820fda82080560145edce3e0a3236a4f1cf08a84d95ed4ed48f970d167ccbedecbb4f913ffd045b23b5fd1acded59ba555e648e3ecbf7377eab5429c8866fa428d92da3630c9d5e3f9a324c40efae8c5744cb02379be14e930f4f694160fdc72f63a9033f6add657a6e99c6e0b86445eea5fdc2bea99c3e469f3527dd5fb6a9953b58e619cd94c76cfc1c5f1b95afe616d58fd8722eef07682ada77a200bf59265c196cd1716946c02b5d177dedfd93b0ad56cf8685864f02d67a01d36d942fbf98fec96eed1951f162760448e60069e00a2e37aff304d7832a0399055fa5d23b54f79e55f9107a08263a8fdf804ba1caa20f976961d52df03de5734c2c1b6134f146fd0f9ab4a6a78f18d5539fb058ee89dfebf81fffd67afacc08e8811eca33da7d4599b69e7c670877d92ab866fadb733f78f535d59c444eaafd2b3009d9e7a6163803c4feb614a4a06dd275385cd68683deabc68e3d0a43a8dd8da33c84e672994a4e3b5dcde54800421f2484e49129449643bf710a87dbef5dc3a7063c598b8c8ccdc42ffda8fe631b1715f37ab4c1e9af76dff4b5aa1ebe1d207a3d81d6da3333bf1d965556ccb45f6bb8bb97882b203720bc03d058c3ab03baaa1f6cc6b9ba1b41f7ac2f8d863478ede797d10bf88ff61b04f8a9f685cdf1789e39138b3ba9cae93753b956e6cd49fb26b3208b1f09aad9ac4011b674fb116daf6916ae3e13318bf9ac139fb52b0f45f2a25dcfb1828ee0ff0bc248132721de42cbb66bc8b5aadc7148152e85cdb276117787aade664256b2f77c0669845e27419707f11b5c97e535ec6066f09e6647210cf20a13ff3ec1680fa4b11b7cb98dc401ad7c0c63d4828792f58177b0d8f73afdfba4f19cdebadd44abb3e11185a70c16940149c3169ba4f7e220f6f14b373d6b5691263c9c070f8817d3d47c0750c3a673f2942878f26312727d6ecd43291bb4a5cb0af46d9afa609cedd2db37c862069b0c60b3738c8716232d41871bb75fcc41d8e42fd13b130c2c6cf726b63585e60f7378fe7797890e117b961a0fbe565770588fe0c6344ea252cb0df0a5911724839340707163ad3ab9a65bf36fe2ff1a8daebce412fe9da9a069637d88df58278114ad50c2b3f7d6e8dfbb0df15676cffffee7e4b497cf7df2e1402a2b0ae120a6432f9cc3e16652f514cccf2c2efa52b3201dbcaafb265d4b7aa3410bf8288f7554bedf579d20f66f945237b75074060c3ced6e0c6ac808aeddc04be70a63b7be832b4aa59e799287fb8c0c7601a2b74973101c234549bac8d323f4e7156d48489318aeb5fbcc6de8bf2a2084ad51a41f7859c128488c0b4cebf3058043cdcf9de1ebff900b0fc26d364bdaceb9dbd80d95f83d8fb330e7aa6bee2f5f880d203f81faa701df57730693706eebbfe5535c37bb845cd4ac08acbfaef02b1671783218d82adb61418a54d59c1389b6f60dbf5232abf94e500aa4041a0ff37eb8108c0c2386777c35db4583d2f5ce624e15863961809a98d9703f2dba7198b0924b5ec656fea9253a66ae7211b4afa1555453dd5ef5746f767f0095f18c2730bd3fb1a6413ee62481568922ac803b369beb18cabb04b5c8f62f3e19eccf90e2b8372ebe1ff355134e07523fb3e42ea559ee33123769e15d5adaa00811b4ffa962d0abf85deee7da49926517ce66a41a6e220e0aa64eb07275b255c4f885afe8efaf3dbef833a11fb430d009ea81c6f0b72dad82c9825441350db3c8205b519bac14cbe254e13266beab68c48ba9648b90b25169fb2dc2d27e7754ceba4087ed2bcf485c62c619503b6b264e0131668694f045a517ff7d1de44a1ee3bfc31071036a4cf246cefcbee331ddc9fa1d519caeeb805e981d9c43c51068a1294862dc475742197e6768cb87efdb465155a38c0cfc4a8c942a0fa23672566be82be80d194249ff032ba8b8e9626568c03f36ee7c8ce2b6a8f483cee5cc72ee84747c87cee00835004cf5a0af11d0589951e17999cc407192115d2e99c975978b535c32c028757a42e13382a143b95c9f4b807fa8b8693baaff2588573172c61d1fc8e4e277e7e2ba25bc5526aaf7f0052e6b5a47e2183b9da522bdf057ce0446423fa9d45394853cd62752a2dc71a34ff27b8598cddef67e38160d16d2cf01d1d5a8bddf5fc647a4047c0c1ea6f54c117fa3e3831e43f456f51f22b1e195eba4f92c604ad2f2ceafc929f36612dd93648efef74f4366b972c75be72995582a904b92bc8b83e2656350e1cd02b1a954be4d6ecc961f31871e502043a2b2857ec1c17d7ead41c140fa9ffac7260a841f78f04d4bd1247dcc0827af84cff3377cda4d8dd2ce5dd5ed85774e82a868c80362eab4c05346d2ea4934726</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
    
      <category term="其它" scheme="http://yoursite.com/categories/%E5%85%B6%E5%AE%83/"/>
    
      <category term="柴米" scheme="http://yoursite.com/categories/%E5%85%B6%E5%AE%83/%E6%9F%B4%E7%B1%B3/"/>
    
    
  </entry>
  
  <entry>
    <title>虚拟存储器</title>
    <link href="http://yoursite.com/2019/11/11/%E8%99%9A%E6%8B%9F%E5%AD%98%E5%82%A8%E5%99%A8/"/>
    <id>http://yoursite.com/2019/11/11/%E8%99%9A%E6%8B%9F%E5%AD%98%E5%82%A8%E5%99%A8/</id>
    <published>2019-11-11T07:35:40.000Z</published>
    <updated>2019-11-10T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="" /></p><center>坑待填</center><a id="more"></a><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"> +-----------------------+          +-----------------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"> |1 2 3 4 1 2 5 1 2 3 4 5|          |1 2 3 4 1 2 5 1 2 3 4 5|</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">++----------------------++         ++----------------------++</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">|1|1|1|4|4|4|5| | |5|5| |          |1|1|1|1| | |5|5|5|5|4|4|</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">| |2|2|2|1|1|1| | |3|3| |          | |2|2|2| | |2|1|1|1|1|5|</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">| | |3|3|3|2|2| | |2|4| |          | | |3|3| | |3|3|2|2|2|2|</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">+-----------------------+          | | | |4| | |4|4|4|3|3|3|</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">       1 2 3 4     5 6             +-----------------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">                                                1 2 3 4 5 6</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"> +-----------------------+          +-----------------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"> |1 2 3 4 1 2 5 1 2 3 4 5|          |1 2 3 4 1 2 5 1 2 3 4 5|</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">++----------------------++         ++----------------------++</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">|1|1|1|4|4|4|5| | |3|3|3|          |1|1|1|1| | |1| | |1|1|5|</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">| |2|2|2|1|1|1| | |1|4|4|          | |2|2|2| | |2| | |2|2|2|</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">| | |3|3|3|2|2| | |2|2|5|          | | |3|3| | |5| | |5|4|4|</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">+-----------------------+          | | | |4| | |4| | |3|3|3|</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">       1 2 3 4     5 6 7           +-----------------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">                                                1     2 3 4</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">  +-----------------------------------------------------------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">  |5  0  1  2  0  3  0  4  2  3  0  3  2  1  2  0  1  5  0  1       |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">+-+---------------------------------------------------------+-------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">|51|51|51|21|  |20|01|00|21|  |20|31|21|20|  |01|  |00|  |  |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">|  |01|01|00|  |31|31|30|30|  |01|01|00|11|  |11|  |10|  |  |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line">|  |  |11|10|  |10|10|41|41|  |41|41|40|40|  |40|  |51|  |  |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line">+-----------------------------------------------------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line">          1     2  3  4  5     6  7  8  9     10    11</span></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;&quot; /&gt;&lt;/p&gt;
&lt;center&gt;
坑待填
&lt;/center&gt;
    
    </summary>
    
    
      <category term="深蓝" scheme="http://yoursite.com/categories/%E6%B7%B1%E8%93%9D/"/>
    
      <category term="操作系统" scheme="http://yoursite.com/categories/%E6%B7%B1%E8%93%9D/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    
    
      <category term="操作系统" scheme="http://yoursite.com/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    
  </entry>
  
  <entry>
    <title>Struts2中Action的几种传值方式</title>
    <link href="http://yoursite.com/2019/11/07/%E8%A1%A8%E4%B8%96%E7%95%8C/Struts2/Struts2%E4%B8%ADAction%E7%9A%84%E5%87%A0%E7%A7%8D%E4%BC%A0%E5%80%BC%E6%96%B9%E5%BC%8F/"/>
    <id>http://yoursite.com/2019/11/07/%E8%A1%A8%E4%B8%96%E7%95%8C/Struts2/Struts2%E4%B8%ADAction%E7%9A%84%E5%87%A0%E7%A7%8D%E4%BC%A0%E5%80%BC%E6%96%B9%E5%BC%8F/</id>
    <published>2019-11-07T12:09:33.000Z</published>
    <updated>2019-11-07T12:09:33.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://blog-1256194686.cos.ap-shanghai.myqcloud.com/191107_struts2trans.jpg" /></p><center>struts2中，传统的servlet中的request和response传递参数法仍可使用（但略有不同），并且增加了船新的传值方式。</center><a id="more"></a><h1 id="环境">0. 环境</h1><ul><li>Tomcat 9.0</li><li>MyEclipse 2017 ci10</li><li>Struts 2.5.20</li><li>Manjaro Linux 18.1.0</li><li>JDK 1.8u221</li></ul><h1 id="requestresponse">1. request/response</h1><blockquote><p>为避免与Servlet API耦合在一起，方便Action类做单元测试，Struts2对HttpServletRequest、HttpSession、ServletContext进行了封装，构造了三个Map对象来替代这三种对象。注意，这三个对象与Servlet API中的三个对象是相同的，即，在Action中放入Session中信息，在JSP页面中是可以读出来的。</p></blockquote><p>在Action类中引入上下文类ActionContext，使用<code>getContext()</code>实例化一个对象，就可以通过这个对象获取session和application的map对象，而ActionContext对象本身包含了request的map对象。</p><p>向它们中添加属性只需使用<code>put()</code>方法，若向request添加属性，只需向ActionContext对象中添加。</p><h1 id="getset">2. get/set</h1><p>之前带有传值的示例就是用的这种方式。在action类中定义与jsp页面中上传参数的东西同名的私有成员变量并生成get/set方法即可直接使用，贼方便。</p><p>这种方法的进阶版是传JavaBean——而不是一个个传数据。也非常简单，唯一需要注意的是jsp页面中上传参数的东西的name必须是<code>&lt;JavaBean的名字&gt;.名字</code>。</p><h1 id="示例">3. 示例</h1><p>一个学生登录的界面。用户在<code>index.jsp</code>填写表单，提交后跳转至欢迎界面，在欢迎界面显示输入的信息。</p><h2 id="index.jsp">3.1. index.jsp</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>使用JavaBean传递参数：<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"transJB"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"stud.id"</span>&gt;</span>学号<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"stud.id"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"stud.name"</span>&gt;</span>姓名<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"stud.name"</span>/&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"stud.school"</span>&gt;</span>学院<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"stud.school"</span>/&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"stud.pw"</span>&gt;</span>口令<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"stud.pw"</span>/&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"stud.mail"</span>&gt;</span>邮箱<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"stud.mail"</span>/&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"登录"</span>/&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>使用HttpServletRequest传递参数：<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"transSERVLET"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"id"</span>&gt;</span>学号<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"id"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"name"</span>&gt;</span>姓名<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"name"</span>/&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"school"</span>&gt;</span>学院<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"school"</span>/&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"pw"</span>&gt;</span>口令<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"pw"</span>/&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">35</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"mail"</span>&gt;</span>邮箱<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">36</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"mail"</span>/&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">37</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">38</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"登录"</span>/&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">39</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">40</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></pre></td></tr></table></figure><h2 id="struts.xml">3.2. struts.xml</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"TransTestPkg"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"transJB"</span> <span class="attr">class</span>=<span class="string">"transTest.JBtrans"</span> <span class="attr">method</span>=<span class="string">"execute"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>/succJB.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">        <span class="tag">&lt;/<span class="name">action</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"transSERVLET"</span> <span class="attr">class</span>=<span class="string">"transTest.SERVLETtrans"</span> <span class="attr">method</span>=<span class="string">"execute"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>/succSERVLET.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">        <span class="tag">&lt;/<span class="name">action</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span></pre></td></tr></table></figure><h2 id="transtest">3.3. transTest</h2><h3 id="servlettrans.java">3.3.1. SERVLETtrans.java</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> transTest;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Map;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionContext;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.struts2.ServletActionContext; </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SERVLETtrans</span></span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span></span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">        ActionContext ctx=ActionContext.getContext();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">        HttpServletRequest request = (HttpServletRequest) ctx.get(ServletActionContext.HTTP_REQUEST);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">        Map&lt;String,Object&gt; application=ctx.getApplication();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">        String id=request.getParameter(<span class="string">"id"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">        String name = request.getParameter(<span class="string">"name"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">        String school = request.getParameter(<span class="string">"school"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">        String pw =  request.getParameter(<span class="string">"pw"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">        String mail =  request.getParameter(<span class="string">"mail"</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">        System.out.println(<span class="string">"id: "</span> + id);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">        System.out.println(<span class="string">"name: "</span> + name);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">        System.out.println(<span class="string">"school: "</span> + school);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">        System.out.println(<span class="string">"pw: "</span> + pw);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">        System.out.println(<span class="string">"mail: "</span> + mail);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">        </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line">        application.put(<span class="string">"id"</span>,id);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line">        application.put(<span class="string">"name"</span>,name);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line">        application.put(<span class="string">"school"</span>,school);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line">        application.put(<span class="string">"pw"</span>,pw);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line">        application.put(<span class="string">"mail"</span>,mail);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line">        </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> <span class="string">"success"</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure><h3 id="jbtrans.java">3.3.2. JBtrans.java</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> transTest;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionSupport;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> transTest.StudentBean;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JBtrans</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="comment"> * </span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="comment"> */</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> StudentBean stud;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> StudentBean <span class="title">getStud</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> stud;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStud</span><span class="params">(StudentBean stud)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.stud = stud;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line"><span class="comment">//public StudentBean stud = new StudentBean();</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span></span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line"><span class="comment">/*System.out.println(stud.getName());</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line"><span class="comment">System.out.println(stud.getSchool());</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line"><span class="comment">System.out.println(stud.getPw());</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line"><span class="comment">System.out.println(stud.getMail());</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line"><span class="comment">System.out.println(stud.getId());*/</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="string">"success"</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure><h3 id="studentbean.java">3.3.3. StudentBean.java</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> transTest;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentBean</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String name,id,school,pw,mail;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> name;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.name = name;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getId</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> id;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(String id)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.id = id;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getSchool</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> school;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSchool</span><span class="params">(String school)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.school = school;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getPw</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> pw;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPw</span><span class="params">(String pw)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.pw = pw;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getMail</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> mail;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMail</span><span class="params">(String mail)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.mail = mail;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">35</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure><h2 id="succjb和succservlet.jsp">3.4. succJB和succSERVLET.jsp</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">jb:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">    &lt;h1&gt;欢迎你，学号&lt;s:property value="stud.id"/&gt;，&lt;s:property value="stud.school"/&gt;学院的&lt;s:property value="stud.name"/&gt;同学！&lt;/h1&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    &lt;p&gt;你登记的邮箱是&lt;s:property value="stud.mail"/&gt;，口令是&lt;s:property value="stud.pw"/&gt;。&lt;/p&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">&lt;/body&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">servlet:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">    &lt;h1&gt;欢迎你，学号$&#123;applicationScope.id&#125;，$&#123;applicationScope.school&#125;学院的$&#123;applicationScope.name&#125;同学！&lt;/h1&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">    &lt;p&gt;你登记的邮箱是$&#123;applicationScope.mail&#125;，口令是$&#123;applicationScope.pw&#125;。&lt;/p&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">&lt;/body&gt;</span></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://blog-1256194686.cos.ap-shanghai.myqcloud.com/191107_struts2trans.jpg&quot; /&gt;&lt;/p&gt;
&lt;center&gt;
struts2中，传统的servlet中的request和response传递参数法仍可使用（但略有不同），并且增加了船新的传值方式。
&lt;/center&gt;
    
    </summary>
    
    
      <category term="表世界" scheme="http://yoursite.com/categories/%E8%A1%A8%E4%B8%96%E7%95%8C/"/>
    
      <category term="Struts2" scheme="http://yoursite.com/categories/%E8%A1%A8%E4%B8%96%E7%95%8C/Struts2/"/>
    
    
      <category term="JSP" scheme="http://yoursite.com/tags/JSP/"/>
    
      <category term="Struts2" scheme="http://yoursite.com/tags/Struts2/"/>
    
  </entry>
  
  <entry>
    <title>Struts2中Action的几种Result</title>
    <link href="http://yoursite.com/2019/11/02/%E8%A1%A8%E4%B8%96%E7%95%8C/Struts2/Struts2%E4%B8%ADAction%E7%9A%84%E5%87%A0%E7%A7%8DResult/"/>
    <id>http://yoursite.com/2019/11/02/%E8%A1%A8%E4%B8%96%E7%95%8C/Struts2/Struts2%E4%B8%ADAction%E7%9A%84%E5%87%A0%E7%A7%8DResult/</id>
    <published>2019-11-02T08:53:30.000Z</published>
    <updated>2019-11-02T08:53:30.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://blog-1256194686.cos.ap-shanghai.myqcloud.com/191102_struts2action.png" /></p><center>action跳转至页面、URL或另一个action。</center><a id="more"></a><p>Struts中调用Action后应当获得一个Result。它告诉Struts接下来该干啥。它的属性可以是以下类型：</p><ul><li>dispatcher：请求转发，用于整合JSP的结果类型。</li><li>redirect：请求重定向。值为一个请求URL。</li><li>redirect-action：请求重定向到action。值为定义的action的name。</li><li>plaintext：用于显示某个页面的源代码。</li><li>还有好多种不会的……</li></ul><h1 id="环境">0. 环境</h1><ul><li>Tomcat 9.0</li><li>MyEclipse 2017 ci10</li><li>Struts 2.5.20</li><li>Manjaro Linux 18.1.0</li><li>JDK 1.8u221</li></ul><h1 id="dispatcher">1. dispatcher</h1><p>如果在result标签中没有指定type，则默认是dispatcher类型。此时它指定一个视图资源——通常是JSP页面。</p><h1 id="redirect">2. redirect</h1><p>使用该type的action重定向到一个页面，另一个action或一个网址。</p><h1 id="redirect-action">3. redirect-action</h1><p>使用该type的action使用ActionMapperFactory提供的ActionMapper来重定向请求到另外一个action。与redirect相比，在使用上没有什么区别。</p><h1 id="测试">4. 测试</h1><h2 id="struts.xml中的packge">4.1. struts.xml中的packge</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"ActionTestPkg"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span>&gt;</span>     </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"action2JSP"</span> <span class="attr">class</span>=<span class="string">"actionTest.JSPaction"</span> <span class="attr">method</span>=<span class="string">"execute"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>/succ.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"failed"</span>&gt;</span>/fail.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"action2URL"</span> <span class="attr">class</span>=<span class="string">"actionTest.URLaction"</span> <span class="attr">method</span>=<span class="string">"execute"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span> <span class="attr">type</span>=<span class="string">"redirect"</span>&gt;</span>http://www.bing.com<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"action2ACT"</span> <span class="attr">class</span>=<span class="string">"actionTest.ACTaction"</span> <span class="attr">method</span>=<span class="string">"execute"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span> <span class="attr">type</span>=<span class="string">"redirectAction"</span>&gt;</span>action2URL<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;/<span class="name">action</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span></pre></td></tr></table></figure><h2 id="actiontest包">4.2. actionTest包</h2><h3 id="jspaction类">4.2.1. JSPaction类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> actionTest;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JSPaction</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> String text;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setText</span><span class="params">(String text)</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">System.out.println(<span class="string">"JSPaction set text:"</span>+<span class="keyword">this</span>.text);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.text = text;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getText</span><span class="params">()</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">System.out.println(<span class="string">"JSPaction get text:"</span>+text);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> text;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="string">"hello world"</span>.equals(<span class="keyword">this</span>.text))&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">System.out.println(<span class="string">"JSPaction execute success."</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="string">"success"</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span> &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">System.out.println(<span class="string">"JSPaction execute failed."</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="string">"failed"</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure><h3 id="urlaction类">4.2.2. URLaction类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> actionTest;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">URLaction</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">System.out.println(<span class="string">"URLaction execute success."</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="string">"success"</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure><h3 id="actaction类">4.2.3. ACTaction类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> actionTest;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ACTaction</span> </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">System.out.println(<span class="string">"ACTaction return success."</span>);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="string">"success"</span>;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure><h2 id="jsp页面">4.3. JSP页面</h2><h3 id="index">4.3.1. index</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"action2JSP"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"text"</span>&gt;</span>Please enter hello world<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"text"</span>/&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"call JSP action"</span>/&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"action2URL"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"call URL action"</span>/&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"action2ACT"</span>&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"call ACT action"</span>/&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></pre></td></tr></table></figure><h3 id="succ和fail">4.3.2. succ和fail</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>success或者fial:get <span class="tag">&lt;<span class="name">s:property</span> <span class="attr">value</span>=<span class="string">"text"</span>/&gt;</span> .<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></pre></td></tr></table></figure><h1 id="带参数的重定向">5. 带参数的重定向</h1><h2 id="redirect-1">5.1. redirect&quot;</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span> <span class="attr">type</span>=<span class="string">"redirect"</span>&gt;</span>/login.do?userId=$&#123;userId &#125;<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span></pre></td></tr></table></figure><h2 id="redirect-action-1">5.2. redirect-action&quot;：</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span> <span class="attr">type</span>=<span class="string">"redirect-action"</span>&gt;</span>  </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"actionName"</span>&gt;</span>login.do<span class="tag">&lt;/<span class="name">param</span>&gt;</span> 重定向action名</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"userId"</span>&gt;</span>userId<span class="tag">&lt;/<span class="name">param</span>&gt;</span>带的参数</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://blog-1256194686.cos.ap-shanghai.myqcloud.com/191102_struts2action.png&quot; /&gt;&lt;/p&gt;
&lt;center&gt;
action跳转至页面、URL或另一个action。
&lt;/center&gt;
    
    </summary>
    
    
      <category term="表世界" scheme="http://yoursite.com/categories/%E8%A1%A8%E4%B8%96%E7%95%8C/"/>
    
      <category term="Struts2" scheme="http://yoursite.com/categories/%E8%A1%A8%E4%B8%96%E7%95%8C/Struts2/"/>
    
    
      <category term="JSP" scheme="http://yoursite.com/tags/JSP/"/>
    
      <category term="Struts2" scheme="http://yoursite.com/tags/Struts2/"/>
    
  </entry>
  
  <entry>
    <title>自底向上语法分析</title>
    <link href="http://yoursite.com/2019/10/28/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/%E5%8F%81%E3%83%BB%E8%87%AA%E5%BA%95%E5%90%91%E4%B8%8A%E8%AF%AD%E6%B3%95%E5%88%86%E6%9E%90/"/>
    <id>http://yoursite.com/2019/10/28/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/%E5%8F%81%E3%83%BB%E8%87%AA%E5%BA%95%E5%90%91%E4%B8%8A%E8%AF%AD%E6%B3%95%E5%88%86%E6%9E%90/</id>
    <published>2019-10-28T11:54:06.000Z</published>
    <updated>2019-12-08T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://blog-1256194686.cos.ap-shanghai.myqcloud.com/191028_ZiDiXlUhYuFaFfXi.png" /></p><center>优先分析法和LR(0)、SLR(1)、LR(1)三种LR分析法。</center><a id="more"></a><h1 id="概述">概述</h1><h2 id="基本思想">基本思想</h2><p>从输入符号串出发，在每一分析步对相应句型中的某个简单短语进行归约。如果最终能归约到识别符号，则该输入符号串是相应文法的句子，否则就不是。</p><h2 id="基本问题">基本问题</h2><p>（假设句型分析过程中每个分析步都对最左的简单短语进行直接归约）如何找出句柄及把此句柄直接归约为哪个非终结符号。</p><h2 id="基本思路">基本思路</h2><ul><li>找出句柄<span class="math inline">\(u\)</span></li><li>找出规则<span class="math inline">\(U\rightarrow u\)</span></li><li>把<span class="math inline">\(u\)</span>直接归约成<span class="math inline">\(U\)</span></li></ul><h2 id="基本概念">基本概念</h2><p><strong>活前缀</strong>:<strong>右句型</strong>（最右推导可得到的句型）的<strong>前缀</strong>（如<code>abc</code>的前缀为<code>a</code>、<code>ab</code>、<code>abc</code>），而且其右端不会超过该句型的最右边<strong>句柄</strong>（句柄是和某个产生式右部匹配的字符串，可以把句柄归约成产生式左部的非终结符）的末端。</p><p>举例，设有文法<span class="math inline">\(G[E]\)</span>：</p><p><span class="math display">\[E\rightarrow E+E|E\times E\]</span></p><p><span class="math inline">\(E+E\times E\)</span>归约成<span class="math inline">\(E+E\)</span>，句柄是<span class="math inline">\(E\times E\)</span>，那么它的活前缀就是<span class="math inline">\(E\)</span>、<span class="math inline">\(E+\)</span>、<span class="math inline">\(E+E\)</span>、<span class="math inline">\(E+E\times\)</span>、<span class="math inline">\(E+E\times E\)</span>。</p><p>这里又可以分为两种情况：</p><p><strong>归态活前缀</strong>： 活前缀的尾部正好是句柄之尾，这时可以进行规约，规约之后又成为另一句型的活前缀。</p><p><strong>非归态活前缀</strong>：句柄尚未形成，需继续移入若干符号之后才能形成句柄。</p><h1 id="自底向上优先分析">自底向上优先分析</h1><h2 id="简单优先分析法">简单优先分析法</h2><p>如果可以确定所有符号的优先级，则只需按优先级顺序规约（当一个符号优先级高于它后面的符号时，向前匹配一个产生式右部进行规约）即可。如果一个文法其任意两个符号间最多只有一种优先关系成立并且所有产生式的右部均不相同，则这么做是可行的，这种文法称为<strong>简单优先文法</strong>。这种分析方式有时用在表达式的分析上，大部分时候不实用。</p><h2 id="算符优先分析法">算符优先分析法</h2><p>如果只确定终结符之间的关系，则可大大提高适用性，但这时的规约不再是规范的。想通过终结符规约，需要所有产生式右部均没有相邻的非终结符（满足此条件称为<strong>算符文法</strong>）且任一对终结符之间仅有大于、小于或等于一种优先关系存在（满足此条件称为<strong>算符优先文法</strong>）。</p><p>如果两个终结符出现在了同一个产生式右部，称他俩优先级相等，写作<span class="math inline">\(a\doteq b\)</span>（点在中间，不会打，下面所有符号同）。</p><p>有类似<span class="math inline">\(A\to \dots aB\ldots\)</span>的产生式且有<span class="math inline">\(B\Rightarrow^{+} \Rightarrow Cb\ldots\)</span>（<span class="math inline">\(C\)</span>可以为空）的<span class="math inline">\(a\)</span>和<span class="math inline">\(b\)</span>，这种要规约的话肯定是先把含<span class="math inline">\(b\)</span>的式子规约到<span class="math inline">\(B\)</span>再规约<span class="math inline">\(a\)</span>，所以称为<span class="math inline">\(a\)</span>的优先级小于<span class="math inline">\(b\)</span>，写作<span class="math inline">\(a\dot&lt; b\)</span>。</p><p>有类似<span class="math inline">\(A\to \dots Bb\ldots\)</span>的产生式且有<span class="math inline">\(B\Rightarrow^{+} \Rightarrow \ldots aC\)</span>（<span class="math inline">\(C\)</span>可以为空）的<span class="math inline">\(a\)</span>和<span class="math inline">\(b\)</span>，这种要规约的话肯定是先把含<span class="math inline">\(a\)</span>的式子规约到<span class="math inline">\(B\)</span>再规约<span class="math inline">\(b\)</span>，所以称为<span class="math inline">\(a\)</span>的优先级大于<span class="math inline">\(b\)</span>，写作<span class="math inline">\(a\dot&gt; b\)</span>。</p><p>以<span class="math inline">\(G[S]\)</span>为例：</p><p><span class="math display">\[\begin{aligned} &amp; S\rightarrow S;G|G\\&amp; G\rightarrow G(T)|H\\&amp; H\rightarrow a|(S)\\&amp; T\rightarrow T+S|S\end{aligned}\]</span></p><p>判断<span class="math inline">\(\doteq\)</span>关系，只需硬看产生式。这里可知<span class="math inline">\((\doteq )\)</span>和隐式的<span class="math inline">\(\# \doteq \#\)</span>。</p><p>判断<span class="math inline">\(\dot&lt;\)</span>关系，需先找到所有终结符后跟非终结符的情况，有<span class="math inline">\(;G\)</span>、<span class="math inline">\((T\)</span>、<span class="math inline">\((S\)</span>、<span class="math inline">\(+S\)</span>和隐式的<span class="math inline">\(\#S\)</span>、<span class="math inline">\(\#G\)</span>。这几个关系中，在前面的终结符的优先级小于后面的非终结符的<span class="math inline">\(FirstV_t\)</span>中元素，这里指的是产生式中的第一个终结符，而非可能产生的句子中的第一个终结符，与First集略有不同。</p><p><span class="math display">\[\begin{aligned} &amp;FirstV_t(S)=\{;\}+FirstV_t(G)=\{;\}+\{(\}+FirstV_t(H)=\{;\}+\{(\}+\{a,(\}=\{;,a,(\}\\&amp;FirstV_t(G)=\{a,(\}\\&amp;FirstV_t(H)=\{a,(\}\\&amp;FirstV_t(T)=\{+\}+FirstV_t(S)=\{+,;,a,(\}\end{aligned}\]</span></p><p>故:</p><ul><li><span class="math inline">\(;G\)</span>有<span class="math inline">\(;\dot&lt; FirstV_t(G)\)</span>；</li><li><span class="math inline">\((T\)</span>有<span class="math inline">\((\dot&lt; FirstV_t(T)\)</span>；</li><li><span class="math inline">\((S\)</span>有<span class="math inline">\((\dot&lt; FirstV_t(S)\)</span>；</li><li><span class="math inline">\(+S\)</span>有<span class="math inline">\(+\dot&lt; FirstV_t(S)\)</span>；</li><li><span class="math inline">\(\#S\)</span>有<span class="math inline">\(\#\dot&lt; FirstV_t(S)\)</span>；</li><li><span class="math inline">\(\#G\)</span>有<span class="math inline">\(\#\dot&lt; FirstV_t(G)\)</span>。</li></ul><p>判断<span class="math inline">\(\dot&gt;\)</span>关系，需先找到所有非终结符后跟终结符的情况，有<span class="math inline">\(S;\)</span>、<span class="math inline">\(G(\)</span>、<span class="math inline">\(T)\)</span>、<span class="math inline">\(S)\)</span>、<span class="math inline">\(T+\)</span>和隐式的<span class="math inline">\(G\#\)</span>。这几个关系中，在前面的非终结符的<span class="math inline">\(LastV_t\)</span>集中元素优先级大于后面的终结符，这里指的是产生式中的最后一个终结符，而非可能产生的句子中的第一个终结符，与Last集略有不同。</p><p><span class="math display">\[\begin{aligned} &amp;LastV_t(S)=\{;\}+LastV_t(G)=\{;\}+\{)\}+LastV_t(H)=\{;\}+\{)\}+\{a,)\}=\{;,a,)\}\\&amp;LastV_t(G)=\{a,)\}\\&amp;LastV_t(H)=\{a,)\}\\&amp;LastV_t(T)=\{+\}+LastV_t(S)=\{+,;,a,)\}\end{aligned}\]</span></p><p>故:</p><ul><li><span class="math inline">\(S;\)</span>有<span class="math inline">\(LastV_t(S)\dot&gt;;\)</span>；</li><li><span class="math inline">\(G(\)</span>有<span class="math inline">\(LastV_t(G)\dot&gt;(\)</span>；</li><li><span class="math inline">\(T)\)</span>有<span class="math inline">\(LastV_t(T)\dot&gt;)\)</span>；</li><li><span class="math inline">\(S)\)</span>有<span class="math inline">\(LastV_t(S)\dot&gt;)\)</span>；</li><li><span class="math inline">\(G\#\)</span>有<span class="math inline">\(LastV_t(G)\dot&gt;\#\)</span>；</li><li><span class="math inline">\(T+\)</span>有<span class="math inline">\(LastV_t(T)\dot&gt;+\)</span>；</li></ul><p>将这些关系构建为一张表：</p><table><thead><tr class="header"><th></th><th>;</th><th>(</th><th>)</th><th>+</th><th>a</th><th>#</th></tr></thead><tbody><tr class="odd"><td>;</td><td><span class="math inline">\(\dot&gt;\)</span></td><td><span class="math inline">\(\dot&lt;\)</span></td><td><span class="math inline">\(\dot&gt;\)</span></td><td><span class="math inline">\(\dot&gt;\)</span></td><td><span class="math inline">\(\dot&lt;\)</span></td><td></td></tr><tr class="even"><td>(</td><td><span class="math inline">\(\dot&lt;\)</span></td><td><span class="math inline">\(\dot&lt;\)</span></td><td><span class="math inline">\(\doteq\)</span></td><td><span class="math inline">\(\dot&lt;\)</span></td><td><span class="math inline">\(\dot&lt;\)</span></td><td></td></tr><tr class="odd"><td>)</td><td><span class="math inline">\(\dot&gt;\)</span></td><td><span class="math inline">\(\dot&gt;\)</span></td><td><span class="math inline">\(\dot&gt;\)</span></td><td><span class="math inline">\(\dot&gt;\)</span></td><td></td><td><span class="math inline">\(\dot&gt;\)</span></td></tr><tr class="even"><td>+</td><td><span class="math inline">\(\dot&lt;\)</span></td><td><span class="math inline">\(\dot&lt;\)</span></td><td></td><td><span class="math inline">\(\dot&gt;\)</span></td><td><span class="math inline">\(\dot&lt;\)</span></td><td></td></tr><tr class="odd"><td>a</td><td><span class="math inline">\(\dot&gt;\)</span></td><td><span class="math inline">\(\dot&gt;\)</span></td><td><span class="math inline">\(\dot&gt;\)</span></td><td><span class="math inline">\(\dot&gt;\)</span></td><td></td><td><span class="math inline">\(\dot&gt;\)</span></td></tr><tr class="even"><td>#</td><td><span class="math inline">\(\dot&lt;\)</span></td><td><span class="math inline">\(\dot&lt;\)</span></td><td></td><td></td><td><span class="math inline">\(\dot&lt;\)</span></td><td></td></tr></tbody></table><p>没有冲突，该文法是算符优先文法。</p><p>引入最左素短语概念以确定算符优先分析的句柄，素短语是一个包含终结符的短语，且不包含除自身外的其它素短语。最左素短语就是最左的没啥好说的。可以看出，我们可以通过每次规约最左素短语进行规约。在算符优先文法的输入串中，如果一个终结符的优先级大于它两边的终结符的优先级，则它（和它两边的非终结符，如果有）是素短语。故对于算符优先文法的输入串，每次规约最左的、优先级比两边的终结符大的终结符即可，例如<code>a;(a+a)</code>之于上面的文法：</p><table><thead><tr class="header"><th>步骤</th><th>句型</th><th>优先关系</th><th>最左素短语</th><th>规约</th></tr></thead><tbody><tr class="odd"><td>1</td><td><code>#a;(a+a)#</code></td><td><code>#&lt;a&gt;;&lt;(&lt;a&gt;+&lt;a&gt;)&gt;#</code></td><td>a</td><td>H</td></tr><tr class="even"><td>2</td><td><code>#H;(a+a)#</code></td><td><code>#&lt;;&lt;(&lt;a&gt;+&lt;a&gt;)&gt;#</code></td><td>a</td><td>H</td></tr><tr class="odd"><td>3</td><td><code>#H;(H+a)#</code></td><td><code>#&lt;;&lt;(&lt;+&lt;a&gt;)&gt;#</code></td><td>a</td><td>H</td></tr><tr class="even"><td>4</td><td><code>#H;(H+H)#</code></td><td><code>#&lt;;&lt;(&lt;+&gt;)&gt;#</code></td><td>T+S</td><td>T</td></tr><tr class="odd"><td>5</td><td><code>#H;(T)#</code></td><td><code>#&lt;;&lt;(=)&gt;#</code></td><td>(T)</td><td>S</td></tr></tbody></table><p>这一步把<code>(T)</code>规约到<code>S</code>。这里只要求形式相同，具体非终结符是哪个并不关心。</p><table><thead><tr class="header"><th>步骤</th><th>句型</th><th>优先关系</th><th>最左素短语</th><th>规约</th></tr></thead><tbody><tr class="odd"><td>6</td><td><code>#H;S#</code></td><td><code>#&lt;;&gt;#</code></td><td>H;S</td><td>S</td></tr><tr class="even"><td>7</td><td><code>#S#</code></td><td></td><td></td><td></td></tr></tbody></table><p>虽然接受了，但该字符串其实不是文法的句子。毕竟它不是规范的，难免。因此只适合表达式的分析。</p><h1 id="lr分析">LR分析</h1><h2 id="概述-1">概述</h2><p>LR(K)分析器包括总控程序和分析表。</p><p>总控程序根据不同的分析表决定下一步的处理动作。不同文法的总控程序相同，只是分析表不同。</p><p>分析表是LR(K)分析技术的核心，根据具体文法按某种规则构造，由分析动作表和转换表构成。</p><p>分析动作表<code>ACTION[S,y]</code>指明当状态<code>S</code>与向前看符号串<code>y</code>相匹配时所应采取的动作。包括：移进、归约、接受、出错 。</p><p>状态转换表<code>GOTO[S,U]</code>指明当状态<code>S</code>与非终结符号<code>U</code>相匹配时所转换到的下一状态。</p><h2 id="分析过程">分析过程</h2><ol type="1"><li>将初始状态S0与#压进分析栈</li><li>根据栈顶状态和当前输入符号查动作表进行以下工作<ul><li>移进(Si)：当前输入符号进符号栈,新的状态进状态栈,继续扫描.</li><li>归约(rj)：按某规则归约,若规则的右部长度n,则符号栈顶和状态栈顶n个元素同时退栈. 把归约后的左部符号进符号栈,查状态转换表,新的状态进状态栈.</li><li>接受(acc): 分析成功,结束.</li><li>出错(空白): 报告出错信息.</li></ul></li><li>重复(1),直到接受或出错为止.</li></ol><h2 id="lr0分析">LR(0)分析</h2><p>设有文法<span class="math inline">\(G[S]\)</span>：</p><p><span class="math display">\[\begin{aligned}&amp;(1)S\rightarrow A\\&amp;(2)S\rightarrow B\\&amp;(3)A\rightarrow aAb\\&amp;(4)A\rightarrow c\\&amp;(5)B\rightarrow aBb\\&amp;(6)B\rightarrow d\\\end{aligned}\]</span></p><p>为了确保起始符号不出现在产生式右部，并显式地表示EOF，增加一个起始符号S'，得到增广文法<span class="math inline">\(G&#39;[S&#39;]\)</span>：</p><p><span class="math display">\[\begin{aligned}&amp;(0)S&#39;\rightarrow S\#\\&amp;(1)S\rightarrow A\\&amp;(2)S\rightarrow B\\&amp;(3)A\rightarrow aAb\\&amp;(4)A\rightarrow c\\&amp;(5)B\rightarrow aBb\\&amp;(6)B\rightarrow d\\\end{aligned}\]</span></p><p>并引入一个“・”记号，这个记号之前的部分为已经读入（并且匹配）的部分，之后的部分为期望为读入的部分匹配的部分。为了便于识别，手写时将点记号写作“<span class="math inline">\(\Delta\)</span>”。</p><p>为了得到想要的两个表，需要先构建这个文法的自动机。</p><p>首先看起始状态，现在面对一个未知的串，期望其匹配G'，也就是未读入的部分匹配<span class="math inline">\(S\#\)</span>。将现在的状态称为<span class="math inline">\(S_0\)</span>，也就是：</p><table><thead><tr class="header"><th>状态</th><th>项目</th><th>后继符号</th><th>后继状态</th></tr></thead><tbody><tr class="odd"><td><span class="math inline">\(S_0\)</span></td><td><span class="math inline">\(S&#39;\rightarrow \Delta S\)</span></td><td><span class="math inline">\(S\)</span></td><td></td></tr></tbody></table><p>既然期待<span class="math inline">\(S\)</span>，那左部符号为<span class="math inline">\(S\)</span>的产生式也可以被期待。加进去，就变成：</p><table><thead><tr class="header"><th>状态</th><th>项目</th><th>后继符号</th><th>后继状态</th></tr></thead><tbody><tr class="odd"><td><span class="math inline">\(S_0\)</span></td><td><span class="math inline">\(S&#39;\rightarrow \Delta S\)</span></td><td><span class="math inline">\(S\)</span></td><td></td></tr><tr class="even"><td><span class="math inline">\(S_0\)</span></td><td><span class="math inline">\(S\rightarrow \Delta A\)</span></td><td><span class="math inline">\(A\)</span></td><td></td></tr><tr class="odd"><td><span class="math inline">\(S_0\)</span></td><td><span class="math inline">\(S\rightarrow \Delta B\)</span></td><td><span class="math inline">\(B\)</span></td><td></td></tr></tbody></table><p>同理，都期待<span class="math inline">\(A\)</span>和<span class="math inline">\(B\)</span>了，那左部符号为<span class="math inline">\(A\)</span>和<span class="math inline">\(B\)</span>的产生式也可以被期待：</p><table><thead><tr class="header"><th>状态</th><th>项目</th><th>后继符号</th><th>后继状态</th></tr></thead><tbody><tr class="odd"><td><span class="math inline">\(S_0\)</span></td><td><span class="math inline">\(S&#39;\rightarrow \Delta S\)</span></td><td><span class="math inline">\(S\)</span></td><td></td></tr><tr class="even"><td><span class="math inline">\(S_0\)</span></td><td><span class="math inline">\(S\rightarrow \Delta A\)</span></td><td><span class="math inline">\(A\)</span></td><td></td></tr><tr class="odd"><td><span class="math inline">\(S_0\)</span></td><td><span class="math inline">\(S\rightarrow \Delta B\)</span></td><td><span class="math inline">\(B\)</span></td><td></td></tr><tr class="even"><td><span class="math inline">\(S_0\)</span></td><td><span class="math inline">\(A\rightarrow \Delta aAb\)</span></td><td><span class="math inline">\(a\)</span></td><td></td></tr><tr class="odd"><td><span class="math inline">\(S_0\)</span></td><td><span class="math inline">\(A\rightarrow \Delta c\)</span></td><td><span class="math inline">\(c\)</span></td><td></td></tr><tr class="even"><td><span class="math inline">\(S_0\)</span></td><td><span class="math inline">\(B\rightarrow \Delta aBb\)</span></td><td><span class="math inline">\(a\)</span></td><td></td></tr><tr class="odd"><td><span class="math inline">\(S_0\)</span></td><td><span class="math inline">\(B\rightarrow \Delta d\)</span></td><td><span class="math inline">\(d\)</span></td><td></td></tr></tbody></table><p>现在假设对每个项目，真的都读到了它的后继符号，那将进入新的状态。给它们起名字：</p><table><thead><tr class="header"><th>状态</th><th>项目</th><th>后继符号</th><th>后继状态</th></tr></thead><tbody><tr class="odd"><td><span class="math inline">\(S_0\)</span></td><td><span class="math inline">\(S&#39;\rightarrow \Delta S\)</span></td><td><span class="math inline">\(S\)</span></td><td><span class="math inline">\(S_1\)</span></td></tr><tr class="even"><td><span class="math inline">\(S_0\)</span></td><td><span class="math inline">\(S\rightarrow \Delta A\)</span></td><td><span class="math inline">\(A\)</span></td><td><span class="math inline">\(S_2\)</span></td></tr><tr class="odd"><td><span class="math inline">\(S_0\)</span></td><td><span class="math inline">\(S\rightarrow \Delta B\)</span></td><td><span class="math inline">\(B\)</span></td><td><span class="math inline">\(S_3\)</span></td></tr><tr class="even"><td><span class="math inline">\(S_0\)</span></td><td><span class="math inline">\(A\rightarrow \Delta aAb\)</span></td><td><span class="math inline">\(a\)</span></td><td><span class="math inline">\(S_4\)</span></td></tr><tr class="odd"><td><span class="math inline">\(S_0\)</span></td><td><span class="math inline">\(A\rightarrow \Delta c\)</span></td><td><span class="math inline">\(c\)</span></td><td><span class="math inline">\(S_5\)</span></td></tr><tr class="even"><td><span class="math inline">\(S_0\)</span></td><td><span class="math inline">\(B\rightarrow \Delta aBb\)</span></td><td><span class="math inline">\(a\)</span></td><td><span class="math inline">\(S_4\)</span></td></tr><tr class="odd"><td><span class="math inline">\(S_0\)</span></td><td><span class="math inline">\(B\rightarrow \Delta d\)</span></td><td><span class="math inline">\(d\)</span></td><td><span class="math inline">\(S_6\)</span></td></tr></tbody></table><p>对于两个后继为<span class="math inline">\(a\)</span>的，由于其都是“第一个读到<span class="math inline">\(a\)</span>”的情况，所以对应的下一个状态是相同的。</p><p>现在考虑<span class="math inline">\(S_1\)</span>。现在已经读入了<span class="math inline">\(S\)</span>（或者不能叫读入了，因为<span class="math inline">\(S\)</span>并不是一个终结符，不过意思是这么个意思……），所以<span class="math inline">\(\Delta\)</span>要放在<span class="math inline">\(S\)</span>后面，那就是后面没有没有待匹配的东西了，这时进行规约：</p><table><thead><tr class="header"><th>状态</th><th>项目</th><th>后继符号</th><th>后继状态</th></tr></thead><tbody><tr class="odd"><td><span class="math inline">\(S_1\)</span></td><td><span class="math inline">\(S&#39;\rightarrow S\Delta\)</span></td><td><span class="math inline">\(\#S&#39;\rightarrow S\)</span></td><td>END</td></tr></tbody></table><p><span class="math inline">\(S_2\)</span>和<span class="math inline">\(S_3\)</span>同理：</p><table><thead><tr class="header"><th>状态</th><th>项目</th><th>后继符号</th><th>后继状态</th></tr></thead><tbody><tr class="odd"><td><span class="math inline">\(S_2\)</span></td><td><span class="math inline">\(S\rightarrow A\Delta\)</span></td><td><span class="math inline">\(\#S\rightarrow A\)</span></td><td>END</td></tr><tr class="even"><td><span class="math inline">\(S_3\)</span></td><td><span class="math inline">\(S\rightarrow B\Delta\)</span></td><td><span class="math inline">\(\#S\rightarrow B\)</span></td><td>END</td></tr></tbody></table><p>对<span class="math inline">\(S_4\)</span>，已经读入了<span class="math inline">\(a\)</span>，对于<span class="math inline">\(A\rightarrow aAb\)</span>，期望看到<span class="math inline">\(A\)</span>；对于<span class="math inline">\(B\rightarrow aBb\)</span>，期望看到<span class="math inline">\(B\)</span>，所以左部符号为<span class="math inline">\(A\)</span>和<span class="math inline">\(B\)</span>的产生式也可以被期待——注意此时的<span class="math inline">\(\Delta\)</span>在右部式的最左，而不是<span class="math inline">\(a\)</span>后，因为这个期待的<span class="math inline">\(A\)</span>或<span class="math inline">\(B\)</span>还没被读取：</p><table><thead><tr class="header"><th>状态</th><th>项目</th><th>后继符号</th><th>后继状态</th></tr></thead><tbody><tr class="odd"><td><span class="math inline">\(S_4\)</span></td><td><span class="math inline">\(A\rightarrow a\Delta Ab\)</span></td><td><span class="math inline">\(A\)</span></td><td><span class="math inline">\(S_7\)</span></td></tr><tr class="even"><td><span class="math inline">\(S_4\)</span></td><td><span class="math inline">\(B\rightarrow a\Delta Bb\)</span></td><td><span class="math inline">\(B\)</span></td><td><span class="math inline">\(S_8\)</span></td></tr><tr class="odd"><td><span class="math inline">\(S_4\)</span></td><td><span class="math inline">\(A\rightarrow \Delta aAb\)</span></td><td><span class="math inline">\(a\)</span></td><td><span class="math inline">\(S_4\)</span></td></tr><tr class="even"><td><span class="math inline">\(S_4\)</span></td><td><span class="math inline">\(A\rightarrow \Delta c\)</span></td><td><span class="math inline">\(c\)</span></td><td><span class="math inline">\(S_5\)</span></td></tr><tr class="odd"><td><span class="math inline">\(S_4\)</span></td><td><span class="math inline">\(B\rightarrow \Delta aBb\)</span></td><td><span class="math inline">\(a\)</span></td><td><span class="math inline">\(S_4\)</span></td></tr><tr class="even"><td><span class="math inline">\(S_4\)</span></td><td><span class="math inline">\(B\rightarrow \Delta d\)</span></td><td><span class="math inline">\(d\)</span></td><td><span class="math inline">\(S_6\)</span></td></tr></tbody></table><p>这里头两个项目时已经读入了<span class="math inline">\(a\)</span>，期待<span class="math inline">\(A\)</span>或<span class="math inline">\(B\)</span>，是新状态；之后的是已有的状态。</p><p>对于<span class="math inline">\(S_5\)</span>和<span class="math inline">\(S_6\)</span>，当读到期待的符号后后面就没了，期待EOF：</p><table><thead><tr class="header"><th>状态</th><th>项目</th><th>后继符号</th><th>后继状态</th></tr></thead><tbody><tr class="odd"><td><span class="math inline">\(S_5\)</span></td><td><span class="math inline">\(A\rightarrow c\Delta\)</span></td><td><span class="math inline">\(\#A\rightarrow c\)</span></td><td>END</td></tr><tr class="even"><td><span class="math inline">\(S_6\)</span></td><td><span class="math inline">\(B\rightarrow d\Delta\)</span></td><td><span class="math inline">\(\#B\rightarrow d\)</span></td><td>END</td></tr></tbody></table><p>对于<span class="math inline">\(S_7\)</span>和<span class="math inline">\(S_8\)</span>，当读到期待的符号后再后还有得读，又多了两种状态：</p><table><thead><tr class="header"><th>状态</th><th>项目</th><th>后继符号</th><th>后继状态</th></tr></thead><tbody><tr class="odd"><td><span class="math inline">\(S_7\)</span></td><td><span class="math inline">\(A\rightarrow aA\Delta b\)</span></td><td><span class="math inline">\(b\)</span></td><td><span class="math inline">\(S_9\)</span></td></tr><tr class="even"><td><span class="math inline">\(S_8\)</span></td><td><span class="math inline">\(B\rightarrow aB\Delta b\)</span></td><td><span class="math inline">\(b\)</span></td><td><span class="math inline">\(S_{10}\)</span></td></tr></tbody></table><p>对于<span class="math inline">\(S_9\)</span>和<span class="math inline">\(S_10\)</span>，当读到期待的符号后期待EOF：</p><table><thead><tr class="header"><th>状态</th><th>项目</th><th>后继符号</th><th>后继状态</th></tr></thead><tbody><tr class="odd"><td><span class="math inline">\(S_9\)</span></td><td><span class="math inline">\(A\rightarrow aAb\Delta\)</span></td><td><span class="math inline">\(\#A\rightarrow aAb\)</span></td><td>END</td></tr><tr class="even"><td><span class="math inline">\(S_10\)</span></td><td><span class="math inline">\(B\rightarrow aBb\Delta\)</span></td><td><span class="math inline">\(\#B\rightarrow aBb\)</span></td><td>END</td></tr></tbody></table><p>这样所有的状态都分析完了。整合一下这个表，就是：</p><table style="width:100%;"><colgroup><col style="width: 3%" /><col style="width: 73%" /><col style="width: 8%" /><col style="width: 14%" /></colgroup><thead><tr class="header"><th>状态</th><th>项目集</th><th>后继符号</th><th>后继状态</th></tr></thead><tbody><tr class="odd"><td><span class="math inline">\(S_0\)</span></td><td><span class="math inline">\(\{\\S&#39; \rightarrow \Delta S\\S\rightarrow \Delta A\\S\rightarrow \Delta B\\A\rightarrow \Delta aAb\\A\rightarrow \Delta c\\B\rightarrow \Delta aBb\\B\rightarrow \Delta d\\\}\)</span></td><td><span class="math inline">\(S\\A\\B\\a\\c\\a\\d\)</span></td><td><span class="math inline">\(S_1\\S_2\\S_3\\S_4\\S_5\\S_4\\S_6\)</span></td></tr><tr class="even"><td><span class="math inline">\(S_1\)</span></td><td><span class="math inline">\(\{\\S&#39;\rightarrow S\Delta\\\}\)</span></td><td><span class="math inline">\(\#S&#39;\rightarrow S\)</span></td><td>END</td></tr><tr class="odd"><td><span class="math inline">\(S_2\)</span></td><td><span class="math inline">\(\{\\S\rightarrow A\Delta\\\}\)</span></td><td><span class="math inline">\(\#S\rightarrow A\)</span></td><td>END</td></tr><tr class="even"><td><span class="math inline">\(S_3\)</span></td><td><span class="math inline">\(\{\\S\rightarrow B\Delta\\\}\)</span></td><td><span class="math inline">\(\#S\rightarrow B\)</span></td><td>END</td></tr><tr class="odd"><td><span class="math inline">\(S_4\)</span></td><td><span class="math inline">\(\{\\A\rightarrow a\Delta Ab\\B\rightarrow a\Delta Bb\\A\rightarrow \Delta aAb\\A\rightarrow \Delta c\\B\rightarrow \Delta aBb\\B\rightarrow \Delta d\\\}\)</span></td><td><span class="math inline">\(A\\B\\a\\c\\a\\d\)</span></td><td><span class="math inline">\(S_7\\S_8\\S_4\\S_5\\S_4\\S_6\)</span></td></tr><tr class="even"><td><span class="math inline">\(S_5\)</span></td><td><span class="math inline">\(\{\\A\rightarrow c\Delta\\\}\)</span></td><td><span class="math inline">\(\#A\rightarrow c\)</span></td><td>END</td></tr><tr class="odd"><td><span class="math inline">\(S_6\)</span></td><td><span class="math inline">\(\{\\B\rightarrow d\Delta\\\}\)</span></td><td><span class="math inline">\(\#B\rightarrow d\)</span></td><td>END</td></tr><tr class="even"><td><span class="math inline">\(S_7\)</span></td><td><span class="math inline">\(\{\\A\rightarrow aA\Delta b\\\}\)</span></td><td><span class="math inline">\(b\)</span></td><td><span class="math inline">\(S_9\)</span></td></tr><tr class="odd"><td><span class="math inline">\(S_8\)</span></td><td><span class="math inline">\(\{\\B\rightarrow aB\Delta b\\\}\)</span></td><td><span class="math inline">\(b\)</span></td><td><span class="math inline">\(S_10\)</span></td></tr><tr class="even"><td><span class="math inline">\(S_9\)</span></td><td><span class="math inline">\(\{\\A\rightarrow aAb\Delta\\\}\)</span></td><td><span class="math inline">\(\#A\rightarrow aAb\)</span></td><td>END</td></tr><tr class="odd"><td><span class="math inline">\(S_{10}\)</span></td><td><span class="math inline">\(\{\\B\rightarrow aBb\Delta\\\}\)</span></td><td><span class="math inline">\(\#B\rightarrow aBb\)</span></td><td>END</td></tr><tr class="even"><td>END</td><td></td><td></td><td></td></tr></tbody></table><p>这样就获得了这个文法的自动机。为了方便程序查找在啥状态下读到啥时该做啥，需要构建分析表。</p><p>当位于状态<span class="math inline">\(S_0\)</span>时，下一位可能的符号有<span class="math inline">\(a\)</span>，<span class="math inline">\(b\)</span>，<span class="math inline">\(c\)</span>，<span class="math inline">\(d\)</span>和<span class="math inline">\(\#\)</span>。由自动机知此时下一位若为<span class="math inline">\(a\)</span>，<span class="math inline">\(c\)</span>，<span class="math inline">\(d\)</span>是符合规则的。因此若下一位是<span class="math inline">\(a\)</span>则移进（shift）一位（就是把<span class="math inline">\(S_0,a\)</span>入分析栈，读入的指针右移一位）并转换到到<span class="math inline">\(S_4\)</span>，<span class="math inline">\(c\)</span>则<span class="math inline">\(S_5\)</span>，<span class="math inline">\(d\)</span>则<span class="math inline">\(S_6\)</span>。</p><table><thead><tr class="header"><th>状态</th><th><span class="math inline">\(a\)</span></th><th><span class="math inline">\(b\)</span></th><th><span class="math inline">\(c\)</span></th><th><span class="math inline">\(d\)</span></th><th><span class="math inline">\(\#\)</span></th></tr></thead><tbody><tr class="odd"><td><span class="math inline">\(S_0\)</span></td><td>s4</td><td></td><td>s5</td><td>s6</td><td></td></tr></tbody></table><p>也就是从这样：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">+-----------------+ +----------------------------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">|status  |symble  | |...a...                           |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">+-----------------+ +---^------------------------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">|        |        |     |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">|        |        |     |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">|        |        |     +</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">|        |        |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">|S0      |x       |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">|...     |...     |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">|S0      |#       |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr></table></figure><p>变成这样：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">+-----------------+ +----------------------------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">|status  |symble  | |...a...                           |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">+-----------------+ +----^-----------------------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">|        |        |      |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">|        |        |      |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">|        |        |      +</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">|        |        |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">|S4      |a       |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">|S0      |x       |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">|...     |...     |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">|S0      |#       |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr></table></figure><p>当位于状态<span class="math inline">\(S_1\)</span>时，如果遇到<span class="math inline">\(\#\)</span>就是分析完了，称之为“acc(ept)”，其它情况不符合自动机。</p><table><thead><tr class="header"><th>状态</th><th><span class="math inline">\(a\)</span></th><th><span class="math inline">\(b\)</span></th><th><span class="math inline">\(c\)</span></th><th><span class="math inline">\(d\)</span></th><th><span class="math inline">\(\#\)</span></th></tr></thead><tbody><tr class="odd"><td><span class="math inline">\(S_1\)</span></td><td></td><td></td><td></td><td></td><td>acc</td></tr></tbody></table><p>当位于状态<span class="math inline">\(S_2\)</span>时，栈中的内容是<span class="math inline">\(A\)</span>，要进行规约（reduce）。</p><p>根据<span class="math inline">\(S_2\)</span>的规则，也就是规则1，<span class="math inline">\(A\)</span>规约后将变成<span class="math inline">\(S\)</span>。所以在表里填上“r1”表示根据规则1规约，并弹出被规约的内容，这里只有<span class="math inline">\(S_2,A\)</span>，规约后得到的非终结符是使用的规则的左部符号，到达栈顶状态遇到这一符号的状态。</p><table><thead><tr class="header"><th>状态</th><th><span class="math inline">\(a\)</span></th><th><span class="math inline">\(b\)</span></th><th><span class="math inline">\(c\)</span></th><th><span class="math inline">\(d\)</span></th><th><span class="math inline">\(\#\)</span></th></tr></thead><tbody><tr class="odd"><td><span class="math inline">\(S_2\)</span></td><td>r1</td><td>r1</td><td>r1</td><td>r1</td><td>r1</td></tr></tbody></table><p>也就是由（这个例子中只有<span class="math inline">\(S_0\)</span>后继符号是<span class="math inline">\(S\)</span>，此时后继状态是<span class="math inline">\(S_1\)</span>）：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">+-----------------+ +----------------------------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">|status  |symble  | |.......                           |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">+-----------------+ +---^------------------------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">|        |        |     |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">|        |        |     |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">|        |        |     +</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">|S2      |A       |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">|S0      |#       |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr></table></figure><p>变成：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">+-----------------+ +----------------------------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">|status  |symble  | |.......                           |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">+-----------------+ +---^------------------------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">|        |        |     |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">|        |        |     |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">|        |        |     +</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">|S1      |S       |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">|S0      |#       |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr></table></figure><p>为方便查找，还要再搞一个将状态与非终结符联系起来的表，为表区分，之前的称为“ACTION”表，后者称为“GOTO”表。</p><table><thead><tr class="header"><th>状态</th><th><span class="math inline">\(S\)</span></th><th><span class="math inline">\(A\)</span></th><th><span class="math inline">\(B\)</span></th></tr></thead><tbody><tr class="odd"><td><span class="math inline">\(S_0\)</span></td><td>1</td><td></td><td></td></tr></tbody></table><p><span class="math inline">\(S_3\)</span>同样是要规约，要从<span class="math inline">\(B\)</span>规约到<span class="math inline">\(S\)</span>也就是按规则2:</p><table><thead><tr class="header"><th>状态</th><th><span class="math inline">\(a\)</span></th><th><span class="math inline">\(b\)</span></th><th><span class="math inline">\(c\)</span></th><th><span class="math inline">\(d\)</span></th><th><span class="math inline">\(\#\)</span></th></tr></thead><tbody><tr class="odd"><td><span class="math inline">\(S_3\)</span></td><td>r2</td><td>r2</td><td>r2</td><td>r2</td><td>r2</td></tr></tbody></table><p>依此类推即可获得分析表。</p><p>这种分析方法的问题在于，一旦进入某个可以规约的状态，无论输入是什么都会规约。这可能导致错误的规约。</p><h2 id="slr1分析">SLR(1)分析</h2><p>对大部分文法，会出现移进与规约的冲突和规约与规约的冲突。</p><p>设有文法<span class="math inline">\(G[S]\)</span>：</p><p><span class="math display">\[\begin{aligned}&amp;(1)S\rightarrow A\\&amp;(2)A\rightarrow aAd\\&amp;(3)A\rightarrow aAb\\&amp;(4)A\rightarrow \epsilon\end{aligned}\]</span></p><p>写为<span class="math inline">\(G&#39;[S&#39;]\)</span>：</p><p><span class="math display">\[\begin{aligned}&amp;(0)S&#39;\rightarrow S\\&amp;(1)S\rightarrow A\\&amp;(2)A\rightarrow aAd\\&amp;(3)A\rightarrow aAb\\&amp;(4)A\rightarrow \epsilon\end{aligned}\]</span></p><p>构造自动机：</p><table style="width:100%;"><colgroup><col style="width: 2%" /><col style="width: 65%" /><col style="width: 19%" /><col style="width: 11%" /></colgroup><thead><tr class="header"><th>状态</th><th>项目集</th><th>后继符号</th><th>后继状态</th></tr></thead><tbody><tr class="odd"><td><span class="math inline">\(S_0\)</span></td><td><span class="math inline">\(\{\\S\rightarrow \Delta A\\A\rightarrow \Delta aAd\\A\rightarrow \Delta aAb\\A\rightarrow \epsilon \Delta \\\}\)</span></td><td><span class="math inline">\(A\\a\\a\\\#A\rightarrow \epsilon\)</span></td><td><span class="math inline">\(S_1\\S_2\\S_2\\END\)</span></td></tr></tbody></table><p>可以发现这里面既有移进项又有规约项。这种情况就说这个文法不是LR(0)的。如果一个文法的自动机同时存在不止一个规约项目，它也不是LR(0)的。</p><p>继续分析：</p><table><colgroup><col style="width: 2%" /><col style="width: 70%" /><col style="width: 18%" /><col style="width: 8%" /></colgroup><thead><tr class="header"><th>状态</th><th>项目集</th><th>后继符号</th><th>后继状态</th></tr></thead><tbody><tr class="odd"><td><span class="math inline">\(S_0\)</span></td><td><span class="math inline">\(\{\\S&#39;\rightarrow \Delta S\\S\rightarrow \Delta A\\A\rightarrow \Delta aAd\\A\rightarrow \Delta aAb\\A\rightarrow \epsilon \Delta \\\}\)</span></td><td><span class="math inline">\(S\\A\\a\\a\\\#A\rightarrow \epsilon\)</span></td><td><span class="math inline">\(1\\2\\3\\3\\END\)</span></td></tr><tr class="even"><td><span class="math inline">\(S_1\)</span></td><td><span class="math inline">\(\{\\S&#39;\rightarrow S\Delta\\\}\)</span></td><td><span class="math inline">\(\#S&#39;\rightarrow S\)</span></td><td><span class="math inline">\(END\)</span></td></tr><tr class="odd"><td><span class="math inline">\(S_2\)</span></td><td><span class="math inline">\(\{\\S\rightarrow A\Delta\\\}\)</span></td><td><span class="math inline">\(\#S\rightarrow A\)</span></td><td><span class="math inline">\(END\)</span></td></tr><tr class="even"><td><span class="math inline">\(S_3\)</span></td><td><span class="math inline">\(\{\\A\rightarrow a\Delta Ad\\A\rightarrow a\Delta Ab\\A\rightarrow \Delta aAd\\A\rightarrow \Delta aAb\\A\rightarrow \epsilon \Delta\\\}\)</span></td><td><span class="math inline">\(A\\A\\a\\a\\\#A\rightarrow \epsilon\)</span></td><td><span class="math inline">\(4\\4\\3\\3\\END\)</span></td></tr><tr class="odd"><td><span class="math inline">\(S_4\)</span></td><td><span class="math inline">\(\{\\A\rightarrow aA\Delta d\\A\rightarrow aA\Delta b\\\}\)</span></td><td><span class="math inline">\(d\\b\)</span></td><td><span class="math inline">\(5\\6\)</span></td></tr><tr class="even"><td><span class="math inline">\(S_5\)</span></td><td><span class="math inline">\(\{\\A\rightarrow aAd\Delta\\\}\)</span></td><td><span class="math inline">\(\#A\rightarrow aAd\)</span></td><td><span class="math inline">\(END\)</span></td></tr><tr class="odd"><td><span class="math inline">\(S_6\)</span></td><td><span class="math inline">\(\{\\A\rightarrow aAb\Delta\\\}\)</span></td><td><span class="math inline">\(\#A\rightarrow aAb\)</span></td><td><span class="math inline">\(END\)</span></td></tr></tbody></table><p>除上述冲突外无其它冲突。冲突的<span class="math inline">\(A\)</span>的Follow集和这里的两个<span class="math inline">\(a\)</span>无交集，故可以根据这个进行判断是移进还是规约，这种叫SLR(1)文法，因为根据下一个输入字符即可判断执行什么操作。之所以是SLR而不是LR，是因为它仅在冲突时进行判断，不冲突时仍然是不管输入啥都规约。这导致有时仍然会错误地规约。一个项目集中有两个规约的情况类似，考察两个左部符号的Follow集，没有交集的话也OK。</p><p>类似LR(0)地可获得分析表。唯一区别就是有些地方状态既可能要移进也可能要规约，而不是要规约一整行都是规约：</p><table><thead><tr class="header"><th>状态</th><th>a</th><th>b</th><th>d</th><th>#</th><th>A</th><th>S</th></tr></thead><tbody><tr class="odd"><td><span class="math inline">\(S_0\)</span></td><td>s3</td><td>r4</td><td>r4</td><td>r4</td><td>2</td><td>1</td></tr><tr class="even"><td><span class="math inline">\(S_1\)</span></td><td></td><td></td><td></td><td>acc</td><td></td><td></td></tr><tr class="odd"><td><span class="math inline">\(S_2\)</span></td><td>r1</td><td>r1</td><td>r1</td><td>r1</td><td></td><td></td></tr><tr class="even"><td><span class="math inline">\(S_3\)</span></td><td>s3</td><td>r4</td><td>r4</td><td>r4</td><td>4</td><td></td></tr><tr class="odd"><td><span class="math inline">\(S_4\)</span></td><td></td><td>s6</td><td>s5</td><td></td><td></td><td></td></tr><tr class="even"><td><span class="math inline">\(S_5\)</span></td><td>r2</td><td>r2</td><td>r2</td><td>r2</td><td></td><td></td></tr><tr class="odd"><td><span class="math inline">\(S_6\)</span></td><td>r3</td><td>r3</td><td>r3</td><td>r3</td><td></td><td></td></tr></tbody></table><p>以分析<code>ab#</code>为例，初始为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">+-----------------+ +----------------------------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">|status  |symble  | |   ab#                            |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">+-----------------+ +---^------------------------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">|        |        |     |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">|        |        |     |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">|        |        |     +</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">|S0      |#       |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr></table></figure><p>S0遇a，故入栈S3和a，指针后移：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">+-----------------+ +----------------------------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">|status  |symble  | |   ab#                            |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">+-----------------+ +----^-----------------------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">|        |        |      |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">|        |        |      |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">|        |        |      +</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">|S3      |a       |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">|S0      |#       |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr></table></figure><p>S3遇b，按规则(4)规约。规则(4)右部串长度为0，故弹出栈顶前0个元素。弹完栈顶是(S3,a)，规则(4)左部符号为A，故S3遇A，将S4和A入栈。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">+-----------------+ +----------------------------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">|status  |symble  | |   ab#                            |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">+-----------------+ +----^-----------------------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">|        |        |      |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">|        |        |      |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">|        |        |      +</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">|S4      |A       |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">|S3      |a       |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">|S0      |#       |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr></table></figure><p>S4遇b，入栈S6和b，指针后移。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">+-----------------+ +----------------------------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">|status  |symble  | |   ab#                            |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">+-----------------+ +-----^----------------------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">|        |        |       |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">|        |        |       |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">|        |        |       +</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">|S6      |b       |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">|S4      |A       |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">|S3      |a       |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">|S0      |#       |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr></table></figure><p>S6遇#，按规则(3)规约。规则(3)右部串长度为3，故弹出栈顶三元素，弹出后栈顶为(S0,#)，规则(3)左部符号为A。S0遇A，入栈S2和A。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">+-----------------+ +----------------------------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">|status  |symble  | |   ab#                            |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">+-----------------+ +-----^----------------------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">|        |        |       |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">|        |        |       |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">|        |        |       +</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">|S2      |A       |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">|S0      |#       |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">+-----------------+</span></pre></td></tr></table></figure><p>S2遇#，按规则(1)规约，弹一对元素，S0遇S转S1，遇#，接受。</p><h2 id="lr1分析">LR(1)分析</h2><p>上面讲项目集规约与移进、规约与规约出现冲突时考察交集，那万一有呢？当时是通过比较Follow集，但Follow集只是个笼统的说法，一个非终结符的Follow集中的某个元素可能在某些句型中并不会出现。考虑在自动机的每一个产生式中标注其推导出的句型可能的后缀，当遇到可能遇到的后缀时才进行规约。这不止可以避免冲突，还可以避免误规约。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://blog-1256194686.cos.ap-shanghai.myqcloud.com/191028_ZiDiXlUhYuFaFfXi.png&quot; /&gt;&lt;/p&gt;
&lt;center&gt;
优先分析法和LR(0)、SLR(1)、LR(1)三种LR分析法。
&lt;/center&gt;
    
    </summary>
    
    
      <category term="深蓝" scheme="http://yoursite.com/categories/%E6%B7%B1%E8%93%9D/"/>
    
      <category term="编译原理" scheme="http://yoursite.com/categories/%E6%B7%B1%E8%93%9D/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/"/>
    
    
      <category term="编译原理" scheme="http://yoursite.com/tags/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/"/>
    
      <category term="语法分析" scheme="http://yoursite.com/tags/%E8%AF%AD%E6%B3%95%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
</feed>
